

<!DOCTYPE html>
<html lang="zh-CN">

<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <title>使用 Vuepress 编写组件示例文档的最佳实践 [ Sincerity ]</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="icon" href="/images/favicon-32x32.png">
  
  <!-- stylesheets list from _config.yml -->
  
  <link rel="stylesheet" href="/css/simple.css">
  
  <link rel="stylesheet" href="/css/font.css">
  
  
</head>

<body>

  <header class="header">
    <nav class="nav">
      <a href="/" class="nav-logo"><img src="/images/avatar.png" width="50" height="50" alt="Logo"></a>
      <ul class="nav-links">
        
        <li><a href="/">文章列表</a></li>
        
        <li><a href="/archives">归档</a></li>
        
        <li><a href="/leetcode">力扣</a></li>
        
        <li><a href="/about">关于我</a></li>
        
        <li><a href="https://github.com/calebman">Github</a></li>
        
      </ul>
    </nav>
  </header>

  <main class="content">
    <article class="article">
  <h1 class="article-title">使用 Vuepress 编写组件示例文档的最佳实践</h1>
  <span class="article-date">2020-05-31</span>
  
  
  <a class="article-tag" href="/tags/vuejs">
    vuejs
  </a>
  
  <a class="article-tag" href="/tags/vuepress">
    vuepress
  </a>
  
  <a class="article-tag" href="/tags/plugin">
    plugin
  </a>
  
  

  <div class="article-content">
    <p>  这篇文章面向使用 <code>Vuepress</code> 来开发 <code>Vue</code> 组件文档库的用户服务，去年差不多这个时候我为公司开发了一个基于 AntDesignVue 封装的高阶组件库，经过一年的版本迭代与文档更新，收获了很多坑点，其中有一个就是关于组件示例维护相关的，今年有意重构组件库的文档与代码结构，后面会陆陆续续将踩到的坑点与相应的解决方案一一描述，好的进入今天的主题：<strong>文档示例编写的最佳实践方案</strong>。</p>
<a id="more"></a>
<blockquote>
<p>关于最佳实践方案我提供了一个插件 <a href="https://github.com/calebman/vuepress-plugin-demo-container" target="_blank" rel="noopener">vuepress-plugin-demo-container</a> 来统一解决，插件的具体介绍、示例与使用文档 <a href="https://docs.chenjianhui.site/vuepress-plugin-demo-container/zh/" target="_blank" rel="noopener">点此访问</a>。</p>
</blockquote>
<h1>前言</h1>
<h2 id="什么是组件示例文档？">什么是组件示例文档？</h2>
<p>当你使用 Vue、React 或者其他语言编写了一个组件库，如 <a href="https://element.eleme.cn/2.0/#/zh-CN" target="_blank" rel="noopener">Element UI</a>、<a href="https://www.antdv.com/docs/vue/introduce-cn/" target="_blank" rel="noopener">Ant Design Vue</a> 或是像我一样基于它们开发的业务封装库，都需要使用文档来支撑，而使用文档必然会<strong>包含代码与示例</strong>，这部分就是组件示例文档。</p>
<p>举个例子，Element UI 的 <a href="https://element.eleme.cn/2.0/#/zh-CN/component/color-picker" target="_blank" rel="noopener">Color Picker</a> 组件文档，其中就包含了多份示例代码，假设我们现在完成了组件开发，需要使用 Vuepress 写一份和它一样的使用文档，该怎么做呢？</p>
<h2 id="使用-Vuepress-构建组件示例文档">使用 Vuepress 构建组件示例文档</h2>
<h3 id="方案一">方案一</h3>
<p>熟悉 Vuepress 的同学应该不难想到解决方案，由于 Vuepress 支持在 Markdown 中编写符合 Vue 语法的代码，所以我们可以这么写：</p>
<pre><code class="language-html">## 示例展示
&lt;template&gt;
  &lt;color-picker size=&quot;mini&quot;&gt;&lt;/color-picker&gt;
&lt;/template&gt;
## 示例代码如下
```html
&lt;template&gt;
  &lt;color-picker size=&quot;mini&quot;&gt;&lt;/color-picker&gt;
&lt;/template&gt;
`` ` &lt;= 删除左侧空格
</code></pre>
<h3 id="方案二">方案二</h3>
<p>如果示例中还包含 <code>export default {}</code> 代码块，我们可以借助 Vuepress 会自动注册 <code>components</code> 目录下组件的特性，或者通过 <code>enhanceApp.js</code> 钩子自己注册示例代码文件，然后使用 <code>&lt;&lt;&lt; @/filepath</code> 语法将示例代码文件引入，这部分操作的具体文档可以 <a href="https://vuepress.vuejs.org/zh/guide/markdown.html#%E5%AF%BC%E5%85%A5%E4%BB%A3%E7%A0%81%E6%AE%B5" target="_blank" rel="noopener">点此查看</a>，这么操作下来写法变成了这样：</p>
<pre><code class="language-html">## 示例展示
&lt;color-picker-basic-demo&gt;&lt;/color-picker-basic-demo&gt;
## 示例代码如下
```html
&lt;&lt;&lt; @/docs/.vuepress/components/color-picker-basic-demo.vue
`` ` &lt;= 删除左侧空格
</code></pre>
<h3 id="方案三">方案三</h3>
<p>当然这么做还不太行，我们还想要和 Element UI 或者 Ant Design Vue 一样漂亮的示例代码块，示例部分有框框包起来，代码部分可以省略/展开并提供复制功能、在线编辑功能。这倒也不难，我们可以自己开发一个 <code>DemoBlock</code> 组件来包裹组件示例，结构和样式都可以开发成你自己喜欢的样子，这部分做完后写法变成了这样：</p>
<pre><code class="language-html">&lt;demo-block source=&quot;&lt;color-picker size=\&quot;mini\&quot;&gt;&lt;/color-picker&gt;&quot;&gt;
  &lt;template slot=&quot;demo&quot;&gt;
    &lt;color-picker size=&quot;mini&quot;&gt;&lt;/color-picker&gt;
  &lt;/template&gt;
&lt;/demo-block&gt;
</code></pre>
<h3 id="方案四">方案四</h3>
<p>你会发现 <code>&lt;&lt;&lt; @/filepath</code> 语法在组件内就不好使了，示例和代码得写两遍才行，而且代码还得作为一个 <code>String</code> 传递进去，那有没有办法在上述的实现基础上不写两边示例代码呢？</p>
<p><strong>办法当然是有的，程序员的智慧是无穷的</strong>，<a href="https://github.com/vuepress-reco/vuepress-plugin-extract-code" target="_blank" rel="noopener">vuepress-plugin-extract-code</a> 这个插件给了解决方案，它手动解析了组件内的 <code>&lt;&lt;&lt; @/filepath</code> 语法并将其转换成了代码文本，使用这个插件后写法变成了这样：</p>
<pre><code class="language-html">&lt;reco-demo&gt;
  &lt;color-picker-basic-demo slot=&quot;demo&quot;&gt;&lt;/color-picker-basic-demo&gt;
  &lt;template slot=&quot;code-vue&quot;&gt;
    &lt;&lt;&lt; @/docs/.vuepress/components/color-picker-basic-demo.vue
  &lt;/template&gt;
&lt;/reco-demo&gt;
</code></pre>
<h3 id="方案-Element-UI">方案 Element UI</h3>
<p>到这里我们已经演变了四个版本，暂停一下我们去看看 Element UI 的组件文档是怎么编写的，<a href="https://github.com/ElemeFE/element/blob/dev/examples/docs/zh-CN/color-picker.md" target="_blank" rel="noopener">点此查看 Color Picker 的文档</a>，不想点的直接看下方示例：</p>
<pre><code class="language-html">::: demo 使用 v-model 与 Vue 实例中的一个变量进行双向绑定，绑定的变量需要是字符串类型。
``` html
&lt;template&gt;
  &lt;color-picker size=&quot;mini&quot; v-model=&quot;color&quot;&gt;&lt;/color-picker&gt;
&lt;/template&gt;

&lt;script&gt;
  export default {
    data() {
      return {
        color: '#409EFF'
      }
    }
  };
&lt;/script&gt;
`` ` &lt;= 删除左侧空格
:::
</code></pre>
<p>上述示例的渲染结果 <a href="https://element.eleme.cn/2.0/#/zh-CN/component/color-picker" target="_blank" rel="noopener">点此查看</a>，就这个示例来看，他至少有两点好处：</p>
<ol>
<li><strong>示例与代码不用写两遍</strong></li>
<li><strong>不复杂的示例可以直接写在 Markdown 中编写，不需要每个示例都建一个文件</strong></li>
</ol>
<p>而对比方案四的好处就在于第2点，相比之下后者有更高的灵活度，而方案四需要每个示例都建一个 Vue 文件并且被 Vuepress 全局引入。</p>
<h2 id="如何实现？">如何实现？</h2>
<p><a href="https://github.com/calebman/vuepress-plugin-demo-container" target="_blank" rel="noopener">vuepress-plugin-demo-container</a> 已经实现了上述最佳方案，在 Vuepress 中引入该插件即可获得想要的效果，关于该插件的介绍可以 <a href="https://docs.chenjianhui.site/vuepress-plugin-demo-container/zh/" target="_blank" rel="noopener">点此查看</a>，文档提供了<strong>它的工作原理、渲染效果、与插件比较及使用方式</strong>等描述，在这里我就不再赘述了，如果有建议或疑问可以通过或者评论或者 <a href="https://github.com/calebman/vuepress-plugin-demo-container/issues" target="_blank" rel="noopener">Issus</a> 提供给我，我将尽力解答。</p>
<h1>关于公众号</h1>
<p><img src="https://resources.chenjianhui.site/wechat-qrcode.png" alt></p>

  </div>
</article>
<ul class="post-copyright">
  <li><strong>本文标题：</strong><a href="https://chenjianhui.site/2020-05-31-vuepress-plugin-demo-container/">使用 Vuepress 编写组件示例文档的最佳实践</a></li>
  <li><strong>本文作者：</strong><a href="https://chenjianhui.site">JianhuiChen</a></li>
  <li><strong>本文链接：</strong><a href="https://chenjianhui.site/2020-05-31-vuepress-plugin-demo-container/">https://chenjianhui.site/2020-05-31-vuepress-plugin-demo-container/</a></li>
  <li><strong>发布时间：</strong>2020-05-31</li>
  <li><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
  </li>
</ul>
<div id="gitalk-container"></div>

<!-- Gittalk.js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<!-- Highlight.js -->
<link rel="stylesheet" href="/css/hljs.css">
<script src="/js/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
  const gitalk = new Gitalk({
    clientID: 'bd0cbb30da9c24da8c7c',
    clientSecret: 'bd64a8e8c8117d5f3e22291cd3f29f2c70e671ff',
    repo: 'blog',
    owner: 'calebman',
    admin: ['calebman']
  })
  gitalk.render('gitalk-container')
</script>
  </main>

  <footer class="footer">
    <ul class="footer-links">
      <section class="copyright">
        <a href="https://chenjianhui.site">JianhuiChen</a> © 2017 - 2020 | 
        <a href="http://www.beian.miit.gov.cn" style="line-height: 37px;font-size: 16px;">津ICP备19001724号</a>
      </section>
    </ul>
  </footer>

  
  <!-- scripts list from theme config.yml -->
  
  <script src="/js/simple.js"></script>
  
  

</body>

</html>