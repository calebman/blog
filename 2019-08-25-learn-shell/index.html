

<!DOCTYPE html>
<html lang="zh-CN">

<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <title>Shell学习与归纳 [ Sincerity ]</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="icon" href="/images/favicon-32x32.png">
  
  <!-- stylesheets list from _config.yml -->
  
  <link rel="stylesheet" href="/css/simple.css">
  
  <link rel="stylesheet" href="/css/font.css">
  
  
</head>

<body>

  <header class="header">
    <nav class="nav">
      <a href="/" class="nav-logo"><img src="/images/avatar.png" width="50" height="50" alt="Logo"></a>
      <ul class="nav-links">
        
        <li><a href="/">文章</a></li>
        
        <li><a href="/archives">归档</a></li>
        
        <li><a href="/leetcode">力扣</a></li>
        
        <li><a href="/about">关于我</a></li>
        
        <li><a href="https://github.com/calebman">Github</a></li>
        
      </ul>
    </nav>
  </header>

  <main class="content">
    
<article class="article">
  <h1 class="article-title">Shell学习与归纳</h1>
  <span class="article-date">2019-08-25</span>
  
  
  <a class="article-tag" href="/tags/Shell">
    Shell
  </a>
  
  <a class="article-tag" href="/tags/Linux">
    Linux
  </a>
  
  

  <div><p>  作为一个后端开发工程师在工作中不可能不与<code>Linux</code>服务器打交道，应用的部署测试，中间件的环境搭建，搭建个人的博客，甚至玩玩树莓派这些比较冷门的单片机计算机都离不开<code>Linux</code>指令与<code>Shell</code>编程，本文就来学习与归纳一些我个人用到的<code>Linux</code>指令与<code>Shell</code>语法并给出示例，本文只讲基础，细枝末节将另起博文详细分析。</p>
<a id="more"></a>
<h1>Shell语法归纳</h1>
<h2 id="变量与参数">变量与参数</h2>
<h3 id="变量定义与引用">变量定义与引用</h3>
<pre><code class="language-bash">#!/bin/sh
str=&quot;My name is JianhuiChen.&quot;
echo ${str}
str=&quot;Reset my name&quot;
echo ${str}
unset str
echo ${str}
</code></pre>
<p><img src="https://resources.chenjianhui.site/2019-08-25-shell-exec-result-0.png" alt></p>
<h3 id="参数引用">参数引用</h3>
<pre><code class="language-bash">#!/bin/sh
echo &quot;第一个参数为：$1&quot;
echo &quot;第二个参数为：$2&quot;
echo &quot;传递到脚本的参数个数为：$#&quot;
echo &quot;所有向脚本传递的参数为：$*&quot;
echo &quot;脚本运行的当前进程ID号为：$$&quot;
echo &quot;后台运行的最后一个进程的ID号为：$!&quot;
echo &quot;所有向脚本传递的参数为：$@&quot;
echo &quot;Shell使用的当前选项为：$-&quot;
echo &quot;最后命令的退出状态为：$?&quot;
</code></pre>
<p><img src="https://resources.chenjianhui.site/2019-08-25-shell-exec-result-1.png" alt></p>
<h2 id="逻辑判断、循环与分支选择">逻辑判断、循环与分支选择</h2>
<h3 id="逻辑判断">逻辑判断</h3>
<pre><code class="language-bash">#!/bin/sh
x=5
y=10
z=20
# if then
echo &quot;if then command&quot;
if [ $x != $y ]
then
  echo &quot;$x != $y&quot;
  echo &quot;Print again $x == $y&quot;
fi
# if else
echo &quot;if else command&quot;
if [ $x != $y ]
then
  echo &quot;$x != $y&quot;
  echo &quot;Print again $x != $y&quot;
else
  echo &quot;$x == $y&quot;
fi
# if else-if else
echo &quot;if else-if else command&quot;
if [ $x == $y ]
then
  echo &quot;$x == $y&quot;
elif [ $y == $z ]
then
  echo &quot;$x != $y and $y == $z&quot;
else
  echo &quot;$x != $y and $y != $z&quot;
fi
</code></pre>
<p><img src="https://resources.chenjianhui.site/2019-08-25-shell-exec-result-2.png" alt></p>
<h3 id="循环">循环</h3>
<pre><code class="language-bash">#!/bin/sh
# Define array
arr=(1 2 3 4 5)
# For loop
echo &quot;For loop&quot;
for var in ${arr[*]}
do
  echo &quot;$var&quot;
done
# While loop
echo &quot;While loop&quot;
i=0
while (( $i &lt; ${#arr[*]} ))
do
  echo &quot;${arr[$i]}&quot;
  let &quot;i++&quot;
done
# Break and continue
echo &quot;Break and continue&quot;
j=0
while [[ $j &lt; ${#arr[*]} ]]
do
  if [ $j == 3 ]
  then
    echo &quot;Break in ${arr[$j]}&quot;
    break
  elif [ $j == 1 ]
  then
    echo &quot;Dump ${arr[$j]}&quot;
    let &quot;j++&quot;
    continue
  else
    echo &quot;Print ${arr[$j]}&quot;
  fi
  let j++
done
</code></pre>
<p><img src="https://resources.chenjianhui.site/2019-08-25-shell-exec-result-3.png" alt></p>
<h3 id="分支选择">分支选择</h3>
<pre><code class="language-bash">#!/bin/sh
x=3
case $x in
    1)  echo 'Case 1'
    ;;
    2)  echo 'Case 2'
    ;;
    3)  echo 'Case 3'
    ;;
    4)  echo 'Case 4'
    ;;
    *)  echo 'Default'
    ;;
esac
</code></pre>
<h2 id="输出重定向">输出重定向</h2>
<pre><code class="language-bash">#!/bin/sh
export BIN_PATH=$(cd `dirname $0`;pwd)
echo BIN_PATH:[$BIN_PATH]
# 输出重定向到文件 &gt;&gt; 代表追加
nohup ping 127.0.0.1 &gt; exec.log 2&gt;&amp;1 &amp;
echo [if you want stop app, can run] kill -9 $!
echo [if you want search logs, can run] tail -f $BIN_PATH/exec.log
</code></pre>
<p><img src="https://resources.chenjianhui.site/2019-08-25-shell-exec-result-4.png" alt></p>
<p>第一次看到<code>nohup ping 127.0.0.1 &gt; exec.log 2&gt;&amp;1 &amp;</code>这条语句的同学可能会有点懵逼，在这里我们一段一段来理解这条语句</p>
<ul>
<li><code>nohub</code>：当前进程退出后运行程序不退出，也就是后台运行</li>
<li><code>ping 127.0.0.1</code>：具体执行的语句，这句就不过多解释了</li>
<li><code>&gt; exec.log</code>：将语句执行的结果输出到<code>shell</code>脚本同级目录的exec.log文件，采用覆盖的模式，如果是追加输出可使用<code>&gt;&gt;</code>替换<code>&gt;</code></li>
<li><code>2&gt;&amp;1</code>：这句可能会复杂点，意思是将标准错误等效于标准输出，其中<code>&amp;</code>起到了等效的作用
<ul>
<li>0 表示stdin标准输入</li>
<li>1 表示stdout标准输出</li>
<li>2 表示stderr标准错误</li>
</ul>
</li>
<li>最后一个<code>&amp;</code>：这个是配合<code>nohub</code>使用的，意思是在脚本的结尾让程序自动运行，没有此指令脚本运行会卡在<code>nohub</code>处需要按一下任意键才可继续执行</li>
</ul>
<h1>Linux指令与常用库归纳</h1>
<h2 id="文件与目录">文件与目录</h2>
<ul>
<li><code>ls</code>：列表显示文件与目录信息</li>
<li><code>tree</code>：树形显示文件与目录信息</li>
<li><code>cd</code>：切换目录</li>
<li><code>mkdir</code>：创建目录</li>
<li><code>pwd</code>：以绝对路径的方式显示用户当前工作目录</li>
<li><code>cp</code>：拷贝文件</li>
<li><code>rm</code>：删除文件</li>
<li><code>mv</code>：移动文件</li>
<li><code>diff</code>：比较文件差异</li>
<li><code>chmod</code>：文件授权</li>
<li><code>cat</code>：查看文件内容</li>
<li><code>head</code>：显示文件的头几行</li>
<li><code>tail</code>：显示文件的后几行</li>
<li><code>touch</code>：创建一个新文件</li>
<li><code>tar</code>：压缩与解压缩</li>
<li><code>sed</code>：非交互式文本编辑</li>
<li><code>vi</code>：交互式文本编辑，按<code>i</code>插入文本编辑文件，按<code>ESC</code>输入指令退出
<ul>
<li><code>:w</code>：写入文件</li>
<li><code>:w!</code>：不询问方式写入文件</li>
<li><code>:wq</code>：保存并退出</li>
<li><code>:q</code>：退出,</li>
<li><code>:q!</code>：不保存退出</li>
</ul>
</li>
</ul>
<blockquote>
<p>完成下面的语句对你记忆这些基础指令会有帮助</p>
</blockquote>
<pre><code class="language-bash">#!/bin/sh
# 查看当前工作目录与其结构
pwd
ls
tree
# 创建一个目录 test-dir
mkdir test-dir
# 进入此目录
cd test-dir
# 创建一个文件 README.md
touch README.md
# 编辑文件插入一些内容
vi README.md
# 查看内容
cat README.md
# 查看文件的前两行
head -n2 README.md
# 循环读取文件的后三行
tail -n3 -f README.md
# 复制 README.md 到同级目录 README-COPY.md
cp README.md README-COPY.md
# 修改 README-COPY.md 的内容
vi README-COPY.md
# 与原文件比较差异性
diff README.md README-COPY.md
# 移动 README.md 到上一级目录
mv README.md ..
# 删除上一级目录的 README.md
rm ../README.md
# 将 README-COPY.md 重命名为 README.md
mv README-COPY.md README.md
# 授予 README.md 权限
chmod +x README.md
# 压缩 test-dir 目录
cd ..
tar -czvf test-dir.tar.gz test-dir
# 删除 test-dir 目录 建议使用参数 -i 进入询问模式
rm -rf test-dir
# 解压 test-dir.tar.gz
tar -xzvf test-dir.tar.gz
</code></pre>
<h2 id="网络与常用库">网络与常用库</h2>
<ul>
<li><code>ifconfig</code>：查看网络网卡信息</li>
<li><code>netstat</code>：显示网络状态，查看网络端口或者路由信息</li>
<li><code>lsof</code>：用于查看你进程开打的文件，打开文件的进程，进程打开的端口(TCP、UDP)</li>
<li><code>ping</code>：不多说了</li>
<li><code>telnet</code>：执行远程登录，可用测试网络端口链路是否通畅</li>
<li><code>ssh</code>：使用ssh协议远程登录主机</li>
<li><code>scp</code>：用于Linux之间复制文件和目录</li>
<li><code>ftp</code>：基于ftp协议的文件传输指令</li>
<li><code>wget</code>：网络下载器</li>
<li><code>curl</code>：<code>http</code>命令行工具</li>
</ul>
<h2 id="系统">系统</h2>
<ul>
<li><code>shutdown</code>：关机</li>
<li><code>reboot</code>：重启</li>
<li><code>mount</code>：挂在次盘/文件系统</li>
<li><code>umount</code>：卸载磁盘/文件系统</li>
<li><code>exit</code>：退出当前终端</li>
<li><code>last</code>：显示最近一次登录的用户</li>
<li><code>history</code>：显示输入过的历史指令</li>
<li><code>ps</code>：列出系统中当前运行的进程</li>
<li><code>top</code>：实时显示系统资源的使用情况</li>
<li><code>free</code>：显示内存使用情况</li>
<li><code>quota</code>：显示磁盘使用情况</li>
<li><code>kill</code>：中止一个进程</li>
<li><code>uname</code>：显示操作系统相关信息的命令</li>
<li><code>du</code>：计算磁盘空间的使用情况</li>
<li><code>df</code>：报告文件系统磁盘空间的使用情况</li>
<li><code>su</code>：切换身份</li>
</ul>
</div>

  

</article>
<ul class="post-copyright">
  <li><strong>本文标题：</strong><a href="https://chenjianhui.site/2019-08-25-learn-shell/">Shell学习与归纳</a></li>
  <li><strong>本文作者：</strong><a href="https://chenjianhui.site">JianhuiChen</a></li>
  <li><strong>本文链接：</strong><a href="https://chenjianhui.site/2019-08-25-learn-shell/">https://chenjianhui.site/2019-08-25-learn-shell/</a></li>
  <li><strong>发布时间：</strong>2019-08-25</li>
  <li><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
  </li>
</ul>
<div id="gitalk-container"></div>

<!-- Gittalk.js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<!-- Highlight.js -->
<link rel="stylesheet" href="/css/hljs.css">
<script src="/js/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
  const gitalk = new Gitalk({
    clientID: 'bd0cbb30da9c24da8c7c',
    clientSecret: 'bd64a8e8c8117d5f3e22291cd3f29f2c70e671ff',
    repo: 'blog',
    owner: 'calebman',
    admin: ['calebman']
  })
  gitalk.render('gitalk-container')
</script>
  </main>

  <footer class="footer">
    <ul class="footer-links">
      <section class="copyright">
        <a href="https://chenjianhui.site">JianhuiChen</a> © 2017 - 2020 | 
        <a href="http://www.beian.miit.gov.cn" style="line-height: 37px;font-size: 16px;">津ICP备19001724号</a>
      </section>
    </ul>
  </footer>

  
  <!-- scripts list from theme config.yml -->
  
  <script src="/js/simple.js"></script>
  
  

</body>

</html>