{"pages":[{"title":"å…³äºæˆ‘","text":"æˆ‘æ˜¯è°ç¨‹åºå‘˜ä¸€æšï¼Œå–œçˆ±ç†Ÿæ‚‰çš„ä¸ç†Ÿæ‚‰çš„æŠ€æœ¯ï¼ŒæŒæ¡å„ç§æŠ€æœ¯åç§°çš„æ‹¼å†™ï¼Œå°¤å…¶æ˜¯Vuejsä¸Javaã€‚ è”ç³»æ–¹å¼ WeChat: Nc_Nobbdy Mail: chenjianhui0428@gmail.com Github: https://github.com/calebman Blog: https://chenjianhui.site QQ: 675557552 ä¸å’‹ç”¨å°±æ˜¯ ä¸ªäººç»å†17å¹´æ¯•ä¸šäº@å—æ˜Œèˆªç©ºå¤§å­¦ï¼Œç°åˆ’æ°´äºå¤©æ´¥ å…´è¶£çˆ±å¥½ å¦‚æœæœ‰ä¸€å¤©æ˜¯å‘¨æœ«ï¼Œäº‹æƒ…çš„ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åºå¤§æ¦‚æ˜¯è¿™æ ·çš„ é™ªå¥³ç›†å‹ï¼ˆè¿™å¾ˆé‡è¦ï¼‰ åŠ ç­ï¼Ÿï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ å’Œç”·ç›†å‹æ‰“dotaï¼ˆåˆ«è¯´æ•™å¥³ç›†å‹æ‰“dotaè¿™å°±ä¸¤å…¨äº†ï¼Œè¿™å±äºå‘è‡ªå·±ğŸ¶ï¼‰ åˆ·åˆ·æŠ€æœ¯åšå®¢ã€å¼€æºé¡¹ç›®ï¼ˆæå‡å†™ä½œèƒ½åŠ›ï¼‰ ç»´æŠ¤è‡ªå·±çš„é¡¹ç›®ã€å†™åšå®¢ï¼ˆæœ‰è¿™é¡¹çˆ±å¥½å·²ç»å¾ˆä¸å®¹æ˜“äº†ï¼Œè¿˜ç®¡æ’åœ¨ç¬¬å‡ ï¼Ÿï¼‰ ä¼šæ‰“ç¯®çƒã€ç¾½æ¯›çƒä¹‹ç±»çš„ï¼ˆå¦‚æœæœ‰äººä¸€èµ·æ‰“çš„è¯ï¼Œç°å®æ˜¯æ²¡æœ‰ğŸ˜¢ï¼‰ å¯¹è‡ªå·±çš„æœŸæœ›åœ¨å¤§å­¦çš„æ—¶å€™ç”˜è€å¸ˆè·Ÿæˆ‘è¯´è¿‡ä¸€å¥è¯ ä½ çœ‹è¿‡ä¸ä»£è¡¨ä½ ä¼šäº†ï¼Œä½ å†™è¿‡ä¸ä»£è¡¨ä½ ä¼šäº†ï¼Œä½ èƒ½æ•™ç»™åˆ«äººæ‰ä»£è¡¨ä½ ä¼šäº†ã€‚ åˆ°ç°åœ¨ä¸ºæ­¢ä¸€å¹´å¤šåšæŒå†™åšå®¢çš„ç»å†è®©æˆ‘è®¤è¯†åˆ°è¿™å¥è¯ï¼Œä¸€ä¸ªç³»ç»Ÿçš„çŸ¥è¯†ç”±å¾ˆå¤šç¢ç‰‡åŒ–çš„çŸ¥è¯†ç‚¹ç»„æˆï¼Œæ¨¡æ‹Ÿæ•™å­¦æ€ç»´èƒ½å¤Ÿå¾ˆå¥½çš„å°†å®ƒä»¬èšåˆåˆ°ä¸€èµ·ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ç°åœ¨å†™åšæ–‡çš„ä¸€ç§æ€ç»´æ¨¡å¼ï¼ŒåŒæ—¶æ¨èç»™ä½ ä»¬ã€‚ ä¸‡äº‹å¼€å¤´éš¾ï¼Œæ„Ÿè°¢è‡ªå·±å¼€äº†ä¸ªå¥½å¤´ï¼ŒåšæŒå†™åšå®¢çš„æ—¥å­å¾ˆå……å®ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿç»§ç»­åšæŒä¸‹æ¥ã€‚","link":"/about/index.html"},{"title":"categories","text":"","link":"/categories/index.html"},{"title":"tags","text":"","link":"/tags/index.html"}],"posts":[{"title":"ç”¨æœºå™¨å­¦ä¹ ç©è½¬FlappyBird","text":"&emsp;&emsp;ä¸¤å¹´å‰åˆšæ¯•ä¸šçš„æ—¶å€™ç”±äºå…´è¶£çˆ±å¥½å°±æ¥è§¦åˆ°äº†ä¸€äº›æœºå™¨å­¦ä¹ çš„å†…å®¹ï¼Œä»Šå¤©æƒ³åˆ°å†™è¿™ä¹ˆä¸€ç¯‡æ–‡ç« çš„ä¸»è¦åŸå› æ˜¯ç”±äºå…¬å¸å®‰æ’æ˜¨å¤©å»æ¥é€äº†ä¸€ä½åšæ•°æ®æŒ–æ˜æ–¹å‘çš„æ•™æˆï¼Œåœ¨æ¥é€é€”ä¸­è·Ÿå¥¹èŠäº†ä¸€äº›æœ‰å…³æ•°æ®æŒ–æ˜ä¸æœºå™¨å­¦ä¹ æ–¹é¢çš„å†…å®¹å¹¶ä¸”ä»ä¸­å—ç›Šï¼ŒåŠ ä¸Šè‡ªå·±çš„éƒ¨åˆ†å…´è¶£äºæ˜¯å°±æƒ³äº§å‡ºä¸€ç¯‡æ–‡ç« æ¥è¯´ä¸€ä¸‹è‡ªå·±å¯¹äºè¿™å—å†…å®¹çš„ç†è§£ï¼Œç”±äºä¸“ä¸šæ€§çš„é—®é¢˜å…¶ä¸­è¯´æ³•å¦‚æœæœ‰è¯¯è¿˜è¯·æŒ‡å‡ºã€‚ æœ¬ç¯‡åšå®¢ç›¸å…³ä»£ç æ‰˜ç®¡äºgithubæ¸¸æˆå¼•æ“ä¸AIåŸºäºVuejs+TypeScript+Tensorflow.jså®ç°ï¼Œç‚¹æ­¤åœ¨çº¿é¢„è§ˆå¦‚æœè¿™ä¸ªé¡¹ç›®æ¿€èµ·äº†ä½ çš„å…´è¶£ï¼Œæ¬¢è¿åˆ†äº«ä¸Star æ¦‚è¿°æœ¬ç¯‡æ–‡ç« æˆ‘å°†ä»ä¸‰ä¸ªæ–¹é¢å»é˜è¿°æˆ‘ä¸ªäººçš„æœºå™¨å­¦ä¹ ç»å†åŠç†è§£ï¼Œä¹Ÿç®—æ˜¯æˆ‘è¿™éƒ¨åˆ†çŸ¥è¯†çš„ä¸€ä¸ªæˆé•¿ç»å†ã€‚ åˆæ¢æœºå™¨å­¦ä¹ ï¼šè¿™é‡Œä¸»è¦æ˜¯æè¿°ä¸€ä¸‹æˆ‘æ¯•ä¸šä¸ä¹…åæ¥è§¦çš„ä¸€ä¸ªGithubä»“åº“FlappyLearningï¼Œè¿™ä¸ªä»“åº“ç”¨äº†ä¸€ä¸ªå¾ˆå½¢è±¡çš„ä¾‹å­æ¥æè¿°æœºå™¨å­¦ä¹ çš„ä½œç”¨ï¼Œè¿™ä¸ªä¾‹å­è§£å†³äº†æˆ‘çš„ä¸€ä¸ªç–‘æƒ‘ï¼Œæœºå™¨å¦‚ä½•é’ˆå¯¹ä¸€ä¸ªé—®é¢˜åšå‡ºå†³ç­–ï¼Ÿ åå‘ä¼ æ’­ä¸é—ä¼ ç®—æ³•ï¼šè¿™ä¸¤ä¸ªç®—æ³•å¾ˆå…·æœ‰ä»£è¡¨æ€§ï¼Œæœºå™¨å†³ç­–çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªå‡½æ•°æ¨¡å‹ï¼Œé—®é¢˜çš„å†³ç­–å’Œæ¨¡å‹çš„å‡ºå‚ä¸é˜ˆå€¼æœ‰å…³ï¼Œæ‰€ä»¥æœºå™¨å­¦ä¹ çš„ç›®çš„å°±æ˜¯æ„é€ ä¸€ä¸ªé€‚ç”¨äºé—®é¢˜çš„å‡½æ•°ä»¥åŠåˆé€‚çš„åˆ†ç±»é˜ˆå€¼ï¼Œè€Œæ„é€ çš„è¿‡ç¨‹å¯ä»¥ç”¨è¿™ä¸¤ä¸ªç®—æ³•æ¥å®ç° åŸºäºTensorflowç©è½¬FlappyBirdï¼šTensorflowæ˜¯è°·æ­Œçš„ä¸€ä¸ªæœºå™¨å­¦ä¹ å¼€æºåº“ï¼Œèƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„æ„é€ ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œç°åœ¨åœ¨jsä¸­ä¹Ÿæœ‰å®ç°ç‰ˆæœ¬ï¼Œå­¦ä¹ çš„é€”å¾„ä¹Ÿå¾ˆå¤šï¼Œè¿™æ¬¡æˆ‘å°†åŸºäºTensorflowæ¥æ”¹é€ FlappyLearningè¿™ä¸ªä»“åº“ï¼Œé¡ºä¾¿è®©è‡ªå·±å­¦ä¹ Tensorflowçš„é€”ä¸­ä¸é‚£ä¹ˆæ¯ç‡¥ åˆæ¢æœºå™¨å­¦ä¹ å¯¹äºæœºå™¨å­¦ä¹ çš„æ¦‚å¿µè§£é‡Šæˆ‘æœ¬äººä¸æ˜¯è§£é‡Šçš„å¾ˆæ¸…æ¥šï¼Œä½†æ˜¯æˆ‘å¯ä»¥ä»åº”ç”¨åœºæ™¯æ–¹é¢æ¥åˆ†æä¸€ä¸‹æœºå™¨å­¦ä¹ åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šé€‚ç”¨ï¼Œæœºå™¨å­¦ä¹ ç°æœ‰çš„åº”ç”¨åœºæ™¯ä¸»è¦åŒ…æ‹¬å„ç§è¯†åˆ«ã€æ¨èã€å¹¿å‘Šã€å®¢æœï¼Œè¿™äº›åœºæ™¯æˆ‘è®¤ä¸ºæœ‰ä»¥ä¸‹å‡ ä¸ªå…±æ€§ ä¸å®¹æ˜“ç”¨ç»Ÿä¸€çš„é€»è¾‘å½’çº³ï¼šæ¯”å¦‚äººè„¸çš„ç‰¹å¾å€¼æ¯”å¯¹ï¼Œæˆ‘ä»¬å¾ˆéš¾ç¼–å†™ç»Ÿä¸€çš„é€»è¾‘ä»£ç æ¥ç¡®å®šæ€æ ·çš„ä¸¤ç»„ç‰¹å¾å€¼æ‰ç®—æ˜¯æ¯”å¯¹æˆåŠŸ æ ¹æ®å†å²æ•°æ®ç»™å‡ºé¢„æµ‹ï¼šæ¯”å¦‚ç½‘æ˜“äº‘éŸ³ä¹çš„æ¯æ—¥æ¨èï¼Œå½“ä½ ç”¨å¾—è¶Šä¹…æ”¶è—/å–œæ¬¢ç‚¹å‡»çš„è¶Šå¤šï¼Œå®ƒæ¨èç»™å’Œä½ å£å‘³æ­Œæ›²çš„å æ¯”å°±è¶Šå¤§ï¼Œä½†æ˜¯æ²¡æœ‰å†å²æ•°æ®å°±ä¼šä¸å‡†ç¡®ã€‚ éƒ½å±äºåˆ†ç±»æˆ–èšç±»é—®é¢˜ï¼šåœ¨è¿™é‡Œè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯åˆ†ç±»ä¸èšç±»ï¼Œå¹¶ç»™å‡ºç›¸åº”çš„ä¾‹å­ åˆ†ç±»ï¼šé€šè¿‡å­¦ä¹ å¾—åˆ°ä¸€ä¸ªç›®æ ‡å‡½æ•°fï¼ŒæŠŠæ¯ä¸ªå±æ€§é›†xæ˜ å°„åˆ°ä¸€ä¸ªé¢„å…ˆå®šä¹‰çš„ç±»æ ‡å·yä¸­ï¼Œæ¯”å¦‚æ ¹æ®äººè„¸ç‰¹å¾å€¼æ¥åˆ¤æ–­æ­¤æ¬¡æ¯”å¯¹æ˜¯å±äºæ¯”å¯¹æˆåŠŸ/å¤±è´¥çš„å“ªç§ç±»åˆ«ã€‚ èšç±»ï¼šäº‹å…ˆå¹¶ä¸çŸ¥é“ä»»ä½•æ ·æœ¬çš„ç±»åˆ«æ ‡å·ï¼Œå¸Œæœ›é€šè¿‡æŸç§ç®—æ³•æ¥æŠŠä¸€ç»„æœªçŸ¥ç±»åˆ«çš„æ ·æœ¬åˆ’åˆ†æˆè‹¥å¹²ç±»åˆ«ï¼Œæ¯”å¦‚å¹¿å‘ŠæŠ•æ”¾ä¸šåŠ¡ä¸­å°†ç”¨æˆ·ç¾¤ä½“åˆ†ç±»ç„¶ååˆ†åˆ«æŠ•æ”¾ä¸åŒçš„å¹¿å‘Šã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨FlappyLearningæ¥äº†è§£ä¸€ä¸‹æœºå™¨æ˜¯æ€ä¹ˆé€šè¿‡è‡ªæˆ‘å­¦ä¹ åšå‡ºå†³ç­–çš„ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹è¿™ä¸ªæ¸¸æˆ Scoreï¼šå½“å‰æ¸¸æˆå¾—åˆ† Max Scoreï¼šä»£è¡¨æ¸¸æˆæœ€é«˜å¾—åˆ† Generationï¼šä»£è¡¨é¸Ÿçš„ä»£æ•°ï¼Œå½“50åªé¸Ÿæ­»å®Œäº†å°±ä¼šé€šè¿‡é—ä¼ ç®—æ³•çš„ä¼˜èƒœåŠ£æ±°åŸåˆ™ç»è¿‡é—ä¼ å˜å¼‚ç”Ÿæˆæ–°çš„äº”ååªé¸Ÿå‚åŠ æ¸¸æˆ Aliveï¼šä»£è¡¨å½“å‰æ¸¸æˆä¸‹é¸Ÿçš„å­˜æ´»é‡ä»¥åŠæ€»æ•°é‡ x1/x2â€¦æŒ‰é’®ï¼šä»£è¡¨æ¸¸æˆè¿è¡Œé€Ÿç‡ï¼Œå¯ä»¥è°ƒå¿«ä¸€ç‚¹å¤§æ¦‚ç»è¿‡10-20ä»£æœºå™¨ä¾¿èƒ½å­¦ä¼šæ­¤æ¸¸æˆ æœºå™¨å¦‚ä½•é€šè¿‡è‡ªæˆ‘å­¦ä¹ æ¥é€šå…³æ¸¸æˆçš„ï¼Œæˆ‘å°†ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢åˆ†æä¸€ä¸‹ï¼š æœºå™¨æ˜¯å¦‚ä½•æ¥å†³ç­–æ¸¸æˆèµ°å‘çš„ï¼Ÿ å¦‚ä½•è·å¾—ä¸€ä¸ªåˆé€‚çš„å†³ç­–å‡½æ•°ï¼Ÿ æœºå™¨æ˜¯å¦‚ä½•æ¥å†³ç­–æ¸¸æˆèµ°å‘çš„æˆ‘ä»¬ä¸Šé¢è®²åˆ°æœºå™¨å­¦ä¹ å¤§éƒ¨åˆ†å¯ä»¥åˆ†ä¸ºåˆ†ç±»ä¸èšç±»ä¸¤ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹FlappyBirdè¿™ä¸ªæ¸¸æˆçš„ç©æ³•ï¼Œç©å®¶éœ€è¦æ ¹æ®å°é¸Ÿæ‰€å¤„çš„å½“å‰ä½ç½®æ¥æ§åˆ¶å°é¸Ÿçš„é£è¡Œï¼ˆè·³è·ƒï¼‰ï¼Œä»è€Œä½¿å¾—å°é¸Ÿä¸ä¼šæ’åˆ°éšœç¢ç‰©ã€‚ ç°åœ¨æˆ‘ä»¬æ¥æ¢ä¸ªæ›´æ¥æœºå™¨åœ°æ°”çš„è¯´æ³•ï¼Œå‡è®¾æ¯ä¸ªå°é¸Ÿéƒ½æœ‰ä¸€ä¸ªé£è¡Œåˆ¤æ–­å‡½æ•°y=f(x1,x2â€¦)ï¼Œå…¶ä¸­x1,x2â€¦éƒ½æ˜¯å‡½æ•°çš„è¾“å…¥å‚æ•°ï¼Œyæ˜¯å‡½æ•°çš„è¾“å‡ºå‚æ•°ï¼Œæˆ‘ä»¬è¦æ ¹æ®ç»“æœyæ¥å†³ç­–å½“å‰ç¯å¢ƒæ˜¯å¦éœ€è¦è·³è·ƒï¼Œå¦‚æœf(x1,x2â€¦)è¿™ä¸ªå‡½æ•°é€‚åˆäºè¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆå°é¸Ÿå°±èƒ½æ ¹æ®è¿™ä¸ªå‡½æ•°å®Œç¾çš„é€šå…³æ¸¸æˆã€‚ å¦‚æœæŒ‰ç…§ä¸Šè¿°æ–¹å¼å»ç†è§£çš„è¯ï¼Œæœºå™¨å­¦ä¹ çš„ç›®çš„æ˜¯ä»€ä¹ˆå°±æ˜¾è€Œæ˜“è§äº†ï¼Œå°±æ˜¯ä¸ºäº†å¯»æ‰¾ä¸€ä¸ªé€‚åˆäºç‰¹å®šåœºæ™¯çš„å†³ç­–å‡½æ•°ï¼Œèµ·åˆ°é«˜å‡†ç¡®ç‡çš„é¢„æµ‹æ•ˆæœï¼Œæ‹¿FlappyBirdè¿™ä¸ªæ¸¸æˆä¸¾ä¾‹ï¼Œè¿™ä¸ªæ¸¸æˆçš„è¾“å…¥å¯ä»¥æ˜¯ä»¥ä¸‹å¾ˆå¤šç§å¹¶ä¸”ä¸é™äºæ­¤ ä¸€å¸§å›¾ç‰‡ å°é¸Ÿè·ç¦»çš„éšœç¢ç‰©çš„å‚ç›´è·ç¦» å°é¸Ÿè·ç¦»éšœç¢ç‰©çš„æ°´å¹³è·ç¦» ä¸ºä»€ä¹ˆè¦ä¸“é—¨æ‹¿è¾“å…¥è¿™ä¸ªæ¦‚å¿µæ¥è¯´ï¼Ÿæˆ‘ä»¬æ¥æ¨¡æ‹Ÿäººç±»ç©è¿™ä¸ªæ¸¸æˆï¼Œäººç±»é€šè¿‡çœ¼ç›æ¥è·å–å°é¸Ÿçš„ä½ç½®ä¿¡æ¯ï¼ˆå…¶å®åœ¨å…³æ³¨å°é¸Ÿå’Œéšœç¢ç‰©çš„ç›¸å¯¹è·ç¦»ï¼‰ï¼Œæ¥å†³ç­–å°é¸Ÿæ˜¯å¦éœ€è¦è·³è·ƒï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹æŠ½è±¡æˆä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆä½ çœ¼ç›è·å–çš„ä½ç½®ä¿¡æ¯å°±æ˜¯è¾“å…¥ï¼Œä½ çš„å†³ç­–å³æ˜¯è¾“å‡ºï¼Œè€Œæˆ‘è¦åœ¨è¿™é‡Œè¯´çš„æ˜¯ä½ è·å–çš„è¿™ä¸ªä½ç½®ä¿¡æ¯å¹¶ä¸æ˜¯æœ€å¥½çš„è¾“å…¥ï¼Œè®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœå±å¹•ä¸Šæ‰“å°äº†ä½ ç°åœ¨è·ç¦»éšœç¢ç‰©çš„æ°´å¹³å’Œå‚ç›´è·ç¦»å¹¶ä¸”å‘Šè¯‰äº†ä½ æ¯æ¬¡è·³è·ƒå°†ä¼šç›¸å¯¹ç§»åŠ¨å¤šå°‘è·ç¦»ï¼Œä½ æ˜¯ä¸æ˜¯èƒ½æ›´åŠ å®¹æ˜“çš„æŒæ¡è¿™ä¸ªæ¸¸æˆã€‚ åŒç†ï¼Œä¸€ä¸ªæ›´å¥½æ›´åˆç†æ›´æœ‰å…³è”æ€§çš„è¾“å…¥å¯¹äºæœºå™¨æ¥è¯´ä¹Ÿèƒ½é™ä½å®ƒçš„å­¦ä¹ æˆæœ¬ï¼Œå‡å¦‚ä½ åªç»™æœºå™¨ä¸€ä¸ªå°é¸Ÿæ— å…³ä¸éšœç¢ç‰©çš„å‚ç›´è·ç¦»ä½œä¸ºè¾“å…¥å‚æ•°ï¼Œé‚£ä¹ˆæ— è®ºä½ ç”¨ä»€ä¹ˆç®—æ³•ï¼Œä»–éƒ½æ°¸è¿œæ— æ³•å­¦ä¼šç©è¿™ä¸ªæ¸¸æˆã€‚åœ¨FlappyLearningè¿™ä¸ªä»“åº“ä¸­ï¼Œä½œè€…ç»™äºˆæœºå™¨çš„è¾“å…¥ä¿¡æ¯ä¸ºå°é¸Ÿè·ç¦»çš„éšœç¢ç‰©çš„å‚ç›´è·ç¦»ä¸å°é¸Ÿè·ç¦»éšœç¢ç‰©çš„æ°´å¹³è·ç¦»ã€‚ è®²åˆ°è¿™é‡Œå…¶å®å·²ç»èƒ½å¤Ÿè§£ç­”ç¬¬ä¸€ä¸ªé—®é¢˜äº†ï¼Œæœºå™¨å…¶å®æ˜¯é€šè¿‡ä¸€ä¸ªå†³ç­–å‡½æ•°æ¥ä»£å…¥ä¸€ç»„è¾“å…¥ç„¶åæ ¹æ®è¾“å‡ºç»“æœå…³è”åˆ°æ¸¸æˆçš„å…·ä½“æ“ä½œã€‚å¦‚æœä½ å·²ç»çœ‹åˆ°äº†è¿™é‡Œä½ å¯ä»¥å‘ç°æˆ‘çš„æ–‡ç« ä¸­å°†éƒ¨åˆ†æœºå™¨è¡Œä¸ºç±»æ¯”äº†äººç±»è¡Œä¸ºï¼ŒåŒæ ·åœ¨åæ–‡ä¸­æˆ‘ä¹Ÿä¼šä½¿ç”¨ç±»æ¯”è¿™ä¸ªæ€æƒ³å»æ›´é€šä¿—æ˜“æ‡‚çš„è®²è¿°å…¶ä»–é—®é¢˜ã€‚ å¦‚ä½•è·å¾—ä¸€ä¸ªåˆé€‚çš„å†³ç­–å‡½æ•°åœ¨FlappyLearningè¿™ä¸ªä»“åº“ä¸­ä½œè€…æ˜¯ä½¿ç”¨äº†é—ä¼ ç®—æ³•å»è§£å†³å†³ç­–å‡½æ•°çš„æ„é€ é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æ€è€ƒä½œè€…ä¸ºä»€ä¹ˆé€‰æ‹©é—ä¼ ç®—æ³•ï¼Ÿé—ä¼ ç®—æ³•é€‚ç”¨çš„åœºæ™¯æœ‰ä»€ä¹ˆï¼Ÿå¦‚ä½•åœ¨ç¨‹åºä¸­ä½¿ç”¨é—ä¼ ç®—æ³•ï¼Ÿåœ¨è¿™éƒ¨åˆ†æˆ‘å°†å›´ç»•ç€è¿™ä¸‰ä¸ªé—®é¢˜æ¥è§£é‡Šã€‚ ä¸ºä»€ä¹ˆé€‰æ‹©é—ä¼ ç®—æ³• é—ä¼ ç®—æ³•å±äºä¸€ç§éšæœºæœç´¢ç®—æ³•\b\b\bï¼Œè¿™ç§ç®—æ³•å¾ˆå¤šæ—¶å€™ä¸ä¼šç»™å‡ºä¸€ä¸ªâ€œæœ€ä¼˜è§£â€ï¼Œè€Œæ˜¯ç»™å‡ºä¸€äº›è¾ƒä¸ºæ¥è¿‘çš„æ¬¡ä¼˜è§£ï¼Œä»ä¸­çŸ®å­é‡Œé¢æ‹”å°†å†›ã€‚Flappyè¿™ä¸ªæ¸¸æˆä»åˆšå¼€å§‹çš„ä¸€æ— æ‰€æœ‰åˆ°åé¢çš„éšä¾¿é€šå…³ä¾èµ–çš„å°±æ˜¯éšæœºæœç´¢ï¼Œå…ˆéšæœºå‚æ•°å¾—åˆ°ä¸€ä¸ªå‡½æ•°æ¨¡å‹å†ä¸æ–­çš„è¿­ä»£å¾—åˆ°ä¸€ä¸ªæ¬¡ä¼˜è§£å‚ä¸æ¸¸æˆã€‚ å…¶å®åœ¨è®¡ç®—æœºä¸–ç•Œä¸­çš„å¾ˆå¤šç†è®ºéƒ½æ˜¯æ ¹æ®ç°å®ç”Ÿæ´»ä¸­çš„ç†è®ºæ˜ å°„æ¥çš„ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è¾¾å°”æ–‡è¿›åŒ–è®ºæœ‰ä¸€ä¸ªæ ¸å¿ƒæ€æƒ³å«åšç‰©ç«å¤©æ‹©é€‚è€…ç”Ÿå­˜ï¼Œç”Ÿç‰©åœ¨ä¸æ–­è¿›åŒ–çš„è·¯é€”ä¸­æ€»æ˜¯ä¼šæ·˜æ±°æ‰ä¸é€‚åˆçš„åŸºå› ï¼Œæ‰€ä»¥æœ€ç»ˆç•™ä¸‹çš„éƒ½æ˜¯èƒ½å¤Ÿåœ¨è¿™ä¸ªä¸–ç•Œæ­£å¸¸ç”Ÿå­˜ä¸‹å»çš„åŸºå› ï¼Œå¦‚æœæˆ‘ä»¬å°†FlappyBirdè¿™ä¸ªæ¸¸æˆå½“ä½œä¸€ä¸ªä¸–ç•Œï¼Œé‚£ä¹ˆé‡Œé¢çš„å°é¸Ÿä¸æ–­çš„æ›´æ–°æ¢ä»£è¿›åŒ–ï¼Œä¿ç•™ä¸‹ä¼˜è´¨åŸºå› ï¼ˆæ¸¸æˆå¾—åˆ†é«˜çš„ï¼‰ï¼Œæœ€åæ€»ä¼šæœ‰ä¸€æ‰¹åŸºå› èƒ½å¤Ÿé€‚åº”è¿™ä¸ªä¸–ç•Œï¼ˆé€šå…³è¿™ä¸ªæ¸¸æˆï¼‰ã€‚ é—ä¼ ç®—æ³•é€‚ç”¨çš„åœºæ™¯ è°ƒåº¦ç±»é—®é¢˜ï¼Œè½¦é—´å·¥ç¨‹æµç¨‹ã€é£æœºèˆªçº¿ç­‰ç­‰ã€‚å·¥ç¨‹ã€èˆªè¡Œä¸­æ‰€éœ€è¦çš„èµ„æºæ¶ˆè€—ã€æ—¶é—´ç­‰ç­‰æƒå€¼çœ‹åšâ€œæŸ“è‰²ä½“â€ï¼Œå‡ ç§æŸ“è‰²ä½“æ’åˆ—ç»„åˆï¼Œæœ€ç»ˆé€‰æ‹©å…¶ä¸­çš„è¾ƒä¼˜æ–¹æ¡ˆ è¾…åŠ©ç¥ç»ç½‘ç»œè°ƒèŠ‚å‚æ•°ï¼ŒFlappyLearningå…¶å®å°±æ˜¯åœ¨åšè‡ªåŠ¨å‚æ•°è°ƒèŠ‚ æ¸¸æˆåœºæ™¯ï¼Œæ¯”å¦‚æˆ‘ç©çš„æ¸¸æˆDota2è¿™ç§æ¨å¡”ç”Ÿå­˜ç±»æ¸¸æˆï¼Œæ¯å±€æ¸¸æˆåAIéƒ½å¯ä»¥æ€»ç»“è‡ªå·±ä¸è¶³çš„åœ°æ–¹è¿›è¡Œè‡ªæˆ‘è¿›åŒ–ä»è€Œä¸æ–­å¢å¼º é—ä¼ ç®—æ³•çš„è¿è¡Œæµç¨‹ åœ¨çŸ¥é“äº†é—ä¼ ç®—æ³•çš„æ¦‚å¿µä¹‹åï¼Œå®ƒçš„è¿ä½œæµç¨‹æ¦‚æ‹¬æ¥è¯´åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š ç”Ÿæˆä¸€æ‰¹éšæœºçš„åŸºå› å¹¶åŠ å…¥æ¸¸æˆ ä¿ç•™æ¸¸æˆå¾—åˆ†é«˜çš„ä¼˜è´¨åŸºå› ï¼Œæ·˜æ±°æ¸¸æˆå¾—åˆ†ä½çš„åŠ£è´¨åŸºå› ï¼Œé€šå…³æ‚äº¤å˜å¼‚ç”Ÿæˆéƒ¨åˆ†æ–°çš„åŸºå› ï¼Œé‡å¤æ­¤æµç¨‹ ç»è¿‡ä¸æ–­çš„è¿­ä»£è¿›åŒ–çš„åŸºå› èƒ½å¤ŸåŸºæœ¬é€‚åº”æ¸¸æˆï¼Œè¾¾åˆ°é€šå…³ï¼ˆä¸æ­»ï¼‰çš„æ•ˆæœ åå‘ä¼ æ’­ç®—æ³•ç®€ä»‹åå‘ä¼ æ’­è¦æ±‚æœ‰å¯¹æ¯ä¸ªè¾“å…¥å€¼æœŸæœ›å¾—åˆ°çš„å·²çŸ¥è¾“å‡ºï¼Œæ¥è®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ç§ç›‘ç£å¼å­¦ä¹ æ–¹æ³•ï¼Œä¸»è¦ç”¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ å‡½æ•°é€¼è¿‘ï¼šç”¨è¾“å…¥å‘é‡å’Œç›¸åº”çš„è¾“å‡ºå‘é‡è®­ç»ƒä¸€ä¸ªç½‘ç»œé€¼è¿‘ä¸€ä¸ªå‡½æ•° æ¨¡å¼è¯†åˆ«ï¼šç”¨ä¸€ä¸ªå¾…å®šçš„è¾“å‡ºå‘é‡å°†å®ƒä¸è¾“å…¥å‘é‡è”ç³»èµ·æ¥ åˆ†ç±»ï¼šæŠŠè¾“å…¥å‘é‡æ‰€å®šä¹‰çš„åˆé€‚æ–¹å¼è¿›è¡Œåˆ†ç±» å¦‚ä½•è¿ç”¨äºFlappyBirdAIåå‘ä¼ æ’­ç®—æ³•æœ‰ä¸€å¤§ç‰¹æ€§å°±æ˜¯éœ€è¦æœ‰é¢„æœŸçš„è¾“å…¥è¾“å‡ºé›†åˆï¼Œé‚£æˆ‘ä»¬å°±è¦æ€è€ƒå¦‚ä½•ç»™FlappyBirdAIæä¾›ä¸€ä¸ªè®­ç»ƒæ•°æ®é›†åˆï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯è®©ç©å®¶ç©æ¸¸æˆä»è€Œç”Ÿäº§è®­ç»ƒæ•°æ®ï¼Œå¤§ä½“æ€è·¯å¦‚ä¸‹ è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Œæ•°æ®æ•°æ®å³å‡½æ•°æ¨¡å‹çš„è¾“å…¥åŠé¢„æµ‹é¡¹å®šä¹‰æˆä»€ä¹ˆï¼Ÿ æ¨¡å‹è¾“å…¥é¡¹é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½è¾“å…¥é¡¹éœ€è¦æœ‰ä»€ä¹ˆæ ·çš„ç‰¹æ€§ï¼Ÿ å‰é¢æˆ‘ä»¬è®²åˆ°ï¼Œä¸å†³ç­–ç»“æœå…³è”æ€§è¶Šå¼ºçš„è¾“å…¥è®­ç»ƒæ•ˆæœè¶Šå¥½ï¼Œè¿˜ç±»æ¯”äº†äººå»ç©æ¸¸æˆä¼šæ³¨æ„å“ªäº›æ•°æ®ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬å°±é‡‡ç”¨äººç±»ç©æ¸¸æˆæ‰€è§‚æµ‹çš„æ•°æ®ä½œä¸ºAIçš„è®­ç»ƒæ•°æ®ï¼Œè¿™é‡Œæˆ‘è®¾è®¡äº†ä»¥ä¸‹å‡ ä¸ªè¾“å…¥ å°é¸Ÿå½“å‰çš„é«˜åº¦å€¼ ä¸‹ä¸€ä¸ªéšœç¢ç‰©çš„é«˜åº¦å€¼ å°é¸Ÿè·ç¦»ä¸‹ä¸€ä¸ªéšœç¢ç‰©çš„æ°´å¹³è·ç¦» æ¨¡å‹é¢„æµ‹é¡¹æ¨¡å‹çš„é¢„æµ‹è¾“å‡ºé¡¹å°†ä½œä¸ºå°é¸Ÿçš„å†³ç­–ä¾æ®ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªå¯ä»¥è¾ƒå¥½åˆ¤æ–­å†³ç­–çš„è¾“å‡ºï¼Œä¸¾ä¸ªä¸¤ç§è¾“å‡ºè®¾è®¡ä½œä¸ºä¾‹å­ æ–¹æ¡ˆ1ï¼šä½¿ç”¨å•é¡¹æ•°å­—ä½œä¸ºè¾“å‡ºï¼Œå¹¶å®šä¹‰1ä»£è¡¨è·³è·ƒï¼Œ0ä»£è¡¨ä¿æŒä¸å˜ï¼ˆå³ä¸‹é™ï¼‰ æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ•°ç»„ä½œä¸ºè¾“å‡ºï¼Œæ•°ç»„ç¬¬ä¸€é¡¹ä»£è¡¨è·³è·ƒæ¦‚ç‡ï¼Œç¬¬äºŒé¡¹ä»£è¡¨ä¿æŒä¸å˜æ¦‚ç‡ æˆ‘ä»¬æ¥åˆ†æä»¥ä¸‹è¿™ä¸¤é¡¹è¾“å‡ºçš„ä¼˜åŠ£ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“è®­ç»ƒå‡ºæ¥çš„å‡½æ•°æ¨¡å‹åªèƒ½ç»™å‡ºä¸€ä¸ªä¼°è®¡å€¼ï¼ˆå³ä¸ä¼šç»å¯¹æ˜¯0/1ï¼‰ å‡è®¾æˆ‘ä»¬ä½¿ç”¨æ–¹æ¡ˆ1ä½œä¸ºè¾“å‡ºç»“æ„ï¼Œé‚£æ ¹æ®è¿™ä¸ªç»“æœæˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­ç°åœ¨å°é¸Ÿæ˜¯å¦éœ€è¦è·³è·ƒå‘¢ï¼Ÿ&lt; 0.5ï¼Ÿé‚£ä¹ˆ0.5è¿™ä¸ªæ•°å­—åˆæ˜¯æ€ä¹ˆæ¥çš„ï¼Œæ²¡æœ‰ä»»ä½•ä¾æ® å‡è®¾æˆ‘ä»¬ä½¿ç”¨æ–¹æ¡ˆ2ä½œä¸ºè¾“å‡ºç»“æ„ï¼Œé‚£ä¹ˆå°é¸Ÿå¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦è·³è·ƒå‘¢ï¼Ÿresult[0] &gt; result[1]å³å¯ï¼Œå› æ­¤åœ¨è¿™é‡Œæˆ‘ä½¿ç”¨æ–¹æ¡ˆ2ä½œä¸ºè¾“å‡ºç»“æ„ åŸºäºåå‘ä¼ æ’­ç®—æ³•è®¾è®¡FlappyBirdAIæµç¨‹è®¾è®¡ ç©å®¶é€šè¿‡ç©æ¸¸æˆç”Ÿæˆæ¸¸æˆæ•°æ®ï¼Œè¿™é‡Œå°†é‡‡é›†æ¸¸æˆåœ¨æ¯ä¸ªæ—¶é—´ç‚¹çš„å°é¸Ÿé«˜åº¦ã€éšœç¢ç‰©é«˜åº¦ã€å°é¸Ÿè·ä¸‹ä¸€ä¸ªéšœç¢ç‰©çš„æ°´å¹³è·ç¦»ä½œä¸ºè¾“å…¥ï¼Œä»¥è¿™ä¸ªæ—¶é—´ç‚¹ç©å®¶çš„æ“ä½œä½œä¸ºè¾“å‡º å°†æ¸¸æˆæ•°æ®ç»Ÿä¸€å­˜å‚¨åˆ°æµè§ˆå™¨çš„LocalStorageç»Ÿä¸€ç®¡ç† AIåˆ©ç”¨ç©å®¶äº§ç”Ÿçš„æ¸¸æˆæ•°æ®åŸºäºåå‘ä¼ æ’­ç®—æ³•å»ºç«‹å†³ç­–æ¨¡å‹ AIè¿›è¡Œæ¸¸æˆæµ‹è¯• ç•Œé¢è®¾è®¡ç•Œé¢å·¦å³åˆ†æˆä¸¤å—å†…å®¹ï¼Œå·¦ä¾§ä¸ºæ¸¸æˆç•Œé¢ï¼Œå³ä¾§ä¸ºæ§åˆ¶å°ç•Œé¢ï¼Œè®­ç»ƒæ¨¡å‹åˆ—è¡¨å³ä¾§æœ‰ä¸€ä¸ªâ“å›¾æ ‡ï¼Œç‚¹å‡»å¯æ‰“å¼€æ•™å­¦æç¤ºï¼Œä¸‹é¢æè¿°ä¸€ä¸‹å¦‚ä½•è®­ç»ƒä¸€ä¸ªFlappyBirdAIå‚ä¸æ¸¸æˆ ç‚¹å‡»åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å‹å®Œæˆå¿…è¦ä¿¡æ¯å¡«å†™ï¼Œè¿™é‡Œä¸»è¦æ˜¯å…³è”ç¥ç»ç½‘ç»œä»¥åŠè®­ç»ƒè¿­ä»£æ¬¡æ•°çš„ä¸€äº›é…ç½® åœ¨æ–°çš„æ¨¡å‹è¡Œä¸­ç‚¹å‡»æ•™å­¦ï¼ˆæˆ–æŒ‰ç©ºæ ¼ï¼‰å¼€å§‹æ¸¸æˆï¼Œæ­¤æ—¶å·¦ä¾§æ¸¸æˆå¼€å§‹ï¼Œç©å®¶æŒ‰Jè·³è·ƒï¼Œæ¸¸æˆè¿›è¡Œè¿‡ç¨‹ä¸­å·¦ä¾§æ¨¡å‹è®­ç»ƒæ¡†ä¸­çš„æ•°æ®é‡ä¼šä¸æ–­å¢åŠ ï¼Œè¿™äº›æ•°æ®å°†æŒä¹…åŒ–åœ¨LocalStorageä¸­å¹¶ä½œä¸ºAIçš„è®­ç»ƒæ•°æ® å½“ç©å®¶è®¤ä¸ºæ•°æ®é‡è¾¾åˆ°é¢„æœŸæ—¶ï¼ˆå»ºè®®å¤§äº3000ï¼‰å¯ç»ˆæ­¢æ¸¸æˆï¼Œç‚¹å‡»è®­ç»ƒæŒ‰é’®å¼€å§‹è®­ç»ƒå†³ç­–å‡½æ•°æ¨¡å‹ï¼Œæ­¤æ—¶å³ä¾§ä¼šå¼¹å‡ºè®­ç»ƒè¿›åº¦å›¾è¡¨ è®­ç»ƒå®Œæˆåæ¸¸æˆå°†ç”±AIæ¥æ‰‹è‡ªåŠ¨å¼€å§‹ï¼Œå³ä¾§è¡Œä¼šè®°å½•AIçš„æœ€é«˜å¾—åˆ† æ¨¡å‹è®­ç»ƒå®Œæˆï¼Œç©å®¶å¯ä»¥ç‚¹å‡»æ•°æ®é¢„æµ‹ä½¿ç”¨ç©å®¶ç”Ÿæˆçš„æ¸¸æˆæ•°æ®æ ·æœ¬äº¤ä¸AIè¿›è¡Œé¢„æµ‹åˆ†æï¼Œé¢„æµ‹å®Œæˆåå°†ç»™å‡ºAIé¢„æµ‹ç»“æœä¸ç©å®¶è¾“å…¥é¢„æœŸä¸ç¬¦çš„æ•°æ®åˆ—è¡¨ æ¨¡å‹è®­ç»ƒæ•ˆæœå±•ç¤ºè¿™é‡Œæˆ‘äººå·¥ç©äº†3ä¸‡å·¦å³çš„æ•°æ®é‡ï¼Œç›¸å½“äºè¿‡äº†2500ä¸ªéšœç¢ç‰©ï¼Œå°é¸Ÿçš„æœ€é«˜å¾—åˆ†æ˜¯2400ï¼Œå…·ä½“è¿è¡Œæ•ˆæœå¦‚ä¸‹ å¼€å‘è®¡åˆ’ å‚ç…§FlappyLearningå®Œæˆæ¸¸æˆå¼•æ“å¼€å‘ å®Œæˆç”¨æˆ·æ¸¸æˆæ•°æ®é‡‡é›†å™¨ä¸å…¶æŒä¹…åŒ–æ¨¡å— å¼•å…¥Tensorflow.jsåŸºäºæ¸¸æˆæ•°æ®è®­ç»ƒå†³ç­–æ¨¡å‹å¹¶ä½¿ç”¨å…¶å‚ä¸æ¸¸æˆ å®Œæˆæ•°æ®é¢„æµ‹æ¨¡å—ï¼Œä¾¿äºå¯¹æ¨¡å‹é¢„æµ‹ç»“æœè¿›è¡Œåˆ†æ åˆ†æAIå‚ä¸æ¸¸æˆçš„èƒ½åŠ›ï¼Œä¼˜åŒ–AIä½¿å…¶èƒ½å¤Ÿæ›´å¥½çš„é€‚åº”æ¸¸æˆ æœºå™¨è®­ç»ƒè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å¯èƒ½é‡‡é›†åˆ°é”™è¯¯æ•°æ®æ¸¸æˆä¸­æœºå™¨è®­ç»ƒçš„æ•°æ®ç”±ç©å®¶ä¸æ–­äº§ç”Ÿï¼Œä¹Ÿå°±æ˜¯ç”±ç©å®¶é‡å¤ä¸€å±€åˆä¸€å±€çš„æ¸¸æˆæ¥äº§ç”Ÿï¼Œé‚£ä¹ˆç©å®¶åœ¨æ¸¸æˆç»ˆæ­¢ï¼ˆå°é¸Ÿæ­»äº¡ï¼‰å‰çš„ä¸€éƒ¨åˆ†æ•°æ®å…¶å®æ˜¯å±äºé”™è¯¯æ“ä½œæ•°æ®ï¼Œè¿™ç±»æ•°æ®ä¸åº”è¯¥äº¤ä¸æœºå™¨å»å­¦ä¹  è§£å†³æ–¹æ¡ˆ ä¸¢å¼ƒæ¸¸æˆç»“æŸå‰çš„éƒ¨åˆ†æ•°æ®åœ¨è¿™é‡Œæˆ‘ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å®šäº†å¤§å°çš„é˜Ÿåˆ—ï¼Œ\bè´Ÿè´£ç¼“å­˜æ¸¸æˆæœ€æ–°çš„éƒ¨åˆ†æ•°æ®ï¼Œè„±ç¦»ç¼“å­˜çš„æ•°æ®ç›´æ¥è¿›å…¥æŒä¹…åŒ–æ¨¡å—ï¼Œå½“æ¸¸æˆç»“æŸæ—¶è¿˜åœ¨ç¼“å­˜é˜Ÿåˆ—ä¸­çš„æ•°æ®å°†è¢«ä¸¢å¼ƒ æ•°æ®æ ·æœ¬åˆ†å¸ƒä¸å‡åŒ€åœ¨ä¸Šè¿°è®¾è®¡ä¸­æ¸¸æˆæ•°æ®ä¼šåŸºäºè¿è¡Œçš„æ¯ä¸€ä¸ªæ—¶åˆ»ç‚¹æ¥é‡‡é›†ï¼Œè¿™å°†å¯¼è‡´æ•°æ®é›†ä¸­æ“çºµè·³è·ƒçš„æ•°æ®ä¼šè¿œå°äºæ— æ“ä½œçš„æ•°æ®ï¼Œå®é™…è¿è¡Œä¸­ä¹Ÿè¯æ˜äº†è¿™ä¸€ç‚¹ï¼Œè·³è·ƒæ“ä½œæ•°æ®å¤§æ¦‚å æ€»æ•°æ®é›†çš„3%ï¼Œå¦‚æ­¤ä¸å‡åŒ€çš„æ•°æ®é›†åŠ å…¥è®­ç»ƒå°†ä½¿å¾—å†³ç­–æ¨¡å‹å‡ºç°ä¸€è¾¹å€’çš„æƒ…å†µï¼Œå³å°é¸Ÿä¸€ç›´ä¸è·³è·ƒï¼Œå¤„ç†æ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œä¸»è¦æœ‰3ç§ç­–ç•¥ï¼šä»æ•°æ®è§’åº¦ã€ä»ç®—æ³•å±‚é¢å’Œæ¨¡å‹è¯„ä»·å±‚é¢ï¼Œ\bè¿™è¾¹ç»™å‡ºä»¥ä¸‹å‡ ç§å¤„ç†æ–¹æ¡ˆ æ–¹æ¡ˆä¸€ æ‰©å¤§æ•°æ®é›†å½“é‡åˆ°ç±»åˆ«ä¸å‡è¡¡é—®é¢˜æ—¶ï¼Œé¦–å…ˆåº”è¯¥æƒ³åˆ°ï¼Œæ˜¯å¦å¯èƒ½å†å¢åŠ æ•°æ®ï¼Œä½¿å¾—æ ·æœ¬å¹³è¡¡ï¼Œæ˜¾ç„¶åœ¨æˆ‘ä»¬è¿™ä¸ªåœºæ™¯ä¸­æ˜¯ä¸å¯èƒ½æ‰©å¤§äº† æ–¹æ¡ˆäºŒ é‡é‡‡æ · ä¸Šé‡‡æ · é€šè¿‡å¢åŠ ç¨€æœ‰ç±»è®­ç»ƒæ ·æœ¬æ•°çš„æ–¹æ³•ï¼Œé™ä½ä¸å¹³è¡¡ç¨‹åº¦ï¼Œä¸€èˆ¬ç”¨äºæ•°æ®é›†æ¯”è¾ƒå°‘çš„æƒ…å†µï¼Œé‡å¤çš„æ‰©å¢æ ·æœ¬ä¸­æ¯”ä¾‹è¾ƒå°çš„é‚£ç±»æ•°æ®è¾¾åˆ°æ ·æœ¬å¹³è¡¡ï¼Œæ­¤æ–¹æ³•å®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆï¼Œè€Œä¸”ä¼šå¯¼è‡´æ ·æœ¬å¢å¤§éœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æº ä¸‹é‡‡æ · é€šè¿‡èˆå¼ƒéƒ¨åˆ†å¤§ç±»æ ·æœ¬çš„æ–¹æ³•ï¼Œé™ä½ä¸å¹³è¡¡ç¨‹åº¦ï¼Œä¸€èˆ¬ç”¨äºæ•°æ®é›†æ¯”è¾ƒå¤šçš„æƒ…å†µï¼Œéšæœºçš„ä¸¢å¼ƒæ ·æœ¬ä¸­æ¯”ä¾‹è¾ƒå¤§çš„é‚£ç±»æ•°æ®è¾¾åˆ°æ ·æœ¬å¹³è¡¡ï¼Œæ­¤æ–¹æ³•ä¼šä¸å¯é¿å…åœ°ä¸¢å¼ƒå¤§éƒ¨åˆ†å¤šæ•°ç±»æ ·æœ¬é€ æˆä¿¡æ¯æŸå¤± æ–¹æ¡ˆä¸‰ ä½¿ç”¨Focal lossæŸå¤±å™¨ç„¦ç‚¹æŸå¤±å‡½æ•°Focal Lossè¢«æå‡ºç”¨äºå¯†é›†ç‰©ä½“æ£€æµ‹ä»»åŠ¡ã€‚å®ƒå¯ä»¥è®­ç»ƒé«˜ç²¾åº¦çš„å¯†é›†ç‰©ä½“æ¢æµ‹å™¨ï¼Œå“ªæ€•å‰æ™¯å’ŒèƒŒæ™¯ä¹‹é—´æ¯”ä¾‹ä¸º1:1000ï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªæ¸¸æˆä¸­æ ·æœ¬ç±»åˆ«çš„æ•°é‡æ¯”ä¾‹å¤§æ¦‚æ˜¯3:97ï¼Œæ­¤æŸå¤±å‡½æ•°æ˜¯é€‚ç”¨çš„ä½†æ˜¯ç°æœ‰çš„èµ„æ–™ä¸­Focal LossæŸå¤±å‡½æ•°åŸºäºPythonçš„å®ç°ä»£ç è¾ƒå¤šï¼Œè€ŒåŸºäºJSçš„å‡ ä¹æ²¡æœ‰ï¼ˆä¹Ÿè®¸æ˜¯æˆ‘æ²¡æ‰¾åˆ°ï¼‰ï¼Œç»è¿‡ä¸€æ®µåŠªåŠ›çš„ç†è§£åï¼Œæˆ‘æ”¾å¼ƒäº†æ­¤æ–¹æ¡ˆ æœ€ç»ˆæˆ‘é‡‡ç”¨äº†ä¸Šé‡‡æ ·çš„æ–¹æ¡ˆï¼Œå› ä¸ºä¸‹é‡‡æ ·æ–¹æ¡ˆä¸¢å¼ƒæ‰å¤§éƒ¨åˆ†æ ·æœ¬åä¼šå¯¼è‡´å°é¸Ÿè®­ç»ƒç»“æœéå¸¸ä¸ç†æƒ³ï¼Œäºæ˜¯æˆ‘é€‰æ‹©ç‰ºç‰²è®¡ç®—èµ„æºçš„æ–¹å¼æ¥ä¿è¯å°é¸Ÿçš„è®­ç»ƒæ™ºèƒ½æ€§ï¼Œå½“ç„¶å¦‚æœèƒ½å†™å‡ºFocal lossæŸå¤±å™¨çš„jsç‰ˆæœ¬ä¹Ÿè®¸ä¼šæ˜¯ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆ å‚è€ƒèµ„æ–™ FlappyLearning Github TypeScript æ”¯æŒ â€” Vue.js Tensorflow.js å®˜æ–¹æ–‡æ¡£ å¼€å§‹ | TensorFlow.js åå‘ä¼ æ’­ç®—æ³• | æœºå™¨ä¹‹å¿ƒ è°è¯´é—ä¼ ç®—æ³•åªèƒ½ç”¨æ¥å‡‘è®ºæ–‡ï¼Ÿå®ƒè¿˜æœ‰å¥½å¤šæœ‰è¶£çš„ç©æ³• æœºå™¨å­¦ä¹ ä¸­è§£å†³æ•°æ®ä¸å¹³è¡¡é—®é¢˜ æ•°æ®ä¸å¹³è¡¡åˆ†ç±»é—®é¢˜ | beatriceâ€™s blogs","link":"/2019-09-06-machine-learning/"},{"title":"CentOS 6.5 å‡çº§ OpenSSH æœåŠ¡","text":"&emsp;&emsp;å…¬å¸æœ€è¿‘é¡¹ç›®åšç­‰ä¿æµ‹è¯•ï¼Œåœ¨æ¼æ‰«éƒ¨åˆ†æµ‹è¯•å‡ºäº†å››å°ç”Ÿäº§æœåŠ¡å™¨æœ‰åä½™ä¸ªå…³äº OpenSSH çš„æ¼æ´ï¼Œæ•…éœ€è¦åšå‡çº§å·¥ä½œï¼Œåœ¨æ­¤è®°å½•ã€‚ CentOS-6-5-å‡çº§-SSH-æœåŠ¡æºèµ·CentOS 6.5 è‡ªå¸¦çš„ OpenSSH ç‰ˆæœ¬è¿‡ä½ï¼Œ7.4ä»¥ä¸‹ OpenSSH ç‰ˆæœ¬å­˜åœ¨ä¸¥é‡æ¼æ´ï¼š OpenSSH è¿œç¨‹æƒé™æå‡æ¼æ´(CVE-2016-10010) OpenSSH J-PAKEæˆæƒé—®é¢˜æ¼æ´(CVE-2010-4478) Openssh MaxAuthTriesé™åˆ¶ç»•è¿‡æ¼æ´(CVE-2015-5600) å‡çº§è®°å½•yum-é•œåƒæºåˆ‡æ¢ å¦‚æœ yum é•œåƒæºæ— æ³•ä½¿ç”¨å¯å°è¯•ä¸‹è¿°æ–¹æ¡ˆï¼Œæœ¬æ¬¡æ“ä½œçš„æœåŠ¡å™¨åœ¨å†…ç½‘ç¯å¢ƒä¸‹ï¼Œå†…ç½‘çš„ DNS æ— æ³•è§£æ mirrors.aliyun.comï¼Œæ•…æ‰‹åŠ¨é…ç½®äº† hosts ä¸é•œåƒåœ°å€ã€‚ # å†™å…¥ aliyun é•œåƒæºçš„ host è§£æè®°å½• echo 59.47.236.246 mirrors.aliyun.com &gt;&gt; /etc/hosts # å¤‡ä»½åŸå§‹é•œåƒæº mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup # ä¸‹è½½æ–°çš„é•œåƒæº wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo # ç”Ÿæˆç¼“å­˜ yum makecache å®‰è£…åŸºç¡€ç¯å¢ƒ æ­¤æ­¥éª¤å®‰è£… SSH ç¼–è¯‘æ‰€éœ€ä¾èµ–é¡¹ï¼Œå¦‚æœ yum ä¸å¯ç”¨å¯ä½¿ç”¨ RPM çš„æ–¹å¼æ‰‹åŠ¨å®‰è£…ã€‚ yum å®‰è£…æ–¹å¼ # OpenSSH ç¼–è¯‘ä¾èµ– yum -y install gcc-c++ zlib zlib-devel openssl openssl-devel pam-devel rpm å®‰è£…æ–¹å¼å‚è€ƒé“¾æ¥ï¼šhttps://github.com/Junyangz/upgrade-openssh-centos å®‰è£…å¹¶å¼€å¯-telnet-æœåŠ¡ æ­¤æ­¥éª¤æ˜¯é˜²æ­¢åœ¨æ›´æ–° SSH æ—¶æ–­å¼€è¿æ¥å¯¼è‡´æ— æ³•ç™»å½•æœåŠ¡å™¨ï¼Œæ­¤æ—¶å¯é‡‡ç”¨ telnet ç™»å½•ã€‚ # telnet ç¯å¢ƒï¼Œé˜²æ­¢ ssh æœåŠ¡å…³é—­åæ— æ³•è¿æ¥æœåŠ¡å™¨ yum -y install telnet-server* telnet # å¯ç”¨ telnet æœåŠ¡ç”¨äºè¿œç¨‹ç™»å½• vi /etc/xinetd.d/telnet # å°†å…¶ä¸­ disable å­—æ®µçš„ yes æ”¹ä¸º no ä»¥å¯ç”¨ telnet æœåŠ¡ # å…è®¸ root ç”¨æˆ·é€šè¿‡ telnet ç™»å½• mv /etc/securetty /etc/securetty.old # å¯åŠ¨telnetæœåŠ¡ service xinetd start # ä½¿telnetæœåŠ¡å¼€æœºå¯åŠ¨ï¼Œé¿å…å‡çº§è¿‡ç¨‹ä¸­æœåŠ¡å™¨æ„å¤–é‡å¯åæ— æ³•è¿œç¨‹ç™»å½•ç³»ç»Ÿ chkconfig xinetd on # æŸ¥çœ‹ telnet ç«¯å£ less /etc/services | grep telnet # telnet 23/tcp # telnet 23/udp ä½¿ç”¨ telnet ç™»å½•æœåŠ¡å™¨çš„æ–¹å¼å¦‚ä¸‹ï¼š telnet 192.168.xx.xx # Trying 192.168.xx.xx... # Connected to 192.168.xx.xx. # Escape character is '^]'. # Password: # è¾“å…¥å¯†ç å³å¯ç™»å½• æ›´æ–°-OpenSSL-åˆ°-1-0-2-oOpenSSL &gt;= 1.0.1 å¯ä»¥ä¸ç”¨å‡çº§ OpenSSLï¼Œè¿è¡Œ openssl version å¯ä»¥æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚æœå‡ºç° openssl: command not found è¯´æ˜æœåŠ¡å™¨å¯èƒ½åœ¨ä½¿ç”¨ nss æ¨¡å—ï¼Œå¯é€šè¿‡ yum info nss æŸ¥çœ‹å…¶ç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰å®‰è£… OpenSSL éœ€è¦è¿›è¡Œä¸‹æ–¹çš„æ­¥éª¤ã€‚ æ­¤æ­¥éª¤æ›´æ–° OpenSSL ä¾èµ–ï¼Œè„šæœ¬æ¥æºäºUpgrade OpenSSH to 7.7p1 in CentOS 6 - Junyangzâ€™s docsï¼Œæ ¹æ®å®é™…æƒ…å†µæ”¹é€  openssl å¤‡ä»½éƒ¨åˆ†çš„è„šæœ¬ï¼Œå¯ç›´æ¥æ”¾ç½®æœåŠ¡å™¨è¿è¡Œå‡çº§ã€‚ #!/bin/sh # Copyright Â© 2018 Junyangz # Update by JianhuiChen # Create workspace # mkdir ssh_upgrade &amp;&amp; cd ssh_upgrade # Download the new version of openssl rm -f openssl-1.0.2o.tar.gz wget https://ftp.openssl.org/source/old/1.0.2/openssl-1.0.2o.tar.gz # Query the server's old version of openssl find / -name openssl find / -name &quot;libssl*&quot; timestamp=$(date +%s) # Backup openssl based on the results of the query above cp /usr/lib64/libssl3.so /usr/lib64/libssl3.so.10-${timestamp} cp /usr/lib64/libssl.so.10 /usr/lib64/libssl.so.10-${timestamp} mv /usr/bin/openssl /usr/bin/openssl-${timestamp} mv /usr/include/openssl /usr/include/openssl-${timestamp} mv /etc/pki/ca-trust/extracted/openssl /etc/pki/ca-trust/extracted/openssl-${timestamp} # remove old OpenSSL rpm package rpm -qa |grep openssl|xargs -i rpm -e --nodeps {} # compile and install new OpenSSL tar zxvf openssl-1.0.2o.tar.gz &amp;&amp; cd openssl-1.0.2o ./config --prefix=/usr/local/openssl --openssldir=/etc/ssl --shared zlib&amp;&amp; make &amp;&amp; make test &amp;&amp; make install ln -s /usr/local/openssl/bin/openssl /usr/bin/openssl ln -s /usr/local/openssl/include/openssl /usr/include/openssl echo &quot;/usr/local/openssl/lib&quot;&gt;&gt;/etc/ld.so.conf ldconfig mv /usr/lib64/libcrypto.so.10-* /usr/lib64/libcrypto.so.10 mv /usr/lib64/libssl.so.10-* /usr/lib64/libssl.so.10 #ldconfig -v # for check echo &quot;OpenSSl version upgrades as to lastest:&quot; &amp;&amp; openssl version # openssl version -a # OpenSSL 1.0.2o 27 Mar 2018 # built on: reproducible build, date unspecified # platform: linux-x86_64 # options: bn(64,64) rc4(16x,int) des(idx,cisc,16,int) idea(int) blowfish(idx) # compiler: gcc -I. -I.. -I../include -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -Wa,--noexecstack -m64 -DL_ENDIAN -O3 -Wall -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM -DECP_NISTZ256_ASM # OPENSSLDIR: &quot;/usr/local/openssl/ssl&quot; æ›´æ–°-OpenSSH-åˆ°-7-7p1 æ­¤æ­¥éª¤æ›´æ–° OpenSSH ä¾èµ–ï¼Œå¤åˆ¶ä¸‹æ–¹è„šæœ¬åˆ° sh æ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œå³å¯ï¼Œè„šæœ¬æ¥æºäºUpgrade OpenSSH to 7.7p1 in CentOS 6 - Junyangzâ€™s docsã€‚ #!/bin/sh # Create workspace # mkdir ssh_upgrade &amp;&amp; cd ssh_upgrade # Download the new version of openssh rm -f openssh-7.7p1.tar.gz wget http://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.7p1.tar.gz timestamp=$(date +%s) # Backup old OpenSSH cp -R /etc/ssh /etc/ssh-${timestamp} cp /etc/init.d/sshd /etc/init.d/sshd-${timestamp} rpm -qa | grep openssh rpm -e --nodeps `rpm -qa | grep openssh` tar zxvf openssh-7.7p1.tar.gz &amp;&amp; cd openssh-7.7p1 ./configure --prefix=/usr/local/openssh --sysconfdir=/etc/ssh \\ --with-ssl-dir=/usr/local/openssl &amp;&amp; make &amp;&amp; make install ln -s /usr/local/openssh/sbin/sshd /usr/sbin/sshd # Copy ssh config files cp ssh_config /etc/ssh/ cp sshd_config /etc/ssh/ cp moduli /etc/ssh/ # å¤åˆ¶å¯åŠ¨è„šæœ¬åˆ°/etc/init.d # æ ¹æ®å®‰è£…è·¯å¾„æƒ…å†µï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹å¯åŠ¨è„šæœ¬ä¸­sshdçš„è·¯å¾„ cp contrib/redhat/sshd.init /etc/init.d/sshd chmod +x /etc/init.d/sshd /usr/sbin/sshd -t -f /etc/ssh/sshd_config # vim /etc/init.d/sshd # åŠ å…¥å¼€æœºè‡ªå¯ chkconfig --add sshd chkconfig sshd on chkconfig sshd --list # å¼€å¯rootç”¨æˆ·è¿œç¨‹ç™»å½•ã€‚ sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config # å¼€å¯SSHæœåŠ¡ # åƒä¸‡ä¸èƒ½restartã€‚ä½¿ç”¨restartä¼šé€ æˆè¿ä¸ä¸Šï¼Œéœ€è¦ç™»å½•æ§åˆ¶å°å¯åŠ¨ã€‚ service sshd start echo &quot;New version upgrades as to lastest:&quot; &amp;&amp; $(/usr/sbin/sshd -V) å…³é—­-telnet-æœåŠ¡ æ£€æµ‹æ–°ç‰ˆçš„ OpenSSH æ˜¯å¦èƒ½å¤Ÿè¿œç¨‹ç™»å½•ï¼Œå¦‚æœæ²¡é—®é¢˜å¯å…³é—­ telnet æœåŠ¡ï¼Œåœ¨è¿™é‡Œä½¿ç”¨å¤‡ä»½çš„é…ç½®è¦†ç›–å½“å‰é…ç½®å³å¯ã€‚ vi /etc/xinetd.d/telnet # å°†å…¶ä¸­ disable å­—æ®µçš„ no æ”¹ä¸º yes ä»¥ç¦ç”¨ telnet æœåŠ¡ # Disable telnet login mv /etc/securetty.old /etc/securetty # Stop telnet service service xinetd stop chkconfig xinetd off F-amp-Q è¿è¡Œ service sshd start æŠ¥é”™ /etc/init.d/sshd: line 41: /usr/bin/ssh-keygen:No such file or directory # åˆ›å»ºè½¯é“¾æ¥ ln -s /usr/local/openssh/sbin/sshd /usr/sbin/sshd è¿è¡Œ ssh -V æŠ¥é”™ -sh: /usr/bin/ssh: No such file or directory # åˆ°å®‰è£…ç›®å½•æ‰§è¡Œè„šæœ¬ /usr/sbin/sshd -V libcrypto.so.10 åº“ä¸¢å¤± error while loading shared libraries: libcrypto.so.10: cannot open shared object file: No such file or directory # 64 ä½ç³»ç»Ÿ ln -s /usr/local/openssl/lib/libcrypto.so.1.0.0 /usr/lib64/libcrypto.so.10 ln -s /usr/local/openssl/lib/libssl.so.1.0.0 /usr/lib64/libssl.so.10 # 32 ä½ç³»ç»Ÿ ln -s /usr/local/openssl/lib/libcrypto.so.1.0.0 /usr/lib/libcrypto.so.10 ln -s /usr/local/openssl/lib/libssl.so.1.0.0 /usr/lib/libssl.so.10 å‚è€ƒèµ„æ–™ Upgrade OpenSSH to 7.7p1 in CentOS 6 - Junyangzâ€™s docs","link":"/2020-06-23-upgrade-openssh7.7p1-centos6/"},{"title":"ä½¿ç”¨ Vuepress ç¼–å†™ç»„ä»¶ç¤ºä¾‹æ–‡æ¡£çš„æœ€ä½³å®è·µ","text":"&emsp;&emsp;è¿™ç¯‡æ–‡ç« é¢å‘ä½¿ç”¨ Vuepress æ¥å¼€å‘ Vue ç»„ä»¶æ–‡æ¡£åº“çš„ç”¨æˆ·æœåŠ¡ï¼Œå»å¹´å·®ä¸å¤šè¿™ä¸ªæ—¶å€™æˆ‘ä¸ºå…¬å¸å¼€å‘äº†ä¸€ä¸ªåŸºäº AntDesignVue å°è£…çš„é«˜é˜¶ç»„ä»¶åº“ï¼Œç»è¿‡ä¸€å¹´çš„ç‰ˆæœ¬è¿­ä»£ä¸æ–‡æ¡£æ›´æ–°ï¼Œæ”¶è·äº†å¾ˆå¤šå‘ç‚¹ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå°±æ˜¯å…³äºç»„ä»¶ç¤ºä¾‹ç»´æŠ¤ç›¸å…³çš„ï¼Œä»Šå¹´æœ‰æ„é‡æ„ç»„ä»¶åº“çš„æ–‡æ¡£ä¸ä»£ç ç»“æ„ï¼Œåé¢ä¼šé™†é™†ç»­ç»­å°†è¸©åˆ°çš„å‘ç‚¹ä¸ç›¸åº”çš„è§£å†³æ–¹æ¡ˆä¸€ä¸€æè¿°ï¼Œå¥½çš„è¿›å…¥ä»Šå¤©çš„ä¸»é¢˜ï¼šæ–‡æ¡£ç¤ºä¾‹ç¼–å†™çš„æœ€ä½³å®è·µæ–¹æ¡ˆã€‚ å…³äºæœ€ä½³å®è·µæ–¹æ¡ˆæˆ‘æä¾›äº†ä¸€ä¸ªæ’ä»¶ vuepress-plugin-demo-container æ¥ç»Ÿä¸€è§£å†³ï¼Œæ’ä»¶çš„å…·ä½“ä»‹ç»ã€ç¤ºä¾‹ä¸ä½¿ç”¨æ–‡æ¡£ ç‚¹æ­¤è®¿é—®ã€‚ å‰è¨€ä»€ä¹ˆæ˜¯ç»„ä»¶ç¤ºä¾‹æ–‡æ¡£ï¼Ÿå½“ä½ ä½¿ç”¨ Vueã€React æˆ–è€…å…¶ä»–è¯­è¨€ç¼–å†™äº†ä¸€ä¸ªç»„ä»¶åº“ï¼Œå¦‚ Element UIã€Ant Design Vue æˆ–æ˜¯åƒæˆ‘ä¸€æ ·åŸºäºå®ƒä»¬å¼€å‘çš„ä¸šåŠ¡å°è£…åº“ï¼Œéƒ½éœ€è¦ä½¿ç”¨æ–‡æ¡£æ¥æ”¯æ’‘ï¼Œè€Œä½¿ç”¨æ–‡æ¡£å¿…ç„¶ä¼šåŒ…å«ä»£ç ä¸ç¤ºä¾‹ï¼Œè¿™éƒ¨åˆ†å°±æ˜¯ç»„ä»¶ç¤ºä¾‹æ–‡æ¡£ã€‚ ä¸¾ä¸ªä¾‹å­ï¼ŒElement UI çš„ Color Picker ç»„ä»¶æ–‡æ¡£ï¼Œå…¶ä¸­å°±åŒ…å«äº†å¤šä»½ç¤ºä¾‹ä»£ç ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨å®Œæˆäº†ç»„ä»¶å¼€å‘ï¼Œéœ€è¦ä½¿ç”¨ Vuepress å†™ä¸€ä»½å’Œå®ƒä¸€æ ·çš„ä½¿ç”¨æ–‡æ¡£ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ ä½¿ç”¨-Vuepress-æ„å»ºç»„ä»¶ç¤ºä¾‹æ–‡æ¡£æ–¹æ¡ˆä¸€ç†Ÿæ‚‰ Vuepress çš„åŒå­¦åº”è¯¥ä¸éš¾æƒ³åˆ°è§£å†³æ–¹æ¡ˆï¼Œç”±äº Vuepress æ”¯æŒåœ¨ Markdown ä¸­ç¼–å†™ç¬¦åˆ Vue è¯­æ³•çš„ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š ## ç¤ºä¾‹å±•ç¤º &lt;template&gt; &lt;color-picker size=&quot;mini&quot;&gt;&lt;/color-picker&gt; &lt;/template&gt; ## ç¤ºä¾‹ä»£ç å¦‚ä¸‹ ```html &lt;template&gt; &lt;color-picker size=&quot;mini&quot;&gt;&lt;/color-picker&gt; &lt;/template&gt; `` ` &lt;= åˆ é™¤å·¦ä¾§ç©ºæ ¼ æ–¹æ¡ˆäºŒå¦‚æœç¤ºä¾‹ä¸­è¿˜åŒ…å« export default {} ä»£ç å—ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© Vuepress ä¼šè‡ªåŠ¨æ³¨å†Œ components ç›®å½•ä¸‹ç»„ä»¶çš„ç‰¹æ€§ï¼Œæˆ–è€…é€šè¿‡ enhanceApp.js é’©å­è‡ªå·±æ³¨å†Œç¤ºä¾‹ä»£ç æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ &lt;&lt;&lt; @/filepath è¯­æ³•å°†ç¤ºä¾‹ä»£ç æ–‡ä»¶å¼•å…¥ï¼Œè¿™éƒ¨åˆ†æ“ä½œçš„å…·ä½“æ–‡æ¡£å¯ä»¥ ç‚¹æ­¤æŸ¥çœ‹ï¼Œè¿™ä¹ˆæ“ä½œä¸‹æ¥å†™æ³•å˜æˆäº†è¿™æ ·ï¼š ## ç¤ºä¾‹å±•ç¤º &lt;color-picker-basic-demo&gt;&lt;/color-picker-basic-demo&gt; ## ç¤ºä¾‹ä»£ç å¦‚ä¸‹ ```html &lt;&lt;&lt; @/docs/.vuepress/components/color-picker-basic-demo.vue `` ` &lt;= åˆ é™¤å·¦ä¾§ç©ºæ ¼ æ–¹æ¡ˆä¸‰å½“ç„¶è¿™ä¹ˆåšè¿˜ä¸å¤ªè¡Œï¼Œæˆ‘ä»¬è¿˜æƒ³è¦å’Œ Element UI æˆ–è€… Ant Design Vue ä¸€æ ·æ¼‚äº®çš„ç¤ºä¾‹ä»£ç å—ï¼Œç¤ºä¾‹éƒ¨åˆ†æœ‰æ¡†æ¡†åŒ…èµ·æ¥ï¼Œä»£ç éƒ¨åˆ†å¯ä»¥çœç•¥/å±•å¼€å¹¶æä¾›å¤åˆ¶åŠŸèƒ½ã€åœ¨çº¿ç¼–è¾‘åŠŸèƒ½ã€‚è¿™å€’ä¹Ÿä¸éš¾ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å¼€å‘ä¸€ä¸ª DemoBlock ç»„ä»¶æ¥åŒ…è£¹ç»„ä»¶ç¤ºä¾‹ï¼Œç»“æ„å’Œæ ·å¼éƒ½å¯ä»¥å¼€å‘æˆä½ è‡ªå·±å–œæ¬¢çš„æ ·å­ï¼Œè¿™éƒ¨åˆ†åšå®Œåå†™æ³•å˜æˆäº†è¿™æ ·ï¼š &lt;demo-block source=&quot;&lt;color-picker size=\\&quot;mini\\&quot;&gt;&lt;/color-picker&gt;&quot;&gt; &lt;template slot=&quot;demo&quot;&gt; &lt;color-picker size=&quot;mini&quot;&gt;&lt;/color-picker&gt; &lt;/template&gt; &lt;/demo-block&gt; æ–¹æ¡ˆå››ä½ ä¼šå‘ç° &lt;&lt;&lt; @/filepath è¯­æ³•åœ¨ç»„ä»¶å†…å°±ä¸å¥½ä½¿äº†ï¼Œç¤ºä¾‹å’Œä»£ç å¾—å†™ä¸¤éæ‰è¡Œï¼Œè€Œä¸”ä»£ç è¿˜å¾—ä½œä¸ºä¸€ä¸ª String ä¼ é€’è¿›å»ï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•åœ¨ä¸Šè¿°çš„å®ç°åŸºç¡€ä¸Šä¸å†™ä¸¤è¾¹ç¤ºä¾‹ä»£ç å‘¢ï¼Ÿ åŠæ³•å½“ç„¶æ˜¯æœ‰çš„ï¼Œç¨‹åºå‘˜çš„æ™ºæ…§æ˜¯æ— ç©·çš„ï¼Œvuepress-plugin-extract-code è¿™ä¸ªæ’ä»¶ç»™äº†è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ‰‹åŠ¨è§£æäº†ç»„ä»¶å†…çš„ &lt;&lt;&lt; @/filepath è¯­æ³•å¹¶å°†å…¶è½¬æ¢æˆäº†ä»£ç æ–‡æœ¬ï¼Œä½¿ç”¨è¿™ä¸ªæ’ä»¶åå†™æ³•å˜æˆäº†è¿™æ ·ï¼š &lt;reco-demo&gt; &lt;color-picker-basic-demo slot=&quot;demo&quot;&gt;&lt;/color-picker-basic-demo&gt; &lt;template slot=&quot;code-vue&quot;&gt; &lt;&lt;&lt; @/docs/.vuepress/components/color-picker-basic-demo.vue &lt;/template&gt; &lt;/reco-demo&gt; æ–¹æ¡ˆ-Element-UIåˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»æ¼”å˜äº†å››ä¸ªç‰ˆæœ¬ï¼Œæš‚åœä¸€ä¸‹æˆ‘ä»¬å»çœ‹çœ‹ Element UI çš„ç»„ä»¶æ–‡æ¡£æ˜¯æ€ä¹ˆç¼–å†™çš„ï¼Œç‚¹æ­¤æŸ¥çœ‹ Color Picker çš„æ–‡æ¡£ï¼Œä¸æƒ³ç‚¹çš„ç›´æ¥çœ‹ä¸‹æ–¹ç¤ºä¾‹ï¼š ::: demo ä½¿ç”¨ v-model ä¸ Vue å®ä¾‹ä¸­çš„ä¸€ä¸ªå˜é‡è¿›è¡ŒåŒå‘ç»‘å®šï¼Œç»‘å®šçš„å˜é‡éœ€è¦æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚ ``` html &lt;template&gt; &lt;color-picker size=&quot;mini&quot; v-model=&quot;color&quot;&gt;&lt;/color-picker&gt; &lt;/template&gt; &lt;script&gt; export default { data() { return { color: '#409EFF' } } }; &lt;/script&gt; `` ` &lt;= åˆ é™¤å·¦ä¾§ç©ºæ ¼ ::: ä¸Šè¿°ç¤ºä¾‹çš„æ¸²æŸ“ç»“æœ ç‚¹æ­¤æŸ¥çœ‹ï¼Œå°±è¿™ä¸ªç¤ºä¾‹æ¥çœ‹ï¼Œä»–è‡³å°‘æœ‰ä¸¤ç‚¹å¥½å¤„ï¼š ç¤ºä¾‹ä¸ä»£ç ä¸ç”¨å†™ä¸¤é ä¸å¤æ‚çš„ç¤ºä¾‹å¯ä»¥ç›´æ¥å†™åœ¨ Markdown ä¸­ç¼–å†™ï¼Œä¸éœ€è¦æ¯ä¸ªç¤ºä¾‹éƒ½å»ºä¸€ä¸ªæ–‡ä»¶ è€Œå¯¹æ¯”æ–¹æ¡ˆå››çš„å¥½å¤„å°±åœ¨äºç¬¬2ç‚¹ï¼Œç›¸æ¯”ä¹‹ä¸‹åè€…æœ‰æ›´é«˜çš„çµæ´»åº¦ï¼Œè€Œæ–¹æ¡ˆå››éœ€è¦æ¯ä¸ªç¤ºä¾‹éƒ½å»ºä¸€ä¸ª Vue æ–‡ä»¶å¹¶ä¸”è¢« Vuepress å…¨å±€å¼•å…¥ã€‚ å¦‚ä½•å®ç°ï¼Ÿvuepress-plugin-demo-container å·²ç»å®ç°äº†ä¸Šè¿°æœ€ä½³æ–¹æ¡ˆï¼Œåœ¨ Vuepress ä¸­å¼•å…¥è¯¥æ’ä»¶å³å¯è·å¾—æƒ³è¦çš„æ•ˆæœï¼Œå…³äºè¯¥æ’ä»¶çš„ä»‹ç»å¯ä»¥ ç‚¹æ­¤æŸ¥çœ‹ï¼Œæ–‡æ¡£æä¾›äº†å®ƒçš„å·¥ä½œåŸç†ã€æ¸²æŸ“æ•ˆæœã€ä¸æ’ä»¶æ¯”è¾ƒåŠä½¿ç”¨æ–¹å¼ç­‰æè¿°ï¼Œåœ¨è¿™é‡Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ï¼Œå¦‚æœæœ‰å»ºè®®æˆ–ç–‘é—®å¯ä»¥é€šè¿‡æˆ–è€…è¯„è®ºæˆ–è€… Issus æä¾›ç»™æˆ‘ï¼Œæˆ‘å°†å°½åŠ›è§£ç­”ã€‚ å…³äºå…¬ä¼—å·","link":"/2020-05-31-vuepress-plugin-demo-container/"},{"title":"å¤šæ•°æ®æºä¸‹SpringTransactionçš„æ¢ç©¶","text":"&emsp;&emsp;æœ€è¿‘çš„é¡¹ç›®å¼€å‘ä¸­æœ‰éƒ¨åˆ†åŒäº‹åé¦ˆåˆ°ç°å¼€å‘ç³»ç»Ÿä¸­å­˜åœ¨ä¸€äº›å£°æ˜å¼ï¼ˆæ³¨è§£ï¼‰äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„é—®é¢˜ï¼Œç»è¿‡ä¸€ä¸ªå¤šå°æ—¶çš„æ’æŸ¥æœ€ç»ˆå®šä½äº†é—®é¢˜æ‰€åœ¨ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚ å‰è¨€æŠ€æœ¯èƒŒæ™¯ç°å¼€å‘çš„ç³»ç»Ÿä½¿ç”¨SpringBoot+JPA+Hibernateä½œä¸ºåŸºç¡€æ¡†æ¶è¿›è¡Œå¼€å‘ï¼Œå½“ç„¶æ•´ä½“ä¸Šè¿˜åŒ…æ‹¬ä¸€äº›æƒé™æ–¹é¢Securityç­‰å’Œæœ¬æ¬¡é—®é¢˜æ’æŸ¥æ— å…³çš„ä¿¡æ¯ä¸å†è¯¦è°ˆï¼Œä»¥ä¸‹æ˜¯æ ¸å¿ƒåº“çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚ SpringBootï¼š2.1.5.RELEASE Hibernateï¼š5.3.10.Final ä¸å¸¸è§„ç³»ç»Ÿä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äºï¼Œæœ¬ç³»ç»Ÿç”±äºä¸šåŠ¡çš„ç‰¹æ®Šæ€§é‡‡ç”¨äº†åŒæ•°æ®æºçš„æ–¹æ¡ˆï¼Œæ—¢ç„¶æ˜¯åŒæ•°æ®æºé‚£ä¹ˆäº‹åŠ¡ç®¡ç†å™¨æ–¹é¢ä¹Ÿä¼šå¯¹åº”é…ç½®ä¸¤ä¸ªã€‚ åŒæ•°æ®æºå®ç°æ–¹æ¡ˆåŸºäºJPAå®ç°åŒæ•°æ®æºå¹¶ä¸éº»çƒ¦ï¼Œåªéœ€è¦å»ºç«‹ä¸¤ä¸ªé…ç½®ç±»åˆ†åˆ«å®šä¹‰DataSourceã€SessionFactoryã€PlatformTransactionManagerå¯¹è±¡ï¼Œå…¶ä¸­SessionFactoryé…ç½®å¥½Daoå±‚çš„æ‰«æè·¯å¾„åŒºåˆ†å¼€å³å¯ï¼Œä»¥ä¸‹æ˜¯é…ç½®çš„ç¤ºä¾‹ä»£ç ï¼š @Configuration public class SystemDSConfiguration { @Resource private Environment environment; /** * ç³»ç»Ÿæ•°æ®æº */ @Primary @Bean public DataSource systemDataSource() { DruidDataSource druidDataSource = new DruidDataSource(); druidDataSource.setUrl(environment.getProperty(&quot;spring.datasource.system.jdbc-url&quot;)); druidDataSource.setUsername(environment.getProperty(&quot;spring.datasource.system.username&quot;)); druidDataSource.setPassword(environment.getProperty(&quot;spring.datasource.system.password&quot;)); druidDataSource.setDriverClassName(environment.getProperty(&quot;spring.datasource.system.driver-class-name&quot;)); return druidDataSource; } @Primary @Bean public SessionFactory systemSessionFactory(DataSource dataSource) { LocalSessionFactoryBuilder sessionFactoryBuilder = new LocalSessionFactoryBuilder(dataSource); sessionFactoryBuilder.scanPackages(&quot;com.zjcds.tj.server.system&quot;); sessionFactoryBuilder.setProperty(AvailableSettings.SHOW_SQL, &quot;true&quot;); return sessionFactoryBuilder.buildSessionFactory(); } /** * é…ç½®hibernateäº‹åŠ¡ç®¡ç†å™¨ * @return è¿”å›äº‹åŠ¡ç®¡ç†å™¨ */ @Primary @Bean public PlatformTransactionManager systemTransactionManager(DataSource dataSource) { return new JpaTransactionManager(systemSessionFactory(dataSource)); } } @Configuration public class BusinessDSConfiguration { @Resource private Environment environment; private DataSource businessDataSource() { // ... } @Bean public SessionFactory businessSessionFactory() { // ... } @Bean public PlatformTransactionManager businessTransactionManager() { // ... } } å£°æ˜å¼äº‹åŠ¡çš„ä½¿ç”¨ç†Ÿæ‚‰SpringBootçš„åŒå­¦åº”è¯¥éƒ½çŸ¥é“ï¼Œå£°æ˜å¼ä½¿ç”¨äº‹åŠ¡åªéœ€è¦åœ¨æœåŠ¡çš„å®ç°ç±»æˆ–è€…å‡½æ•°ä¸Šå†™ä¸Š@Transactionalæ³¨è§£å³å¯ï¼Œæ‰€ä»¥æœ¬ç³»ç»Ÿå¯¹äºäº‹åŠ¡çš„ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š package com.zjcds.tj.server.business.service.impl; @Slf4j @Service @Transactional @RequiredArgsConstructor public class BusinessService implements IBusinessService { private final BusinessDTO.DTOConverter businessDTOConverter = new BusinessDTO.DTOConverter(); private final IBussinessDao businessDao; public BusinessVO saveBusiness(BusinessDTO dto) { log.debug(&quot;Save business {}&quot;, dto); BussinessEntity entity = businessDTOConverter.doForward(dto); bussinessDao.save(entity); throw new Exception(&quot;DB rollback test.&quot;); } // more code ... } è¿™ä¸ªæœåŠ¡æŒ‰ç…§é¢„æœŸçš„è¿è¡Œç»“æœBussinessEntityä¸šåŠ¡å®ä½“ä¸åº”è¯¥è¢«æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ï¼Œä½†è¿™ç¯‡æ–‡ç« çš„å‡ºç°ä»£è¡¨ä»£ç çš„æ‰§è¡Œç»“æœæ­£å¥½ä¸é¢„æœŸç›¸åï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±è¦æ’æŸ¥ä¸€ä¸‹ä¸ºä»€ä¹ˆäº‹åŠ¡æ²¡æœ‰ç”Ÿæ•ˆå‘¢ï¼Ÿ åˆ†æåˆ†æé—®é¢˜çš„äº§ç”ŸåŸå› ä¹‹å‰æˆ‘ä»¬å…ˆè¦ææ‡‚@Transactionalæ˜¯æ€ä¹ˆèµ·ä½œç”¨çš„ï¼Œæˆ‘å°è¯•æŠŠ@Transactional å·¥ä½œåŸç†ä½œä¸ºå…³é”®å­—åœ¨googleä¸­æœç´¢ï¼Œçœ‹äº†ä¸€éƒ¨åˆ†æ–‡ç« åæ€»ç»“äº†æœ‰ä»¥ä¸‹å‡ ç±» è®²@Transactionalç”¨æ³•ä¸€ç±»ï¼ˆå¦‚ä½•ä½¿ç”¨ã€å£°æ˜å¼ã€å‘½ä»¤å¼ï¼‰ è®²äº‹åŠ¡æ¦‚å¿µæ€§ä¸€ç±»ï¼ˆäº‹åŠ¡çš„å±æ€§å’Œè¡Œä¸ºç­‰ç­‰ï¼‰ è®²Springå®ç°äº‹åŠ¡çš„åŸç†ä¸æ ¸å¿ƒä¸€ç±» ç»“åˆæœç´¢åˆ°çš„å†…å®¹æˆ‘å‡†å¤‡æŒ‰ç…§è‡ªå·±çš„æ€è·¯è¿›æºç çœ‹ä¸€çœ‹ï¼Œæ¯•ç«Ÿæºç é¢å‰æ— ç§˜å¯†ã€‚æ¥ä¸‹æ¥æˆ‘å°†å™è¿°ä¸€ä¸‹æˆ‘å¦‚ä½•ä»æºç ä¸­æ‰¾åˆ°æˆ‘æƒ³è¦çš„ä¸œè¥¿ã€‚ æ•´åˆæœç´¢ç»“æœåˆšæ‰æˆ‘è¯´åˆ°ç»“åˆæœç´¢åˆ°çš„å†…å®¹ï¼Œä½†æ²¡è¯´æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œè¿™é‡Œæˆ‘ç»™ä¸€ä¸‹æœç´¢å†…å®¹ä¸­æˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„ä¸€äº›çŸ¥è¯†ç‚¹ï¼š SpringBootæœ‰ä¸¤ç§æ–¹å¼å¼€å¯äº‹åŠ¡ è‡ªåŠ¨è£…è½½ä¾èµ–äºTransactionAutoConfiguration æ‰‹åŠ¨å¯ç”¨ä¾èµ–äº@EnableTransactionManagemen Springäº‹åŠ¡æ˜¯åŸºäºAOPè¿ä½œçš„ï¼ŒTransactionInterceptoræ˜¯å…¶åˆ‡é¢çš„å®ç°ç±» @Transactionalä¸­æä¾›äº†ä¸€äº›é…ç½®å¦‚transactionManagerã€rollbackForç­‰ç­‰ï¼ŒAnnotationTransactionAttributeSourceè´Ÿè´£è¯»å–è¿™äº›é…ç½® PlatformTransactionManagerä½œä¸ºSpringä¸­äº‹åŠ¡ç®¡ç†å™¨çš„å®šä¹‰ï¼ŒåŒ…æ‹¬getTransactionã€commitã€rollbackä¸‰ä¸ªæ–¹æ³• ç°åœ¨ä½ ä¹Ÿæœ‰è¿™äº›çŸ¥è¯†ç‚¹äº†ï¼Œé©¬ä¸Šæˆ‘ä»¬å°†è¿›å…¥Transactionalçš„æºç è§£æéƒ¨åˆ†ã€‚è¦çœ‹æºç é¦–å…ˆæˆ‘ä»¬è¦æ‰¾åˆ°å…¥å£ï¼Œæˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œç”±äºæˆ‘çš„é¡¹ç›®ä¸­æ²¡æœ‰ä½¿ç”¨@EnableTransactionManagemenæ³¨è§£ï¼Œæ‰€ä»¥äº‹åŠ¡æ˜¯é€šè¿‡TransactionAutoConfigurationè‡ªåŠ¨å®Œæˆè£…è½½é…ç½®ã€‚ SpringBootè‡ªåŠ¨è£…é…æœ‰ä¸¤ç§å®ç°æ–¹å¼ ç¬¬ä¸€ç§æ˜¯ç±»SPIæœºåˆ¶ï¼Œé€šè¿‡æ‰«æMETA-INF/spring.factoriesæ–‡ä»¶ä¸­çš„å®šä¹‰çš„ç±»è¿›è¡Œè£…é… ç¬¬äºŒç§æ˜¯@Importæœºåˆ¶ï¼Œé€šè¿‡æ‰«æ@Importæ³¨è§£ä¸­å®šä¹‰çš„ç±»è¿›è¡Œè£…é… TransactionAutoConfigurationçš„æ¢ç©¶TransactionAutoConfigurationçš„ä»£ç å¦‚ä¸‹ï¼Œä»£ç é‡å¹¶ä¸å¤šå¹¶ä¸”æˆ‘å¤§éƒ¨åˆ†éƒ½ç»™å‡ºäº†æ³¨é‡Šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¥å¦‚ä½•å»çœ‹è¿™ä¸ªä»£ç å‘¢ï¼Ÿ ç»“åˆç¬¬äºŒä¸ªçŸ¥è¯†ç‚¹ï¼ŒSpringäº‹åŠ¡æ˜¯åŸºäºAOPè¿ä½œçš„ï¼Œæ—¢ç„¶æ˜¯åŸºäºAOPé‚£å°±ä¸€å®šä¼šæœ‰åˆ‡é¢çš„å®šä¹‰ã€‚ SpringAOPçš„å®ç°æ–¹å¼æœ‰ä¸¤ç§ ç¬¬ä¸€ç§æ˜¯JDKä»£ç† ç¬¬äºŒç§æ˜¯Cglibä»£ç† @Configuration // ä»£è¡¨æŸä¸ªç±»å‹çš„Beanå­˜åœ¨æ—¶æ­¤é…ç½®æ‰åŠ è½½ @ConditionalOnClass(PlatformTransactionManager.class) // ä»£è¡¨å½“å‰ç±»åŠ è½½å®Œæˆåå°†åŠ è½½é…ç½®ä¸­çš„ç±» @AutoConfigureAfter({JtaAutoConfiguration.class, HibernateJpaAutoConfiguration.class, DataSourceTransactionManagerAutoConfiguration.class, Neo4jDataAutoConfiguration.class}) // ä½¿@ConfigurationPropertiesæ³¨è§£ç”Ÿæ•ˆ @EnableConfigurationProperties(TransactionProperties.class) public class TransactionAutoConfiguration { // å®šä¹‰ä¸€ä¸ªBeanæ‰˜ç®¡äºSpringå®¹å™¨ å‡½æ•°è¿”å›å€¼ä»£è¡¨BeanType å‡½æ•°åç§°ä»£è¡¨BeanName @Bean // ä»£è¡¨Springå®¹å™¨ä¸­æ²¡æœ‰ä¸ä¹‹åŒ¹é…çš„Beanæ—¶ æ­¤é…ç½®åŠ è½½ @ConditionalOnMissingBean public TransactionManagerCustomizers platformTransactionManagerCustomizers( ObjectProvider&lt;PlatformTransactionManagerCustomizer&lt;?&gt;&gt; customizers) { return new TransactionManagerCustomizers( customizers.orderedStream().collect(Collectors.toList())); } @Configuration // æŒ‡å®šBeanåœ¨å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ª å¦‚æœæœ‰å¤šä¸ªéœ€è¦ç”¨@Primaryæ ‡è®°ä¸»ä½“ @ConditionalOnSingleCandidate(PlatformTransactionManager.class) public static class TransactionTemplateConfiguration { private final PlatformTransactionManager transactionManager; public TransactionTemplateConfiguration( PlatformTransactionManager transactionManager) { this.transactionManager = transactionManager; } @Bean @ConditionalOnMissingBean public TransactionTemplate transactionTemplate() { return new TransactionTemplate(this.transactionManager); } } @Configuration // æŒ‡å®šBeanå­˜åœ¨æ—¶æ‰åŠ è½½æ­¤é…ç½® @ConditionalOnBean(PlatformTransactionManager.class) @ConditionalOnMissingBean(AbstractTransactionManagementConfiguration.class) // ä¸éš¾å‘ç° è¿™é‡Œæœ‰å…³äºaopçš„å®šä¹‰ æˆ‘ä»¬å°†å…ˆè§‚å¯Ÿæ­¤é…ç½®æ–‡ä»¶ public static class EnableTransactionManagementConfiguration { @Configuration // è¿™é‡Œé€šè¿‡æ³¨è§£æ‰‹åŠ¨å¯ç”¨äº†äº‹åŠ¡æ¨¡å— @EnableTransactionManagement(proxyTargetClass = false) // é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå€¼åŒ¹é…æ—¶ç”Ÿæ•ˆ @ConditionalOnProperty(prefix = &quot;spring.aop&quot;, name = &quot;proxy-target-class&quot;, havingValue = &quot;false&quot;, matchIfMissing = false) public static class JdkDynamicAutoProxyConfiguration { } @Configuration @EnableTransactionManagement(proxyTargetClass = true) @ConditionalOnProperty(prefix = &quot;spring.aop&quot;, name = &quot;proxy-target-class&quot;, havingValue = &quot;true&quot;, matchIfMissing = true) public static class CglibAutoProxyConfiguration { } } } è§‚å¯Ÿè¿™ä¸ªç±»ä½ å¾ˆå¿«å°±èƒ½å‘ç°ä¸€ä¸ªå…³é”®ç‚¹ï¼Œä½ è¦æ‰¾åˆ°åˆ‡é¢é…ç½®å°±åœ¨æœ€ä¸‹æ–¹EnableTransactionManagementConfigurationè¿™ä¸ªç±»ä¸­ï¼Œè€Œè¿™ä¸ªç±»åˆä½¿ç”¨äº†@EnableTransactionManagementè¿™ä¸ªæ³¨è§£ï¼Œè€Œå®ƒä¹Ÿæ˜¯æˆ‘ä»¬å‰é¢æåˆ°æ‰‹åŠ¨å¼€å¯äº‹åŠ¡çš„æ³¨è§£ï¼Œæ‰€ä»¥æ— è®ºå¦‚ä½•æˆ‘ä»¬éƒ½å¾—å…³æ³¨ä¸€ä¸‹å®ƒã€‚ EnableTransactionManagementçš„æ¢ç©¶é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹@EnableTransactionManagementçš„ä»£ç  @Target(ElementType.TYPE) @Retention(RetentionPolicy.RUNTIME) @Documented @Import(TransactionManagementConfigurationSelector.class) public @interface EnableTransactionManagement { // æ˜¯å¦è¦åˆ›å»ºåŸºäºCglibçš„ä»£ç†ï¼Œå¦åˆ™åˆ›å»ºJDKçš„ä»£ç  boolean proxyTargetClass() default false; // åº”è¯¥å¦‚ä½•é‡‡ç”¨äº‹åŠ¡é€šçŸ¥ Proxy æˆ–è€… Aspectj AdviceMode mode() default AdviceMode.PROXY; int order() default Ordered.LOWEST_PRECEDENCE; } å¯¹æˆ‘æ¥è¯´ï¼Œè¯¥ä»£ç å°±ä¸€ä¸ªæœ‰æ•ˆä¿¡æ¯ï¼ŒåŠ è½½äº†TransactionManagementConfigurationSelectorè¿™ä¸ªé…ç½®ç±»ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çœ‹çœ‹å®ƒçš„ä»£ç  // AdviceModeImportSelector æä¾›æ ¹æ®AdviceModeçš„å€¼è¿›è¡Œé…ç½®åˆ‡æ¢çš„ç­–ç•¥ public class TransactionManagementConfigurationSelector extends AdviceModeImportSelector&lt;EnableTransactionManagement&gt; { @Override protected String[] selectImports(AdviceMode adviceMode) { switch (adviceMode) { case PROXY: // åŸºäºJDKä»£ç†å®ç°åˆ‡é¢é…ç½® é»˜è®¤é‡‡ç”¨ return new String[]{AutoProxyRegistrar.class.getName(), ProxyTransactionManagementConfiguration.class.getName()}; case ASPECTJ: // åŸºäºASPECTJå®ç°åˆ‡é¢é…ç½® return new String[]{determineTransactionAspectClass()}; default: return null; } } private String determineTransactionAspectClass() { return (ClassUtils.isPresent(&quot;javax.transaction.Transactional&quot;, getClass().getClassLoader()) ? TransactionManagementConfigUtils.JTA_TRANSACTION_ASPECT_CONFIGURATION_CLASS_NAME : TransactionManagementConfigUtils.TRANSACTION_ASPECT_CONFIGURATION_CLASS_NAME); } } å¦‚æœä¸ç‰¹æ®Šé…ç½®ï¼Œè¿™é‡Œä¼šé»˜è®¤é‡‡ç”¨JDKåŠ¨æ€ä»£ç†çš„æ–¹æ¡ˆï¼Œæ‰€ä»¥AutoProxyRegistrarã€ProxyTransactionManagementConfigurationè¿™ä¸¤ä¸ªé…ç½®ç±»ä¼šè¢«åŠ è½½ AutoProxyRegistrar @Override public void registerBeanDefinitions(..) { ... if (mode == AdviceMode.PROXY) { AopConfigUtils.registerAutoProxyCreatorIfNecessary(registry); if ((Boolean) proxyTargetClass) { AopConfigUtils.forceAutoProxyCreatorToUseClassProxying(registry); return; } } ... } ProxyTransactionManagementConfiguration @Configuration public class ProxyTransactionManagementConfiguration extends AbstractTransactionManagementConfiguration { @Bean(name = TransactionManagementConfigUtils.TRANSACTION_ADVISOR_BEAN_NAME) // ç”¨ä½œBeançš„åˆ†ç±» @Role(BeanDefinition.ROLE_INFRASTRUCTURE) // äº‹åŠ¡å¢å¼ºå™¨ public BeanFactoryTransactionAttributeSourceAdvisor transactionAdvisor() { BeanFactoryTransactionAttributeSourceAdvisor advisor = new BeanFactoryTransactionAttributeSourceAdvisor(); advisor.setTransactionAttributeSource(transactionAttributeSource()); advisor.setAdvice(transactionInterceptor()); if (this.enableTx != null) { advisor.setOrder(this.enableTx.&lt;Integer&gt;getNumber(&quot;order&quot;)); } return advisor; } @Bean @Role(BeanDefinition.ROLE_INFRASTRUCTURE) // äº‹åŠ¡æ³¨è§£ä¿¡æ¯è¯»å– public TransactionAttributeSource transactionAttributeSource() { return new AnnotationTransactionAttributeSource(); } @Bean @Role(BeanDefinition.ROLE_INFRASTRUCTURE) // æ–¹æ³•æ‹¦æˆªå™¨ public TransactionInterceptor transactionInterceptor() { TransactionInterceptor interceptor = new TransactionInterceptor(); interceptor.setTransactionAttributeSource(transactionAttributeSource()); if (this.txManager != null) { interceptor.setTransactionManager(this.txManager); } return interceptor; } } è‡³æ­¤æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†äº‹åŠ¡æ–¹æ³•æ‹¦æˆªå™¨TransactionInterceptorçš„å®šä¹‰ä¹‹å¤„ï¼Œæ¥ä¸‹æ¥å°±çœ‹çœ‹æˆ‘ä»¬çš„æ–¹æ³•è¢«äº‹åŠ¡æ‹¦æˆªåå¹²äº†ä»€ä¹ˆï¼Ÿ TransactionInterceptoræ¢ç©¶é˜…è¯»TransactionInterceptorè¿™ä¸ªç±»ä¸éš¾å‘ç°invokeå³æ˜¯äº‹åŠ¡æ‹¦æˆªçš„ä¸»è¦å®ç°ï¼Œè€Œå®ƒä»…æœ‰ä¸¤å¥ä»£ç è€Œå·²ï¼Œä¸»è¦æ˜¯è°ƒç”¨äº†çˆ¶ç±»çš„invokeWithinTransactionæ–¹æ³•ã€‚ // MethodInterceptor æ–¹æ³•æ‹¦æˆªæ¥å£ invokeä½œä¸ºå…·ä½“å®ç°å‡½æ•° public class TransactionInterceptor extends TransactionAspectSupport implements MethodInterceptor, Serializable { public TransactionInterceptor() { } public TransactionInterceptor(PlatformTransactionManager ptm, Properties attributes) { setTransactionManager(ptm); setTransactionAttributes(attributes); } public TransactionInterceptor(PlatformTransactionManager ptm, TransactionAttributeSource tas) { setTransactionManager(ptm); setTransactionAttributeSource(tas); } @Override @Nullable // äº‹åŠ¡æ–¹æ³•æ‹¦æˆªçš„å…·ä½“å®ç° è°ƒç”¨äº†çˆ¶ç±»çš„invokeWithinTransactionæ–¹æ³• public Object invoke(MethodInvocation invocation) throws Throwable { // è·å–ä»£ç†çš„ç›®æ ‡ç±» Class&lt;?&gt; targetClass = (invocation.getThis() != null ? AopUtils.getTargetClass(invocation.getThis()) : null); return invokeWithinTransaction(invocation.getMethod(), targetClass, invocation::proceed); } //--------------------------------------------------------------------- // Serialization support //--------------------------------------------------------------------- private void writeObject(ObjectOutputStream oos) throws IOException { // ... } private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException { // ... } } ç´§æ¥ç€æˆ‘ä»¬æŸ¥çœ‹çˆ¶ç±»çš„invokeWithinTransactionæ–¹æ³•ï¼Œä»£ç é‡è™½ç„¶æ¯”è¾ƒå¤šï¼Œä½†æ˜¯ç»“åˆé¡¹ç›®çš„é…ç½®å¾ˆå¿«å°±ä¼šå‘ç°ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯JpaTransactionManageræ‰€ä»¥åé¢çš„æ¡ä»¶æ˜¯ä¸ä¼šè¿›å»çš„ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦çœ‹å‰é¢ä¸€å°æ®µçš„ä»£ç å³å¯ï¼Œè¿™æ®µä»£ç ä¸­æœ‰ä¸€ä¸ªè·å–äº‹åŠ¡ç®¡ç†å™¨çš„å‡½æ•°å«åšdetermineTransactionManagerï¼ŒåŒæ•°æ®æºä¸‹çš„äº‹åŠ¡å¤±æ•ˆå¾ˆæœ‰å¯èƒ½æ˜¯äº‹åŠ¡ç®¡ç†å™¨è·å–é”™è¯¯å¯¼è‡´çš„ã€‚ // BeanFactoryAware ä¸ºå½“å‰ç±»æä¾›äº† BeanFactory èµ„æº // InitializingBean å½“å‰ç±»æ„é€ å®Œæˆæ—¶å°†æ”¶åˆ°é€šçŸ¥ public abstract class TransactionAspectSupport implements BeanFactoryAware, InitializingBean { @Nullable protected Object invokeWithinTransaction(Method method, @Nullable Class&lt;?&gt; targetClass, final InvocationCallback invocation) throws Throwable { TransactionAttributeSource tas = getTransactionAttributeSource(); // è¯»å– @Transactional ä¸­å®šä¹‰çš„å±æ€§ final TransactionAttribute txAttr = (tas != null ? tas.getTransactionAttribute(method, targetClass) : null); // æ ¹æ®å®šä¹‰çš„å±æ€§è·å–ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨ final PlatformTransactionManager tm = determineTransactionManager(txAttr); final String joinpointIdentification = methodIdentification(method, targetClass, txAttr); if (txAttr == null || !(tm instanceof CallbackPreferringPlatformTransactionManager)) { // ç”±äºæœ¬é¡¹ç›®é…ç½®çš„æ˜¯JpaTransactionManager å°†è¿›å…¥æ­¤ä»£ç å— // å¿…è¦æ—¶åˆ›å»ºäº‹åŠ¡ TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification); Object retVal; try { // æ‰§è¡Œè¢«ä»£ç†çš„å‡½æ•°å¹¶è·å–ç»“æœ retVal = invocation.proceedWithInvocation(); } catch (Throwable ex) { // å›æ»šäº‹åŠ¡å¹¶å°†å¼‚å¸¸åŸæ ·æŠ›å‡º completeTransactionAfterThrowing(txInfo, ex); throw ex; } finally { cleanupTransactionInfo(txInfo); } // æäº¤äº‹åŠ¡å¹¶è¿”å›ç»“æœ commitTransactionAfterReturning(txInfo); return retVal; } else { final ThrowableHolder throwableHolder = new ThrowableHolder(); // ... more code } } } æˆ‘ä»¬çœ‹åˆ°determineTransactionManagerè¿™ä¸ªæ–¹æ³•æ˜¯æ ¹æ®@Transactionalä¸­çš„æŸäº›å±æ€§æ¥è·å–äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å®ƒå…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ã€‚ @Nullable protected PlatformTransactionManager determineTransactionManager(@Nullable TransactionAttribute txAttr) { if (txAttr == null || this.beanFactory == null) { // è¿”å›æ–¹æ³•æ‹¦æˆªå™¨ä¸­é¢„å…ˆå®šä¹‰çš„äº‹åŠ¡ç®¡ç†å™¨ return getTransactionManager(); } String qualifier = txAttr.getQualifier(); if (StringUtils.hasText(qualifier)) { // è¯»å–qualifierå±æ€§ å¦‚æœå…¶ä¸ä¸ºç©ºåˆ™å»Beanå·¥å‚ä¸­è·å–å¯¹åº”åç§°çš„äº‹åŠ¡ç®¡ç†å™¨ return determineQualifiedTransactionManager(this.beanFactory, qualifier); } else if (StringUtils.hasText(this.transactionManagerBeanName)) { // å¦‚æœæ–¹æ³•æ‹¦æˆªå™¨ä¸­å®šä¹‰äº†åå­—åˆ™é‡‡ç”¨å®¹å™¨ä¸­åŒåçš„äº‹åŠ¡ç®¡ç†å™¨ return determineQualifiedTransactionManager(this.beanFactory, this.transactionManagerBeanName); } else { PlatformTransactionManager defaultTransactionManager = getTransactionManager(); if (defaultTransactionManager == null) { defaultTransactionManager = this.transactionManagerCache.get(DEFAULT_TRANSACTION_MANAGER_KEY); if (defaultTransactionManager == null) { // å¦‚æœéƒ½ä¸åŒ¹é…å°±è·å–å®šä¹‰ä¸ºä¸»ä½“çš„äº‹åŠ¡ç®¡ç†å™¨ defaultTransactionManager = this.beanFactory.getBean(PlatformTransactionManager.class); this.transactionManagerCache.putIfAbsent( DEFAULT_TRANSACTION_MANAGER_KEY, defaultTransactionManager); } } return defaultTransactionManager; } } é—®é¢˜æµ®å‡ºæ°´é¢ç»è¿‡debugåˆ†ææˆ‘æ‰¾åˆ°äº†äº‹åŠ¡å¤±æ•ˆçš„åŸå› ï¼Œç”±äºæˆ‘çš„Bussinessæ¨¡å—è·å–äº†Systemæ¨¡å—çš„äº‹åŠ¡ç®¡ç†å™¨å¯¼è‡´å…¶äº‹åŠ¡å¤±æ•ˆã€‚ è¿™é‡Œæœ‰äººå¯èƒ½ä¼šæ„Ÿåˆ°ç–‘æƒ‘ï¼Œè·å–äº†é”™è¯¯çš„äº‹åŠ¡ç®¡ç†å™¨ä¸ä¼šæŠ¥é”™ä¹ˆï¼Ÿ è¿™å—æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåˆ†æï¼Œæƒ³æƒ³åœ¨mysqlä¸­æˆ‘ä»¬æ˜¯æ€ä¹ˆå¼€å¯äº‹åŠ¡çš„ã€‚ mysql&gt; begin; # æ•°æ®åº“Aå¼€å¯äº‹åŠ¡ Query OK, 0 rows affected (0.00 sec) mysql&gt; delete from sys_user where id = 1; # æ•°æ®åº“Aæ‰§è¡Œåˆ é™¤è„šæœ¬ Query OK, 1 row affected (0.01 sec) mysql&gt; rollback; # æ•°æ®åº“Aå›æ»š Query OK, 0 rows affected (0.01 sec) mysql&gt; åŒæ ·Springåœ¨ä½¿ç”¨äº‹åŠ¡æ—¶ä¹Ÿæ˜¯åœ¨è¿œç¨‹æ‰§è¡Œè„šæœ¬ï¼Œåªä¸è¿‡æµç¨‹å˜æˆäº†ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œæ•°æ®åº“Aå¼€å¯äº†äº‹åŠ¡æˆ‘ä»¬å´åœ¨æ•°æ®åº“Bæ‰§è¡Œè„šæœ¬ï¼Œç†è®ºä¸Šæ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œä½†æ˜¯æ•°æ®åº“Bçš„äº‹åŠ¡è‚¯å®šä¸ä¼šç”Ÿæ•ˆã€‚ mysql&gt; begin; # æ•°æ®åº“Aå¼€å¯äº‹åŠ¡ Query OK, 0 rows affected (0.00 sec) mysql&gt; delete from sys_user where id = 1; # æ•°æ®åº“Bæ‰§è¡Œåˆ é™¤è„šæœ¬ Query OK, 1 row affected (0.01 sec) mysql&gt; rollback; # æ•°æ®åº“Aå›æ»š Query OK, 0 rows affected (0.01 sec) mysql&gt; è§£å†³æ–¹æ¡ˆæ—¢ç„¶é—®é¢˜å·²ç»æ‰¾åˆ°äº†æ¥ä¸‹æ¥è¦è€ƒè™‘ä¸‹å¦‚ä½•è§£å†³ï¼Œå…¶å®ä¸Šæ–‡å¾ˆæ—©çš„æ—¶å€™å°±æåˆ°äº†@Transactionalæœ‰ä¸€ä¸ªé…ç½®å«åštransactionManagerï¼Œå¯ä»¥æŒ‡å®šå½“å‰å¯ç”¨äº‹åŠ¡çš„æ–¹æ³•ç”¨å“ªä¸ªäº‹åŠ¡ç®¡ç†å™¨ã€‚ @Target({ElementType.METHOD, ElementType.TYPE}) @Retention(RetentionPolicy.RUNTIME) @Inherited @Documented public @interface Transactional { @AliasFor(&quot;transactionManager&quot;) String value() default &quot;&quot;; @AliasFor(&quot;value&quot;) String transactionManager() default &quot;&quot;; // ... } æ‰€ä»¥æœ€ç®€å•çš„ä¸€ç§æ–¹æ¡ˆå°±æ˜¯ç»™æ‰€æœ‰çš„Serviceå®ç°ç±»éƒ½åŠ ä¸ŠæŒ‡å®šäº‹åŠ¡ç®¡ç†å™¨åç§°çš„@Transactionalæ³¨è§£ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç³»ç»Ÿå¼€å‘å·²ç»æ¥è¿‘å°¾å£°ï¼Œæˆ‘ä¸æƒ³ä¸€ä¸ªä¸€ä¸ªå»ä¿®æ”¹æ–‡ä»¶ï¼Œæœ‰æ²¡æœ‰ä¸ä¿®æ”¹åŸæ¥çš„ä»£ç è€Œé‡‡ç”¨æ–°å¢ä»£ç çš„æ–¹å¼å»è§£å†³å‘¢ï¼Ÿ åŠæ³•å½“ç„¶æ˜¯æœ‰çš„ï¼Œæ•´ç†ä¸€ä¸‹å‰é¢æåˆ°çš„è·å–äº‹åŠ¡ç®¡ç†å™¨çš„æµç¨‹ï¼Œå¤§æ¦‚å¦‚ä¸‹æ‰€ç¤ºï¼š TransactionAttributeSourceç»„ä»¶è´Ÿè´£è§£æ@Transactionalçš„é…ç½®å¾—åˆ°TransactionAttribute è¯»å–TransactionAttributeä¸­çš„qualifierç”¨äºè·å–ä¸€ä¸ªå…·åçš„äº‹åŠ¡ç®¡ç†å™¨ å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ›¿æ¢ä¸€ä¸ªTransactionAttributeSourceçš„å®ç°è®©å…¶æ ¹æ®åŒ…åè¿”å›ä¸åŒçš„äº‹åŠ¡ç®¡ç†å™¨åç§°ï¼Œå³å¯å®Œæˆä¸Šè¿°éœ€æ±‚ã€‚ è¦æ›¿æ¢æˆ‘ä»¬å°±å¾—çŸ¥é“è¿™ç©æ„å„¿åœ¨å“ªå„¿å®šä¹‰çš„ï¼Œå…¶å®é˜…è¯»æºç çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å·²ç»çœ‹åˆ°è¿‡äº†ï¼ŒProxyTransactionManagementConfigurationè¿™ä¸ªç±»è´Ÿè´£äº†å®šä¹‰å·¥ä½œï¼Œæˆ‘ä»¬åªéœ€è¦é‡æ–°å®šä¹‰ä¸€ä¸ªProxyTransactionManagementConfigurationå³å¯å®Œæˆæ›¿æ¢äº†ï¼Œå› ä¸ºTransactionAutoConfigurationä¸­æœ‰@ConditionalOnMissingBean(AbstractTransactionManagementConfiguration.class)çš„é™å®šï¼Œè€ŒAbstractTransactionManagementConfigurationå³æ˜¯æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰é…ç½®çš„çˆ¶ç±»ï¼Œè‡ªå®šä¹‰åäº‹åŠ¡çš„è‡ªåŠ¨åŒ–é…ç½®å°†ä¸ä¼šåŠ è½½EnableTransactionManagementConfigurationï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°Beançš„å®šä¹‰å†²çªé—®é¢˜ã€‚ public class TransactionAutoConfiguration { @Configuration @ConditionalOnBean(PlatformTransactionManager.class) @ConditionalOnMissingBean(AbstractTransactionManagementConfiguration.class) public static class EnableTransactionManagementConfiguration { // more code... } // more code } åºŸè¯ä¸å¤šè¯´ç›´æ¥ç»™ä»£ç ï¼Œæ­¤é…ç½®å¯é€šè¿‡åŒ…åå‰ç¼€å®ç°åŠ¨æ€åˆ‡æ¢äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ’’èŠ±å®Œç»“ã€‚ @Configuration public class MyProxyTransactionManagementConfiguration extends ProxyTransactionManagementConfiguration { /** * é‡å†™äº†äº‹åŠ¡æ³¨è§£å±æ€§è§£æå™¨çš„å†…å®¹ * è®©å…¶æ ¹æ®åŒ…ååŠ¨æ€çš„è·å–äº‹åŠ¡ç®¡ç†å™¨åç§° * ä»¥è¾¾åˆ°ä¸ä¿®æ”¹Serviceä»£ç çš„å‰æä¸‹ä¿è¯å¤šæ•°æ®æºä¸‹çš„äº‹åŠ¡èƒ½å¤Ÿæ­£å¸¸è¿è¡Œ * * @return äº‹åŠ¡æ³¨è§£å±æ€§è§£æå™¨ */ @Bean @Role(BeanDefinition.ROLE_INFRASTRUCTURE) @Override public TransactionAttributeSource transactionAttributeSource() { return new AnnotationTransactionAttributeSource() { @Override public TransactionAttribute getTransactionAttribute(Method method, @Nullable Class&lt;?&gt; targetClass) { DefaultTransactionAttribute attribute = (DefaultTransactionAttribute) super.getTransactionAttribute(method, targetClass); if (attribute != null &amp;&amp; attribute.getQualifier() == null) { // è·å–æ–¹æ³•å½’å±ç±»çš„å…¨å String name = method.getDeclaringClass().getName(); if (name.startsWith(&quot;com.zjcds.tj.server.system&quot;)) { attribute.setQualifier(&quot;systemTransactionManager&quot;); } else if (name.startsWith(&quot;com.zjcds.tj.server.business&quot;)) { attribute.setQualifier(&quot;businessTransactionManager&quot;); } } return attribute; } }; } } å…³äºå…¬ä¼—å·","link":"/2020-01-09-spring-transaction/"},{"title":"éšç¬”â€”â€”ç¼“å­˜ç³»åˆ—å¼€ç¯‡","text":"&emsp;&emsp;è·¨è¿‡äº†2019æ¥åˆ°äº†2020å¹´ï¼Œæ–°å¹´æ–°æ°”è±¡ï¼Œå‡†å¤‡å†™ä¸€äº›ç³»åˆ—æ€§è´¨çš„æ–‡ç« ï¼Œæ—¨åœ¨æ›´å¥½çš„å¯¹çŸ¥è¯†å½’çº³æ€»ç»“ï¼Œæ›´ç³»ç»Ÿçš„ç†è§£ä¸€å—çŸ¥è¯†é¢ã€‚å¥½çš„åºŸè¯ä¸å¤šè¯´ï¼Œ2020å¹´å¼€ç¯‡çš„ä¸»é¢˜æ˜¯ç¼“å­˜ç³»åˆ—ï¼Œæ˜¯ä¸ªç¨‹åºå‘˜æˆ–å¤šæˆ–å°‘éƒ½è·Ÿç¼“å­˜æ‰“è¿‡äº¤é“ï¼Œä½œä¸ºä¸€ä¸ªJavaç¨‹åºå‘˜å¤§éƒ¨åˆ†æ—¶å€™è¿˜æ˜¯åœ¨åº”ç”¨å±‚ä½¿ç”¨ç¼“å­˜ï¼Œæ¥è§¦çš„ç¼“å­˜æ¡†æ¶å’Œä¸­é—´ä»¶ä¼šæ¯”è¾ƒå¤šï¼Œä½†æ˜¯æœ¬ç³»åˆ—å¹¶ä¸æƒ³ä»…é™äºåº”ç”¨å±‚è®²è¿°ç¼“å­˜ï¼Œæˆ‘å°†ä»åº•å±‚åˆ°CPUã€æ“ä½œç³»ç»Ÿï¼Œä¸­å±‚åˆ°æµè§ˆå™¨ã€CDNï¼Œä¸Šå±‚åº”ç”¨ç¨‹åºæ¥è®²è¿°ç¼“å­˜çš„åº”ç”¨ï¼Œé€šè¿‡è¿™ä¸ªç³»åˆ—èƒ½å­¦ä¹ åˆ°ç¼“å­˜çš„åº”ç”¨åœºæ™¯åŠæ—¶æœºã€‚ å‰è¨€æ–°çš„ä¸€å¹´æˆ‘å°†ç¨å¾®æ”¹å˜ä¸€ä¸‹è‡ªå·±çš„æ–‡ç« æ’å¸ƒï¼Œå°†å¤æ‚çš„é—®é¢˜ä½œä¸ºä¸€ä¸ªç³»åˆ—åˆ†å—è®²è¿°ï¼Œæå–æ¨¡å—çš„é‡ç‚¹å¹¶å‡å°‘å•ç¯‡æ–‡ç« çš„ç¯‡å¹…ï¼Œé™ä½é˜…è¯»æ—¶é—´ã€‚æœ¬ç¯‡æ–‡ç« ä½œä¸ºç¼“å­˜ç³»åˆ—çš„å¼€ç¯‡ä¹‹ä½œç¬¬ä¸€æ­¥è‡ªç„¶æ˜¯æŒ–å‘ï¼Œæœ¬ç³»åˆ—å°†ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢åˆ†å¤šç¯‡æ–‡ç« æ¥è®²è¿°ç¼“å­˜ã€‚ ç¼“å­˜ç³»åˆ—å¼€ç¯‡â€”â€”ç¼“å­˜å®šä¹‰ã€æµè§ˆå™¨ã€CDNä¸­çš„ç¼“å­˜ ç¼“å­˜ç³»åˆ—äºŒâ€”â€”æ“ä½œç³»ç»Ÿã€CPUä¸­çš„ç¼“å­˜ ç¼“å­˜ç³»åˆ—ä¸‰â€”â€”åº”ç”¨ç¨‹åºä¸­çš„ç¼“å­˜ ç¼“å­˜ç³»åˆ—å››â€”â€”å¸¸è§çš„ç¼“å­˜ä¸­é—´ä»¶ ç¼“å­˜ç³»åˆ—äº”â€”â€”ç¼“å­˜å¸¸è§é—®é¢˜ä¸æ€»ç»“ ä»€ä¹ˆæ˜¯ç¼“å­˜å…³äºå®šä¹‰ä½ å»æœç´¢wikiã€ç™¾åº¦ç™¾ç§‘å°±ä¼šå‘ç°ç»™å‡ºæ¥çš„éƒ½æ˜¯è·Ÿå­˜å‚¨å™¨ç›¸å…³çš„ï¼Œè¿™å…¶å®ä¸æ˜¯æˆ‘æƒ³è¦çš„ç­”æ¡ˆã€‚ æˆ‘è®¤ä¸ºçš„ç¼“å­˜æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå­˜å‚¨å™¨ã€ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–è€…ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½†ä¸ç®¡å®ƒæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œå®ƒçš„è¡Œä¸ºæ°¸è¿œéƒ½æ˜¯ä¿å­˜ä¸€ä»½åŸå§‹èµ„æºçš„å‰¯æœ¬å¹¶æä¾›ä¸€ä¸ªé«˜é€Ÿçš„è®¿é—®é€”å¾„ï¼Œè€Œæœ‰è¿™ä¸ªè¡Œä¸ºçš„ä»»æ„ä¸œè¥¿éƒ½å¯ä»¥ç§°ä¹‹ä¸ºç¼“å­˜ã€‚ çŸ¥é“ç¼“å­˜çš„å®šä¹‰åå®ƒçš„åº”ç”¨åœºæ™¯ä¹Ÿå°±å¾ˆæ¸…æ¥šäº†ï¼Œå½“ä½ æœ‰é¢‘ç¹è¯»å–çš„éœ€æ±‚ï¼Œä¸”æºæ•°æ®è®¿é—®é€Ÿåº¦è¿œä½äºæœ¬åœ°è®¿é—®æ—¶ï¼Œå¯é‡‡ç”¨ç¼“å­˜çš„è§£å†³æ–¹æ¡ˆã€‚ æµè§ˆå™¨ä¸­çš„ç¼“å­˜ä¸ºä½•ä½¿ç”¨ç¼“å­˜è¦çŸ¥é“æµè§ˆå™¨ä¸ºä½•ä½¿ç”¨ç¼“å­˜æˆ‘ä»¬å°±å¾—çŸ¥é“æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨åšäº†ä»€ä¹ˆï¼Ÿ ä¸€ä¸ªç½‘é¡µæ˜¯ç”±HTML+JS+CSS+é™æ€æ–‡ä»¶ç»„æˆçš„ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨å…¶å®æ˜¯åœ¨è®¿é—®WebæœåŠ¡å™¨çš„HTMLã€JSã€CSSã€é™æ€æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ã€gifï¼‰ç­‰èµ„æºï¼Œåšè¿‡Webå¼€å‘çš„éƒ½çŸ¥é“JSä¸CSSä»¥åŠé™æ€æ–‡ä»¶åœ¨ç½‘ç«™ä¸Šçº¿ååŸºæœ¬ä¸ä¼šæ”¹å˜ï¼ŒHTMLä½œä¸ºç½‘é¡µç»“æ„å¦‚æœæ˜¯æœåŠ¡ç«¯æ¸²æŸ“é‚£ä¹ˆå®ƒæ˜¯å¯å˜çš„ã€‚ ç»“åˆè¿™äº›çŸ¥é“å†çœ‹çœ‹æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ç¼“å­˜åº”ç”¨åœºæ™¯ æµè§ˆå™¨ä½œä¸ºä¸€ä¸ªç½‘é¡µå®¢æˆ·ç«¯ï¼Œè‡ªç„¶ä¼šæœ‰é¢‘ç¹è¯·æ±‚ç½‘é¡µçš„éœ€æ±‚ï¼Œå³é¢‘ç¹è¯»å–WebæœåŠ¡å™¨çš„èµ„æº æµè§ˆå™¨è®¿é—®WebæœåŠ¡å™¨çš„é€Ÿåº¦è‚¯å®šæ¯”è®¿é—®æœ¬åœ°çš„é€Ÿåº¦æ…¢ä¸€ä¸ªé‡çº§ äºæ˜¯æµè§ˆå™¨å°±é‡‡ç”¨äº†æœ¬åœ°ç¼“å­˜æœåŠ¡å™¨èµ„æºçš„æ–¹å¼æ¥å‡å°‘å‘å¾€æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¹Ÿæé«˜äº†é¡µé¢åŠ è½½çš„æ•ˆç‡ï¼Œåœ¨ç”¨æˆ·ä½¿ç”¨æ—¶ä¹Ÿä¼šæ„Ÿå—åˆ°ç¬¬ä¸€æ¬¡æ‰“å¼€é¡µé¢çš„æ—¶å€™æœ‰ç‚¹æ…¢ï¼Œåé¢å°±å¿«äº†å¾ˆå¤šã€‚ è¿™é‡Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæµè§ˆå™¨ä¸èƒ½ç¼“å­˜æ‰€æœ‰æ•°æ®ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä½ ç½‘é¡µé‡æ–°å‘å¸ƒäº†ä½†æ˜¯å®¢æˆ·æµè§ˆå™¨çš„ç½‘é¡µç¡®ä¸€ç›´ä¸æ›´æ–°ï¼Œ\bæ‰€ä»¥æµè§ˆå™¨éœ€è¦æ ¹æ®æœåŠ¡å™¨çš„å®‰æ’æ¥ç¼“å­˜æ•°æ®ã€‚ å¦‚ä½•ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜æœåŠ¡å™¨å¦‚ä½•æ§åˆ¶æµè§ˆå™¨çš„ç¼“å­˜å‘¢ï¼Ÿè¿™å°±å¾—è®²è®²HTTPåè®®äº†ï¼Œå› ä¸ºæµè§ˆå™¨è·å–æœåŠ¡å™¨èµ„æºéƒ½æ˜¯é€šè¿‡æ­¤åè®®è¿›è¡Œäº¤äº’è®¿é—®ã€‚ä¸ºäº†æ›´å¥½çš„è®²è¿°æµè§ˆå™¨ç¼“å­˜æµç¨‹æˆ‘æˆªå–äº†æœ¬äººåšå®¢ç½‘ç«™çš„ä¸€ä¸ªCSSèµ„æºçš„å“åº”ä½“å¦‚ä¸‹ Request URL: https://chenjianhui.site/css/back-to-top.css Request Method: GET Status Code: 200 OK (from disk cache) Remote Address: 120.79.79.226:443 Referrer Policy: no-referrer-when-downgrade Accept-Ranges: bytes Content-Length: 343 Content-Type: text/css Date: Tue, 07 Jan 2020 02:19:37 GMT ETag: &quot;5e0aac7c-157&quot; Last-Modified: Tue, 31 Dec 2019 02:03:40 GMT Server: nginx/1.15.12 Referer: https://chenjianhui.site/ User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36 CSS Content ... é‡ç‚¹å…³æ³¨ä»¥ä¸‹å‡ ä¸ªå“åº”å¤´éƒ¨ä¿¡æ¯ï¼Œè¿™éƒ¨åˆ†å¤´éƒ¨å®ç°äº†åå•†ç¼“å­˜ã€‚ Status Codeï¼šè¯·æ±‚å“åº”ç ï¼Œè¿™é‡Œ200ä»£è¡¨æˆåŠŸï¼Œåé¢è¿˜æœ‰ä¸€ä¸ªæ‹¬å·from disk cacheæè¿°äº†è¿™ä¸ªèµ„æºæ¥è‡ªäºæœ¬åœ°ç£ç›˜çš„ç¼“å­˜ã€‚ ETagï¼šèµ„æºçš„ç‰¹å®šç‰ˆæœ¬çš„æ ‡è¯†ç¬¦ï¼Œç±»ä¼¼äºèµ„æºçš„æŒ‡çº¹ï¼ˆHashå€¼ï¼‰ï¼Œç”¨äºæä¾›ç»™æµè§ˆå™¨å¿«é€Ÿç¡®å®šèµ„æºæ˜¯å¦å˜åŒ–ã€‚ Last-Modifiedï¼šèµ„æºåšå‡ºä¿®æ”¹çš„æ—¥æœŸåŠæ—¶é—´ï¼Œé€šå¸¸è¢«ç”¨ä½œä¸€ä¸ªéªŒè¯å™¨æ¥åˆ¤æ–­æ¥æ”¶åˆ°çš„æˆ–è€…å­˜å‚¨çš„èµ„æºæ˜¯å¦å½¼æ­¤ä¸€è‡´ï¼Œç”±äºç²¾ç¡®åº¦æ¯”ETagè¦ä½ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¤‡ç”¨æœºåˆ¶ã€‚åŒ…å«æœ‰If-Modified-Sinceæˆ–If-Unmodified-Sinceé¦–éƒ¨çš„æ¡ä»¶è¯·æ±‚ä¼šä½¿ç”¨è¿™ä¸ªå­—æ®µã€‚ é‚£ä¹ˆæ•´ä¸ªç½‘ç»œè¯·æ±‚çš„æµç¨‹æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ å®¢æˆ·ç«¯getè¯·æ±‚èµ„æºï¼ŒæœåŠ¡å™¨è¿”å›èµ„æºï¼Œå¹¶åœ¨å“åº”å¤´ä¸­å¸¦ä¸Šäº†ETagä¸Last-Modifiedçš„å€¼ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å°†èµ„æºç¼“å­˜åœ¨æœ¬åœ°ã€‚ å®¢æˆ·ç«¯å†æ¬¡è¯·æ±‚è¿™ä¸ªèµ„æºï¼Œåœ¨å¯ç”¨ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œå°†ä¸Šæ¬¡è¯·æ±‚çš„ETagå±æ€§å€¼ä½œä¸ºIf-None-Matchçš„å€¼ï¼ŒLast-Modifiedçš„å€¼ä½œä¸ºIf-Modified-Sinceéšè¯·æ±‚å¤´å‘ç»™æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨åˆ¤æ–­èµ„æºç°æœ‰çš„ETagä¸If-None-Matchçš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œä¼šè¿”å›304å’Œç©ºçš„å“åº”ä½“ã€‚æµè§ˆå™¨æ ¹æ®304å–æœ¬åœ°ç¼“å­˜ã€‚ è¿™å°±æ˜¯æµè§ˆå™¨ç¼“å­˜çš„å…¨éƒ¨äº†å—ï¼Ÿ å½“ç„¶ä¸æ˜¯ï¼Œè¿˜æœ‰ä¸¤ä¸ªå“åº”å¤´éƒ¨æ˜¯ç”¨äºæµè§ˆå™¨ç¼“å­˜çš„ï¼Œå®ƒä»¬ç§°ä¹‹ä¸ºå¼ºåˆ¶ç¼“å­˜ï¼Œåˆ†åˆ«æ˜¯ Expiresï¼š å“åº”å¤´åŒ…å«æ—¥æœŸ/æ—¶é—´ï¼Œå³åœ¨æ­¤æ—¶å€™ä¹‹åï¼Œå“åº”è¿‡æœŸã€‚å¦‚æœæ˜¯æ— æ•ˆçš„æ—¥æœŸä»£è¡¨èµ„æºå·²ç»è¿‡æœŸã€‚ Cache-Controlï¼šé€šè¿‡æŒ‡å®šæŒ‡ä»¤æ¥å®ç°ç¼“å­˜æœºåˆ¶ï¼Œç¼“å­˜æŒ‡ä»¤æ˜¯å•å‘çš„ã€‚æ¯”å¦‚Cache-Control: max-age=30ä»£è¡¨è¯¥èµ„æºå¯ä»¥ç¼“å­˜çš„30ç§’ï¼Œmax-ageçš„ä¼˜å…ˆçº§å°†é«˜äºExpiresã€‚ å®è·µæµè§ˆå™¨ç¼“å­˜åœ¨çŸ¥é“äº†ç¼“å­˜å¤´éƒ¨çš„ä½œç”¨åï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€äº›ä»£ç æ¥å®è·µä¸€ä¸‹è®©æµè§ˆå™¨ç¼“å­˜æˆ‘ä»¬çš„æ•°æ®ã€‚ ç”±äºä½¿ç”¨Javaä»£ç å¯åŠ¨ä¸€ä¸ªHTTPæœåŠ¡å™¨è¿˜éœ€è¦ç»è¿‡ç¼–è¯‘è¿‡ç¨‹å¤ªè¿‡éº»çƒ¦ï¼Œå› æ­¤è¿™é‡Œé‡‡ç”¨Nodejsæ¥å®ç°ç¼“å­˜ç¤ºä¾‹ const PORT = 3030; const CACHE_SECONDS = 10; // åŠ è½½httpæ¨¡å— var http = require('http'); // åˆ›å»ºhttpæœåŠ¡å™¨ var server = http.createServer(function (req, res) { if (req.url === '/test.js') { // è®¾ç½®ç¼“å­˜å“åº”å¤´éƒ¨ res.setHeader('Cache-Control', `max-age=${CACHE_SECONDS}, public`); res.end(`document.body.append('Load script test.js on ${new Date()}')`) } else { // é¦–é¡µåŠ è½½ test.js è„šæœ¬ res.end(`&lt;html&gt;&lt;body&gt;&lt;h1&gt;Script will cache ${CACHE_SECONDS} seconds&lt;/h1&gt;&lt;/body&gt;&lt;script src=&quot;http://localhost:${PORT}/test.js&quot;&gt;&lt;/script&gt;&lt;/html&gt;`); } }) server.listen(PORT) console.log(`Listening in http://localhost:${PORT}`) è¿™æ®µä»£ç å¯ä»¥æ‹·è´åˆ°æœ‰Nodejsç¯å¢ƒçš„æœºå™¨ä¸­ä½¿ç”¨node xxx.jsç›´æ¥è¿è¡Œï¼Œå®ƒä¸»è¦åšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ…: ç›‘å¬3030ç«¯å£å¯åŠ¨äº†ä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œé»˜è®¤æä¾›äº†ä¸€ä¸ªHTMLé¡µé¢ï¼Œè¯¥é¡µé¢é€šè¿‡scriptæ ‡ç­¾åŠ è½½äº†test.jsè„šæœ¬ã€‚ å½“è®¿é—®test.jsè„šæœ¬æ—¶è®¾ç½®äº†Cache-Control: max-age=10, publicå“åº”å¤´éƒ¨ï¼Œå³å…è®¸æµè§ˆå™¨ç¼“å­˜è¯¥èµ„æº10ç§’ã€‚ test.jsè„šæœ¬å‘é¡µé¢å†™å…¥äº†ä¸€è¡Œå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åŒ…å«äº†æœåŠ¡å™¨å“åº”è„šæœ¬çš„æ—¶é—´new Date()ã€‚ ç°åœ¨æˆ‘ä»¬é€šè¿‡æµè§ˆå™¨æµ‹è¯•ä¸€ä¸‹ç¼“å­˜å¤´éƒ¨æ˜¯å¦ç”Ÿæ•ˆï¼Œè¿è¡Œè„šæœ¬æ–‡ä»¶ååœ¨æµè§ˆå™¨æ‰“å¼€http://localhost:3030å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¾ç¤ºåŠ è½½è„šæœ¬çš„æ—¶é—´æ˜¯14:12:13ï¼Œç°åœ¨æˆ‘ä»¬åç§’å†…åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œè¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚ è¿™é‡Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºæ•ˆæœä¸Šæ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯ç½‘ç»œç›‘æ§æ–¹é¢æ˜¾ç¤ºè„šæœ¬æ˜¯ä»ç¼“å­˜ä¸­è·å–(from memory cache)ï¼Œç°åœ¨æˆ‘ä»¬é™å€™ä¸€æ®µæ—¶é—´å†ç‚¹å‡»åˆ·æ–°ï¼Œè„šæœ¬ç¼“å­˜å¤±æ•ˆé‡æ–°ä»æœåŠ¡å™¨ä¸Šè·å–äº†æœ€æ–°èµ„æºï¼Œæ—¶é—´å˜æˆäº†14:12:45ï¼Œè¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚ æœ‰å…³å…¶ä»–çš„ç¼“å­˜å¤´éƒ¨å¯ä»¥æ ¹æ®ç›¸åŒçš„æ–¹å¼è¿›è¡Œæµ‹è¯•ï¼Œå¤šåŠ¨æ‰‹å¯¹è‡ªå·±ç†è§£è¿™äº›HTTPå“åº”å¤´éƒ¨ä»¥åŠåè®®ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚ CDNä¸­çš„ç¼“å­˜ä¸ºä»€ä¹ˆCDNç¼“å­˜è¦å’Œæµè§ˆå™¨ç¼“å­˜æ”¾ä¸€èµ·è¯´å‘¢ï¼Ÿå› ä¸ºå®ƒä»¬éƒ½æ˜¯ä¸ºäº†æé«˜ç½‘é¡µè®¿é—®é€Ÿåº¦è€Œè®¾è®¡çš„ã€‚æµè§ˆå™¨ç¼“å­˜æ˜¯æé«˜äº†é¢‘ç¹è¯·æ±‚èµ„æºçš„é€Ÿåº¦ï¼ŒCDNç¼“å­˜æé«˜äº†å•æ¬¡è¯·æ±‚èµ„æºçš„é€Ÿåº¦ã€‚ CDNæ˜¯ä»€ä¹ˆCDNæ˜¯Content Delivery Networkçš„ç®€ç§°ï¼Œå³â€œå†…å®¹åˆ†å‘ç½‘ç»œâ€çš„æ„æ€ã€‚ä¸€èˆ¬æˆ‘ä»¬æ‰€è¯´çš„CDNåŠ é€Ÿï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘ç«™åŠ é€Ÿæˆ–è€…ç”¨æˆ·ä¸‹è½½èµ„æºåŠ é€Ÿã€‚ é‚£ä¹ˆå®ƒå¦‚ä½•åšåˆ°åŠ é€Ÿæ•ˆæœå‘¢ï¼Ÿ å°±è¿‘è®¿é—®åŸåˆ™ï¼Œå°±å¦‚åŒä½ æ‰¾æ°´ç”µç‡ƒæ°”çš„ç¼´è´¹ç‚¹ï¼Œç”±äºå„ä¸ªç¼´è´¹ç‚¹æä¾›çš„æœåŠ¡æ˜¯ä¸€æ ·çš„ï¼Œä½ è‚¯å®šä¼šé€‰æ‹©ç¦»ä½ æœ€è¿‘çš„æœåŠ¡ç‚¹è¿›è¡Œç¼´è´¹ã€‚åŒç†åœ¨è®¿é—®ç½‘é¡µæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®å®¢æˆ·æœºçš„ä½ç½®ï¼Œä¸ºå®ƒé€‰æ‹©ä¸€ä¸ªæœ€è¿‘çš„æœåŠ¡èŠ‚ç‚¹æä¾›èµ„æºæœåŠ¡ï¼Œå¯»æ‰¾æœ€è¿‘æœåŠ¡èŠ‚ç‚¹çš„è¿™ä¸ªè¿‡ç¨‹å°±å«åšCDNåŠ é€Ÿã€‚ CDNå·¥ä½œåŸç†äº†è§£CDNçš„å·¥ä½œåŸç†ä¹‹å‰æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿç½‘ç«™çš„è®¿é—®è¿‡ç¨‹ æµè§ˆå™¨è¾“å…¥chenjianhui.site æµè§ˆå™¨è¯·æ±‚DNSæœåŠ¡å™¨ï¼ŒæŸ¥è¯¢åˆ°chenjianhui.siteå¯¹åº”æœåŠ¡å™¨çš„IP å‘è¯¥æœåŠ¡å™¨å‘èµ·HTTPè¯·æ±‚å¾—åˆ°ç½‘é¡µã€åŠ è½½å…¶ä»–å†…å®¹ã€æ¸²æŸ“é¡µé¢ç­‰ç­‰ï¼ˆè¿™é‡Œç®€ç•¥äº†ä¸€äº›ä¸œè¥¿ã€æ¯”å¦‚æˆ‘ä»¬ä¸Šé¢èŠåˆ°çš„æµè§ˆå™¨ç¼“å­˜ï¼‰ è¿™é‡Œéœ€è¦é‡ç‚¹è®²ä¸€ä¸‹ç¬¬2æ­¥ï¼Œå› ä¸ºCNDå°±æ˜¯åœ¨è¿™ä¸€æ­¥åšäº†æ–‡ç« ï¼Œå…¶å…·ä½“è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š chenjianhui.siteè§£ææˆIPçš„å…·ä½“è¿‡ç¨‹ æ“ä½œç³»ç»ŸæŸ¥è¯¢æœ¬åœ°ç¼“å­˜ï¼ˆhostæ–‡ä»¶æˆ–è€…æ˜¯æµè§ˆå™¨çš„ç¼“å­˜ï¼‰æ˜¯å¦æœ‰è§£æè®°å½•ï¼Œæœ‰åˆ™ç›´æ¥ä½¿ç”¨ï¼Œæ²¡æœ‰åˆ™è¿›å…¥ç¬¬2æ­¥ æ“ä½œç³»ç»Ÿå‘LocalDNSæŸ¥è¯¢åŸŸåçš„IPåœ°å€ï¼Œä¸€èˆ¬ç§°è¿è¥å•†çš„DNSæœåŠ¡å™¨ä¸ºLocalDNSï¼Œè¿™é‡ŒLocalDNSä¼šå…ˆæŸ¥è¯¢æœ¬åœ°ç¼“å­˜ï¼Œæ²¡æœ‰åˆ™è¿›å…¥ç¬¬3æ­¥ LocalDNSå‘RootDNSæŸ¥è¯¢å¾—åˆ°æƒå¨æœåŠ¡å™¨ï¼Œä¼ è¯´ä¸­å…¨çƒåªæœ‰å‡ å°çš„é‚£äº›æœåŠ¡å™¨ç§°ä¹‹ä¸ºRootDNS LocalDNSå‘æƒå¨æœåŠ¡å™¨æŸ¥è¯¢IPåœ°å€ï¼Œç¼“å­˜è¿™ä¸ªåœ°å€å¹¶å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ CDNå…¶å®å°±æ˜¯ä½œç”¨äºåŸŸåè§£æçš„ç¬¬4æ­¥ï¼Œä¼ ç»Ÿçš„ç½‘ç«™ç¬¬4æ­¥æ˜¯è¿”å›ä¸€ä¸ªIPåœ°å€ï¼Œè€ŒåŠ å…¥CDNåè¿™é‡Œä¸€èˆ¬è¿”å›ä¸€ä¸ªCNAMEè®°å½• è¿™é‡Œè¦è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå¸¸è§çš„DNSè§£æè®°å½•æœ‰Aï¼ŒAAAAï¼ŒCNAMEç­‰ç­‰ï¼Œå…¶ä¸­ Aè®°å½•æ˜¯åŸŸååˆ°IPV4åœ°å€çš„ AAAAè®°å½•æ˜¯åŸŸååˆ°IPV6åœ°å€çš„ CNAMEè®°å½•æ˜¯åŸŸååˆ°åŸŸåçš„ï¼Œå³ä½ å»é—®é—®è¿™ä¸ªåŸŸåï¼Œä»–çŸ¥é“è¯¥è§£ææˆä»€ä¹ˆ LocalDnså¾—åˆ°ä¸€ä¸ªCNAMEè®°å½•ï¼Œå‘æ™ºèƒ½è°ƒåº¦DNSæŸ¥è¯¢åŸŸåçš„ipåœ°å€ æ™ºèƒ½è°ƒåº¦DNS æ ¹æ®ä¸€å®šçš„ç®—æ³•å’Œç­–ç•¥(æ¯”å¦‚é™æ€æ‹“æ‰‘ï¼Œå®¹é‡ç­‰)ï¼Œå°†æœ€é€‚åˆçš„CDNèŠ‚ç‚¹IPåœ°å€å›åº”ç»™LocalDns å‚è€ƒèµ„æ–™ MDN ETag MDN Last-Modified MDN Cache-Control CDNçš„åŸç†ä»¥åŠå…¶ä¸­çš„ä¸€äº›æŠ€æœ¯ å…³äºå…¬ä¼—å·","link":"/2020-01-07-cache-opening/"},{"title":"éšç¬”â€”â€”å¦‚ä½•æ‰“é€ ä¸€ä¸ªå®‰å…¨çš„ç³»ç»Ÿ","text":"&emsp;&emsp;ä½œä¸ºä¸€ä¸ªåœ¨ä¸»æ‰“ç½‘ç»œå®‰å…¨ç³»å…¬å¸å®ä¹ è¿‡çš„äººï¼Œä¸å¾—ä¸äº†è§£ä¸‹ç³»ç»Ÿå®‰å…¨è®¾è®¡ç›¸å…³çš„çŸ¥è¯†ï¼Œæœ¬ç¯‡åšå®¢å°†ä»¥ä¸€ä¸ªè™šæ‹Ÿçš„éœ€æ±‚å¼€å§‹ï¼Œå°è¯•ä»¥è®²ç³»ç»Ÿè®¾è®¡è€…é˜¿è¾‰ä¸é»‘å®¢å°åˆ˜äº’ç›¸åšå¼ˆçš„æ•…äº‹ï¼Œè¿™æ ·çš„æ–¹å¼å»è®©å¤§å®¶å­¦ä¹ åˆ°æˆ‘äº†è§£åˆ°çš„ç½‘ç»œå®‰å…¨ã€‚ è™šæ‹Ÿçš„éœ€æ±‚\b\b2018å¹´3æœˆæŸæ—¥ä½äºGåŸçš„ä¸€ä¸ªä¸‹åˆï¼Œå…¬å¸é¢†å¯¼æ‹è„‘è¢‹æƒ³å‡ºäº†ä¸€ä¸ªéœ€æ±‚ï¼Œç»è¿‡äº†ä¸‰ä¸ªå°æ—¶çš„å¼€ä¼šè®¨è®ºï¼Œç³»ç»Ÿçš„åŠŸèƒ½æ¨¡å—ç¡®å®šäº†ï¼Œåå­—å°±å«å¼±é¸¡æŒä¸Šç”Ÿæ´»APPï¼Œä¸‹é¢æ˜¯å®ƒçš„åŠŸèƒ½æ¨¡å—å›¾ éœ€æ±‚æ€»ç»“æ¥è¯´å¾ˆç®€å• å¹³å°å®¢æˆ·ä½¿ç”¨æ­¤å¹³å°è¿›è¡Œç”Ÿæ´»ç¼´è´¹ å¹³å°æœåŠ¡äººå‘˜å—ç†å®¢æˆ·çš„æœåŠ¡ï¼Œå¹¶åœ¨æ¯ä¸ªæœˆåº•è¿›è¡Œå¯¹è´¦\b\b é‚£æ—¢ç„¶æ˜¯æœ‰ç®¡ç†å¹³å°çš„ç³»ç»Ÿè‚¯å®šå°‘ä¸äº†æƒé™ï¼Œä½œä¸ºä¸€ä¸ªå®¢æˆ·æœåŠ¡äººå‘˜è‚¯å®šä¸èƒ½å‚ä¸å¯¹è´¦å§ï¼Œæ‰€ä»¥é˜¿è¾‰å…ˆå¼€å§‹äº†æƒé™ç›¸å…³çš„è®¾è®¡ï¼Œä¸šåŠ¡æ–¹é¢å§”æ´¾ç»™äº†å¤§è¶…ã€‚ ç³»ç»Ÿæƒé™è®¾è®¡å¼€å§‹æƒé™è®¾è®¡ä¹‹å‰é˜¿è¾‰å…ˆäº†è§£äº†ä¸€ä¸‹æƒé™è®¾è®¡çš„ç›¸å…³çŸ¥è¯†ï¼Œè¯´åˆ°æƒé™å°±ç¦»ä¸å¼€æƒé™è®¾è®¡çš„åŸåˆ™ä»¥åŠRBACçš„è®¾è®¡æ–¹å¼ã€‚ æƒé™è®¾è®¡çš„åŸåˆ™ æœ€å°ç‰¹æƒåŸåˆ™ï¼šç”¨æˆ·åœ¨å®ŒæˆæŸä¸ªä»»åŠ¡æ—¶ï¼Œå…¶å¾—åˆ°çš„æƒé™ä¸åº”è¯¥å¤§äºå®Œæˆè¯¥ä»»åŠ¡æ‰€éœ€è¦çš„æœ€å°æƒé™ã€‚ èŒè´£åˆ†ç¦»åŸåˆ™ï¼šæƒé™åˆ†é…æ—¶è¦è€ƒè™‘æƒé™äº’æ–¥çš„æƒ…å†µï¼Œå¦‚æ–‡ç« çš„åˆ›å»ºä¸å®¡æ ¸æƒé™å¦‚æœè¢«ä¸€ä¸ªç”¨æˆ·åŒæ—¶æ‹¥æœ‰ï¼Œé‚£ä¹ˆå°†ä¼šå‡ºç°è‡ªåŠ¨å®¡æ ¸çš„æƒ…å†µã€‚ æ•°æ®æŠ½è±¡åŸåˆ™ï¼šæƒé™è®¾è®¡æ—¶ä¸å•çº¯çš„ä»¥å¯¹æ•°æ®çš„å¢åˆ æ”¹æŸ¥æ“ä½œæ¥å®šä¹‰æƒé™ï¼Œéœ€è¦ç»“åˆä¸šåŠ¡åœºæ™¯æ¥å®šä¹‰æƒé™ï¼Œå¦‚æ”¿åºœç”³æŠ¥å•å®¡æ ¸çš„åˆå®¡ã€å¤å®¡ã€ç»ˆå®¡ä¸šåŠ¡åº”è¯¥å®šä¹‰æˆä¸‰ä¸ªæƒé™ï¼Œä½¿å…¶ç²’åº¦æ›´åŠ åˆç†ã€‚ ä»€ä¹ˆæ˜¯RBAC åœ¨20ä¸–çºª90å¹´ä»£æœŸé—´ï¼Œå¤§é‡çš„ä¸“å®¶å­¦è€…å’Œä¸“é—¨ç ”ç©¶å•ä½å¯¹RBACçš„æ¦‚å¿µè¿›è¡Œäº†æ·±å…¥ç ”ç©¶ï¼Œå…ˆåæå‡ºäº†è®¸å¤šç±»å‹çš„RBACæ¨¡å‹ï¼Œå…¶ä¸­ä»¥ç¾å›½George Masonå¤§å­¦ä¿¡æ¯å®‰å…¨æŠ€æœ¯å®éªŒå®¤ï¼ˆLISTï¼‰æå‡ºçš„RBAC96æ¨¡å‹æœ€å…·æœ‰ç³»ç»Ÿæ€§ï¼Œå¾—åˆ°æ™®éçš„å…¬è®¤ RBACæ¨¡å‹æ˜¯webæƒé™è®¾è®¡é¢†åŸŸä¸­ä¸€ä¸ªæˆç†Ÿçš„ç†è®ºæ–¹æ¡ˆï¼Œå®ƒå…¨ç§°ä¸ºRole-Based Access Controlå³ä»¥è§’è‰²ä¸ºåŸºç¡€çš„è®¿é—®æ§åˆ¶ï¼Œå…¶è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³å³å°†è§’è‰²ã€ç”¨æˆ·ã€æƒé™å…³è”èµ·æ¥ï¼Œç³»ç»Ÿå¯ä»¥æ ¹æ®ä¸åŒçš„è´¦å·è·å¾—èƒŒåçš„è§’è‰²ï¼Œè¿›è€Œä»è§’è‰²ä¸­è·å–æƒé™ä¿¡æ¯æ¥åˆ¤æ–­æ˜¯å¦æœ‰æŸäº›èµ„æºçš„è®¿é—®æƒé™ã€‚ é‚£RBACè§£å†³äº†ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿæ— è§’è‰²æ¦‚å¿µçš„æƒé™è®¾è®¡ï¼Œç”¨æˆ·è¢«ç›´æ¥æˆäºˆæƒé™çš„ç¼ºç‚¹ã€‚ æƒé™é…ç½®ç›¸å½“éº»çƒ¦ æ— æ³•å¿«é€Ÿä¸ºå¤šä¸ªç”¨æˆ·æ‰¹é‡åˆ é™¤/ç¼–è¾‘æƒé™ ç”¨æˆ·å¤šèº«ä»½ä¸‹æƒé™é…ç½®ç»´æŠ¤éº»çƒ¦ è€ŒRBACä¸ä»…è§£å†³äº†ä¼ ç»Ÿæƒé™è®¾è®¡çš„ç¼ºç‚¹ï¼Œè¿˜æ”¯æŒäº†æƒé™è®¾è®¡çš„ä¸‰ä¸ªåŸåˆ™ æœ€å°ç‰¹æƒåŸåˆ™ï¼šRBACæ¨¡å‹å¯ä»¥é€šè¿‡æˆäºˆè§’è‰²æƒé™çš„å¤šå°‘ä¸å¤§å°æ¥å†³å®šç”¨æˆ·æ‹¥æœ‰çš„ç‰¹æƒï¼Œç”¨æˆ·å¾—åˆ°çš„æƒé™ä¸åº”è¯¥å¤§äºå®ŒæˆæŸä»»åŠ¡æ‰€éœ€è¦çš„æƒé™ã€‚ èŒè´£åˆ†ç¦»åŸåˆ™ï¼šRBACæ¨¡å‹å¯é€šè¿‡æŒ‡æ´¾äº’æ–¥çš„è§’è‰²å®ŒæˆåŒä¸€ä¸ªä»»åŠ¡ã€‚ æ•°æ®æŠ½è±¡åŸåˆ™ï¼šRBACæ¨¡å‹çš„æƒé™å®ä½“å³å¯æŠ½è±¡æˆè®¸å¯æƒï¼Œå…¶æ”¯æŒçš„æŠ½è±¡ç¨‹åº¦ä¸æ¨¡å‹çš„å®ç°ç»†èŠ‚æœ‰å…³ã€‚ ä»€ä¹ˆæ˜¯RBAC96æ¨¡å‹RBAC96åŒ…æ‹¬RBAC0~RBAC3å››ä¸ªæ¦‚å¿µæ€§æ¨¡å‹ï¼Œåœ¨è¿™é‡Œåˆ†åˆ«ä»‹ç»ä¸€ä¸‹ RBAC0ç¬¦åˆRBACæ¦‚å¿µç³»ç»Ÿçš„æœ€ä½è¦æ±‚RBAC0æŒ‡å‡ºäº†è§’è‰²ï¼Œç”¨æˆ·ï¼Œè®¿é—®æƒé™å’Œä¼šè¯çš„å…³ç³»ï¼Œç”¨æˆ·è‡³å°‘åŒ…å«ä¸€ä¸ªè§’è‰²ï¼Œè§’è‰²è‡³å°‘åŒ…å«ä¸€ä¸ªæƒé™ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥æ¿€æ´»å¤šä¸ªè§’è‰²ï¼Œç”¨æˆ·ã€è§’è‰²ã€æƒé™å‡æ˜¯å¤šå¯¹å¤šçš„å…³ç³» RBAC1åœ¨RBAC0çš„åŸºç¡€ä¸Šå¢åŠ äº†è§’è‰²ç»§æ‰¿çš„å…³ç³»RBAC1å®šä¹‰äº†ä¸€ä¸ªè§’è‰²å¯ä»¥è·å¾—å¦ä¸€ä¸ªè§’è‰²çš„æƒé™ç»§æ‰¿æƒï¼Œåœ¨æœ‰ä¸Šä¸‹çº§çš„æœºæ„ä½“ç³»ä¸­æ­¤æ¨¡å‹å¯é€‚ç”¨ RBAC2åœ¨RBAC0çš„åŸºç¡€ä¸Šå¼•å…¥äº†SSDå’ŒDSDRBAC2é™åˆ¶äº†æƒé™æˆäºˆæ“ä½œçš„é™åˆ¶æ€§ï¼Œé˜²æ­¢ç”¨æˆ·æ‹¥æœ‰æ¦‚å¿µä¸Šäº’æ–¥çš„æƒé™ï¼Œå¦‚ä¸Šæ–‡è¯´åˆ°çš„æ–‡ç« åˆ›å»ºä¸å®¡æ ¸æƒé™ã€‚ SSD(Static Separation of Duty)é™æ€èŒè´£åˆ†ç¦» äº’æ–¥è§’è‰²è§„åˆ™ï¼šåŒä¸€ä¸ªç”¨æˆ·åœ¨ä¸¤ä¸ªäº’æ–¥çš„è§’è‰²ä¸­åªèƒ½é€‰æ‹©ä¸€ä¸ª åŸºæ•°è§„åˆ™ï¼šä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰çš„è§’è‰²æ˜¯æœ‰é™çš„ï¼Œä¸€ä¸ªè§’è‰²æ‹¥æœ‰çš„æƒé™ä¹Ÿæ˜¯æœ‰é™çš„ å…ˆå†³è§„åˆ™ï¼šç”¨æˆ·æƒ³è·å¾—é«˜çº§çš„è§’è‰²ï¼Œé¦–å…ˆå¿…é¡»æ‹¥æœ‰ä½çº§çš„è§’è‰² DSD(Dynamicâ€¦)åŠ¨æ€èŒè´£åˆ†ç¦» è¿è¡Œæ—¶äº’æ–¥è§„åˆ™ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥æ‹¥æœ‰ä¸¤ä¸ªè§’è‰²ï¼Œä½†è¿è¡Œæ—¶åªèƒ½æ¿€æ´»ä¸€ä¸ªè§’è‰² RBAC3æ˜¯RBAC1å’ŒRBAC2çš„é›†åˆ æ”¯æŒRBACçš„ä¸»æµæ¡†æ¶ Shiro Spring Security åœ¨å¯¹æ¯”äº†ä¸¤è€…çš„ä¼˜ç¼ºç‚¹åï¼Œé˜¿è¾‰å‡­ç€å¯¹Springçš„äº²åˆ‡æ„Ÿé€‰æ‹©äº†Spring Securityï¼Œæ ¹æ®å®˜æ–¹çš„æ–‡æ¡£æè¿°é˜¿è¾‰å¾ˆå¿«å°±å®Œæˆäº†æƒé™ç›¸å…³çš„è®¾è®¡ï¼Œç»“åˆå¤§è¶…å¼€å‘çš„è¯è´¹å……å€¼åŠŸèƒ½å¼±é¸¡APPå¿«é€Ÿä¸Šçº¿äº†ã€‚ ç³»ç»Ÿå®‰å…¨é˜²æŠ¤é»‘å®¢å°åˆ˜åœ¨ä¸€ä¸ªé˜³å…‰æ˜åªšçš„ä¸‹åˆï¼Œå¼ ä¸‰åœ¨æŸä¸çŸ¥åå¥¶èŒ¶åº—è¿ç€wifiæ‚ é—²çš„å–ç€å¥¶èŒ¶ï¼Œçªç„¶æ”¶åˆ°ä¸€æ¡æ‰‹æœºä½™é¢åªå‰©3æ¯›çš„æ¬ è´¹æé†’ï¼Œ\b\bå¼ ä¸‰ç¬¬ä¸€æ—¶é—´æƒ³åˆ°äº†å¼±é¸¡APPï¼Œç†Ÿç»ƒçš„æ‰“å¼€å®ƒå¹¶å®Œæˆäº†ä¸€ç¬”è¯è´¹å……å€¼ï¼Œæ­¤æ—¶æ‰‹æœºå‘å‡ºäº†ä¸€æ¡HTTPè¯·æ±‚å¦‚ä¸‹ POST /service/call/charge HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache Access-Token: 56ad9e8e-e404-5f6a-a7d3-a3125583f2cc {&quot;mobile&quot;:&quot;13312123312&quot;,&quot;amount&quot;:50} å¦ä¸€è¾¹é»‘å®¢å°åˆ˜å·²åœ¨æ­¤ç­‰å€™å¤šæ—¶ï¼Œä»–æ—©å·²ç»æ§åˆ¶äº†å¥¶èŒ¶åº—çš„wifiï¼Œå¹¶ä¸æ–­çš„æˆªè·å‘å¾€å…¬ç½‘çš„è¯·æ±‚å†…å®¹ï¼Œä¸“ä¸šçš„å°åˆ˜æ•é”çš„æ•æ‰åˆ°å¼ ä¸‰çš„è¿™ä¸ªè¯·æ±‚ä¸ä¸€èˆ¬ï¼Œä»–å°è¯•ç€ä¿®æ”¹è¯·æ±‚å†…å®¹ä¸º POST /service/call/charge HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache Access-Token: 56ad9e8e-e404-5f6a-a7d3-a3125583f2cc {&quot;mobile&quot;:&quot;17477212341&quot;,&quot;amount&quot;:300} ä¸å¤šä¹…ï¼Œå°åˆ˜æœ‹å‹çš„æ‰‹æœºæ˜¾ç¤ºè¯è´¹åˆ°è´¦300å…ƒï¼Œå°åˆ˜å¿ƒå–œæ‰¾åˆ°å¼±é¸¡APPçš„ä¸€ä¸ªæ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ç»™åˆ«äººå……è¯è´¹ç„¶åè‡ªå·±æ”¶å–éƒ¨åˆ†è´¹ç”¨ï¼Œç”±æ­¤è¿å¨¶ç™½å¯Œç¾èµ°ä¸Šäººç”Ÿå·…å³°ï¼ ä¸‰å¤©åå¼±é¸¡APPæ”¶åˆ°è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·æŠ•è¯‰ï¼Œç¨‹åºå‘˜å¤§è¶…æ£€æŸ¥æ—¥å¿—å‘ç°äº†è‡ªå·±ç³»ç»Ÿå­˜åœ¨è¯·æ±‚èƒ½è¢«ç¯¡æ”¹çš„æ¼æ´ï¼Œè¿™å¯ä¸å¾—äº†ï¼Œå¤§è¶…ç«‹é©¬å»å’¨è¯¢è€å¤§é˜¿è¾‰è¯¥æ€ä¹ˆè§£å†³ï¼Ÿé˜¿è¾‰çŸ¥æ™“åï¼Œå®‰æ…°äº†å¤§è¶…æ²¡å…³ç³»ï¼Œé—®é¢˜å‘ç°å¾—æ—©ï¼ŒæŸå¤±è¿˜ä¸æ˜¯å¾ˆä¸¥é‡ï¼Œç„¶åå¼€é™¤äº†å¤§è¶…ï¼Œå¼€å§‹äº†å¼±é¸¡APPçš„ä¿®å¤ä¹‹è·¯ã€‚ æ¥å£é˜²ç¯¡æ”¹è®¾è®¡é˜¿è¾‰ä¸ºäº†é˜²æ­¢æ¥å£è¢«ç¯¡æ”¹ï¼Œå¼•å…¥äº†å‚æ•°ç­¾åçš„æ¦‚å¿µ å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çº¦å®šäº†ä¸€ä¸ªå­—ç¬¦ä¸²ABBACCï¼Œå‚ä¸ç­¾åç®—æ³• å®¢æˆ·ç«¯å‘é€ç½‘ç»œè¯·æ±‚ä¹‹å‰ä½¿ç”¨MD5ç®—æ³•å¯¹å‚æ•°ä½“+ABBACCåšä¸€æ¬¡å“ˆå¸Œå¾—åˆ°ç­¾åå€¼signatureï¼Œæ”¾åˆ°è¯·æ±‚çš„queryéƒ¨åˆ†å‘å¾€æœåŠ¡å™¨ æœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚ååŒæ ·ä½¿ç”¨MD5ç®—æ³•å¯¹å‚æ•°ä½“+ABBACCåšä¸€æ¬¡å“ˆå¸Œå¾—åˆ°ç­¾åå€¼ï¼Œå¹¶æ ¸å¯¹queryéƒ¨åˆ†çš„ç­¾åå€¼ï¼ŒåŒ¹é…åˆ™ä»£è¡¨è¯·æ±‚æœªè¢«ç¯¡æ”¹ äºæ˜¯è¯è´¹å……å€¼æ¥å£çš„è¯·æ±‚ä½“å˜æˆäº†å¦‚ä¸‹ç¤ºä¾‹ï¼Œåªè¦çº¦å®šå­—ç¬¦ä¸²ABBACCä¸æ³„æ¼ï¼Œç†è®ºä¸Šè¯·æ±‚æ˜¯ä¸å¯ç¯¡æ”¹çš„ POST /service/call/charge?signature=BB9BBD082F5C05B5BBC8BF7F6A59FD72 HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache Access-Token: 572caf12-b62e-b3ce-c969-b36ebe165078 {&quot;mobile&quot;:&quot;13312123312&quot;,&quot;amount&quot;:50} é˜¿è¾‰çš„æ€è€ƒğŸ¤”é»‘å®¢å°åˆ˜çš„äº‹ä»¶å‘ç”Ÿåï¼Œé˜¿è¾‰æ„è¯†åˆ°å®¢æˆ·çš„ç½‘ç»œå¤§éƒ¨åˆ†æƒ…å†µä¸èƒ½ä¿è¯æ˜¯åœ¨ä¸€ä¸ªå®‰å…¨çš„ç¯å¢ƒè¿è¡Œï¼Œå®¢æˆ·åœ¨å¼±é¸¡APPä¸Šçš„æ“ä½œæœ€ç»ˆä¹Ÿåªä¸è¿‡æ˜¯è½¬æ¢æˆä¸€å †æŠ¥æ–‡åœ¨ç½‘ç»œä¸Šä¼ é€’ï¼Œè¦è·å–è¿™äº›æŠ¥æ–‡ç®€ç›´è½»è€Œæ˜“ä¸¾ã€‚æƒ³åˆ°è¿™é‡Œé˜¿è¾‰å¼€å§‹æŠŠè‡ªå·±å½“æˆä¸€ä¸ªé»‘å®¢ï¼Œæ¥å¯»æ‰¾è‡ªå·±å¼±é¸¡APPçš„æ¼æ´ã€‚ tokenç›—ç”¨ä¸é‡æ”¾æ”»å‡»æ•é”çš„é˜¿è¾‰æ²¡è¿‡å¤šä¹…å°±å‘ç°å¼±é¸¡APPè¿˜å­˜åœ¨ä¸€äº›è‡´å‘½çš„æ¼æ´ï¼Œç”±äºç³»ç»Ÿæ˜¯é’ˆå¯¹APPæä¾›æœåŠ¡ï¼ŒAPPä¸åƒç½‘é¡µç«¯æœ‰cookie-sessionæœºåˆ¶å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯ä½¿ç”¨tokenæ¥é‰´åˆ«ç”¨æˆ·ï¼Œä¸”å¼±é¸¡APPä¸ºäº†æé«˜ç”¨æˆ·ä½“éªŒå°†tokençš„æœ‰æ•ˆæœŸè®¾ç½®çš„å¾ˆé•¿ï¼Œé˜²æ­¢ç”¨æˆ·ç»å¸¸éœ€è¦ç™»å½•ï¼Œè¿™å°±å­˜åœ¨ç”¨æˆ·tokençš„ç›—ç”¨é—®é¢˜ã€‚ é»‘å®¢é€šè¿‡æ§åˆ¶wifiæŠ“å–å¼±é¸¡APPçš„ç½‘ç»œè¯·æ±‚ åˆ†æè¯·æ±‚å†…å®¹å¾ˆå®¹æ˜“æ‰¾åˆ°ä»¤ç‰Œä½ç½® ä½¿ç”¨ä»¤ç‰Œä¼ªè£…æˆç”¨æˆ·å¹²å…¶ä»–äº‹æƒ… ä¸tokenç›—ç”¨åŒæ—¶å­˜åœ¨çš„è¿˜æœ‰é‡æ”¾æ”»å‡»é—®é¢˜ï¼Œé»‘å®¢å¯ä»¥é€šè¿‡é‡æ–°å‘é€å¼ ä¸‰çš„è¯è´¹å……å€¼è¯·æ±‚ï¼Œäº²åˆ‡çš„å¸®å…¶å¤šå……å‡ æ¬¡è¯è´¹ é˜²æ­¢tokenç›—ç”¨é˜²æ­¢tokenç›—ç”¨å³è®©tokençš„æ—¶æ•ˆæ€§é™ä½ï¼Œé—®é¢˜æ¼”å˜æˆå¦‚ä½•å³æ»¡è¶³ç”¨æˆ·èƒ½å¤Ÿé•¿æœŸä¿æŒç™»å½•çŠ¶æ€åˆèƒ½é™ä½tokençš„æ—¶æ•ˆæ€§ï¼Ÿrefresh_tokenå‡ºç°äº†ï¼Œä»åå­—ä¸Šå¾ˆå®¹æ˜“çœ‹å‡ºï¼Œå®ƒæ˜¯ä¸ºåˆ·æ–°tokenè€Œå­˜åœ¨çš„tokenï¼Œè¿™ä¹ˆè¯´å…¶å®æœ‰ç‚¹ç»•ï¼Œæ€»ç»“å®ƒä¸æ™®é€štokençš„åŒºåˆ«æ˜¯ æ—¶æ•ˆæ€§æ¯”tokené•¿å¾ˆå¤š ç”¨äºtokenå¤±æ•ˆåçš„æ›´æ–°æ“ä½œå‡­è¯ ç°åœ¨é˜¿è¾‰æŠŠtokençš„æ—¶æ•ˆæ€§è®¾ç½®æˆäº†ä¸€å°æ—¶ï¼Œå½“tokenå¤±æ•ˆæ—¶å°±å‘é€ä¸€ä¸ªè¯·æ±‚æ¥æ¢å–æ–°çš„tokenï¼Œrefresh_tokençš„æ—¶æ•ˆæ€§è®¾ç½®æˆä¸€å‘¨ï¼Œå¦‚æœç”¨æˆ·ä¸€å‘¨æ²¡æœ‰ä½¿ç”¨appåˆ™éœ€è¦é‡æ–°ç™»å½• POST /service/token/refresh?signature=CAB800F028D909F0E0B8B12D11A8FB08 HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache Access-Token: 572caf12-b62e-b3ce-c969-b36ebe165078 {&quot;refresh_token&quot;:&quot;572asc2-a19c-a2de-c719-b36fbe465078&quot;} é˜²æ­¢é‡æ”¾æ”»å‡»ç®€å•æ¥è¯´é˜²æ­¢é‡æ”¾æ”»å‡»å°±æ˜¯è¦è®©æ¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚ä½“åªèƒ½ç”¨ä¸€æ¬¡ï¼Œé˜¿è¾‰å¾ˆå¿«å°±æƒ³åˆ°ä¸€ä¸ªæ–¹æ¡ˆ éšæœºæ•°æ–¹æ¡ˆ \bå®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ç”Ÿæˆä¸€ä¸²éšæœºæ•°æ”¾åˆ°è¯·æ±‚ä½“ä¸­ æœåŠ¡ç«¯ç»´æŠ¤ä¸€ä¸ªéšæœºæ•°æ± ï¼Œæ¯ä¸ªæ”¶åˆ°çš„éšæœºæ•°éƒ½æ”¾åˆ°æ± ä¸­ï¼Œå½“è¯·æ±‚ä½“ä¸­çš„éšæœºæ•°ä¸æ± ä¸­å†²çªæ—¶è®¤ä¸ºæ˜¯é‡å¤è¯·æ±‚ä¸å—ç† æ­¤æ–¹æ¡ˆæœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ç¼ºé™·ï¼Œéšæœºæ•°æ± å°†è¢«æ— é™æ‰©å……ï¼Œç»ˆæœ‰ä¸€æ—¥æ‰€æœ‰è¯·æ±‚éƒ½å°†æ— æ³•å—ç†ï¼Œé˜¿è¾‰æ€è€ƒç‰‡åˆ»æå‡ºäº†ç¬¬äºŒä¸ªæ–¹æ¡ˆ éšæœºæ•°+æ—¶é—´æˆ³æ–¹æ¡ˆ å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ç”Ÿæˆä¸€ä¸²éšæœºæ•°ä¸æ—¶é—´æˆ³æ”¾åˆ°è¯·æ±‚ä½“ä¸­ æœåŠ¡ç«¯å…ˆæ ¡éªŒæ—¶é—´æˆ³ï¼Œä¸æœåŠ¡å™¨æ—¶é—´ç›¸å·®äº”åˆ†é’Ÿåˆ™æ‹’ç»å¤„ç† æ—¶é—´æˆ³æ ¡éªŒé€šè¿‡åˆ™å°†éšæœºæ•°æ”¾ç½®éšæœºæ•°æ± ä¸­ï¼Œå¹¶ç»™æ­¤éšæœºæ•°è®¾ç½®ä¸€ä¸ªäº”åˆ†é’Ÿçš„æœ‰æ•ˆæœŸ å¦‚æœéšæœºæ•°ä¸éšæœºæ•°æ± ä¸­å†²çªæ—¶è®¤ä¸ºæ˜¯é‡å¤è¯·æ±‚ä¸å—ç† ç°åœ¨å……å€¼è¯è´¹çš„è¯·æ±‚å˜æˆäº† POST /service/call/charge?signature=D4E8FEE98427C555135FEAAE258077DE HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache Access-Token: 572caf12-b62e-b3ce-c969-b36ebe165078 {&quot;mobile&quot;:&quot;13312123312&quot;,&quot;amount&quot;:50,&quot;r&quot;:182713,&quot;timestamp&quot;:1576576992917} è‡³æ­¤ï¼Œé»‘å®¢æ— æ³•å†ç¯¡æ”¹æˆ–è€…é‡å¤åˆ©ç”¨æˆªè·çš„ç½‘ç»œæŠ¥æ–‡äº†ï¼Œä½†æ˜¯å¥½æ™¯ä¸é•¿ï¼Œæ²¡è¿‡å¤šä¹…å¼±é¸¡APPçš„å®¢æœæ”¶åˆ°éƒ¨åˆ†ç”¨æˆ·è¢«ç›—å·çš„æŠ•è¯‰ï¼Œé˜¿è¾‰ä¸æ•¢æ€ æ…¢ï¼Œå¾ˆå¿«å°±å‘ç°äº†é—®é¢˜æ‰€åœ¨ æ•°æ®è£¸å¥”é˜¿è¾‰å‘ç°ç°åœ¨çš„è¯·æ±‚ç¡®å®ç¯¡æ”¹ä¸äº†äº†ï¼Œä½†æ˜¯éƒ¨åˆ†æ•æ„Ÿçš„è¯·æ±‚æŠ¥æ–‡æ˜¯åœ¨äº’è”ç½‘ä¸Šâ€è£¸å¥”â€œçš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªç™»å½•è¯·æ±‚ POST /service/login?signature=B1D927521CA28E458C4192CF2090631D HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache {&quot;account&quot;:&quot;zhangsan&quot;,&quot;password&quot;:&quot;zhangsan123456&quot;,&quot;r&quot;:131763,&quot;timestamp&quot;:1576576992917} é»‘å®¢ç¨å¾®åˆ†æä¸€ä¸‹å°±çŸ¥é“è¿™æ˜¯ä¸€ä¸ªè´¦å·ä¸ºzhangsanå¯†ç ä¸ºzhangsan123456çš„ç™»å½•æ“ä½œï¼Œæ¥ä¸‹æ¥é»‘å®¢åªéœ€è¦æ‰“å¼€å¼±é¸¡APPä½¿ç”¨è¯¥è´¦å·å¯†ç è¿›è¡Œç™»å½•å¹¶ä¿®æ”¹å¯†ç å³å¯ä¸è´¹å¹ç°ä¹‹åŠ›ç›—å·ï¼Œè¿™ç§æ•°æ®æ˜æ–‡ä¼ è¾“çš„è¡Œä¸ºå³æ˜¯æ•°æ®è£¸å¥” é‚£ä¹ˆå¦‚ä½•é˜²æ­¢æ•°æ®è£¸å¥”å‘¢ï¼Ÿ ä¼ è¾“åŠ å¯†é˜¿è¾‰ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½çº¦å®šå¥½åŠ å¯†ç®—æ³•å’Œå¯†é’¥ï¼ŒHTTPçš„è¯·æ±‚ä¸å“åº”æŠ¥æ–‡éƒ½ä½¿ç”¨è¿™å¥—åŠ å¯†ç®—æ³•å’Œå¯†é’¥è¿›è¡Œé€šä¿¡ï¼Œå¸¸ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰DESã€3DESã€AESã€RC5ã€RC6ç­‰ï¼Œé˜¿è¾‰é‡‡ç”¨AESç®—æ³•å¹¶ä¸APPç«¯çº¦å®šå¥½äº†å¯†é’¥ä¸ºACMYTEï¼Œç™»å½•è¯·æ±‚æŠ¥æ–‡å˜æˆäº†å¦‚ä¸‹ç¤ºä¾‹ POST /service/login?signature=B1D927521CA28E458C4192CF2090631D HTTP/1.1 Host: app.ruoji.cn Content-Type: application/json Cache-Control: no-cache {&quot;secret&quot;:&quot;6780bfw0YjIh7UoByQEcP8qpBnJPj0lgphVBLEbBsU78D1QwBQ9JMggNaCMArXgH8NKG4x+le2zx+HtXnGKTeGvrrV32hGC5GJhSrxCkQDGJbokCKyzsHTlq+4DO3Bej&quot;} è¿™æ ·é»‘å®¢æˆªè·çš„æŠ¥æ–‡å°±æ— æ³•è¢«ç›´æ¥çœ‹ç©¿äº†ï¼Œé˜¿è¾‰æ”¾å¿ƒçš„å°†è¿™å¥—è®¾è®¡ä¸Šçº¿è¿è¡Œï¼Œä¸¤å¤©åå®¢æœè¿˜æ˜¯åœ¨ä¸æ–­æ”¶åˆ°ç›—å·çš„æŠ•è¯‰ï¼Œé˜¿è¾‰çœ‰å¤´ä¸€ç´§çœ‹æ¥äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œè¿™ä¸ªé»‘å®¢æ˜¯æœ‰ç‚¹æ°´å¹³çš„ã€‚ é˜¿è¾‰ç»è¿‡ä¸€å¤©çš„åˆ†æå¾—å‡ºç»“è®ºï¼Œé»‘å®¢åº”è¯¥æ˜¯åç¼–è¯‘äº†å¼±é¸¡APPçš„æºä»£ç ï¼Œå¾—åˆ°äº†æºç ä¸­å­˜å‚¨çš„çº¦å®šå¯†é’¥ACMYTEï¼Œå¾—åˆ°å¯†é’¥çš„é»‘å®¢åªéœ€è¦ä¸æ–­ä»£å…¥å¸‚é¢ä¸Šçš„åŠ å¯†ç®—æ³•å³å¯è·å¾—æ˜æ–‡ç»“æœã€‚é˜¿è¾‰å¿ƒæƒ³ï¼Œæ—¢ç„¶æŒä¹…åŒ–åœ¨APPç«¯ä¸å®‰å…¨ï¼Œè¦ä¸å†™åœ¨æœåŠ¡ç«¯ç”¨ç½‘ç»œè¯·æ±‚çš„æ–¹å¼ä¸‹å‘åˆ°APPç«¯ï¼Ÿé‚£è¿™ä¸ªè·å–å¯†é’¥çš„è¯·æ±‚è¢«æˆªè·äº†æ€ä¹ˆåŠï¼Ÿç™¾æ€ä¸è§£çš„é˜¿è¾‰è¯·æ•™äº†å¤§å­¦è€å¸ˆé˜¿ç”˜ï¼Œé˜¿ç”˜æç¤ºå¯ä»¥ä½¿ç”¨éå¯¹ç§°å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œé˜¿è¾‰é¡ºç€æ€è·¯å¼€å§‹äº†ä¸‹ä¸€æ­¥çš„é˜²æŠ¤å·¥ä½œã€‚ éå¯¹ç§°å¯†é’¥åŠ å¯†å‡­ç€é˜¿è¾‰å¿«é€Ÿçš„å­¦ä¹ ä¸ç†è§£èƒ½åŠ›ï¼Œå¾ˆå¿«å°±æ­å»ºèµ·äº†ä¸€å¥—åŸºäºéå¯¹ç§°å¯†é’¥åŠ å¯†çš„é€šä¿¡æ–¹å¼ è¿™å¥—ä½“ç³»ä¸‹é»‘å®¢å°±ç®—åç¼–è¯‘äº†APPä¹Ÿæ— æ³•å»ç ´è§£è¯·æ±‚æŠ¥æ–‡ï¼Œä½†é˜¿è¾‰å‘è§‰æ‰€æœ‰çš„æ¥å£å“åº”æ—¶é—´éƒ½å˜æ…¢äº†ä¸å°‘ï¼Œä»”ç»†åˆ†æé˜¿è¾‰æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ï¼Œéå¯¹ç§°å¯†é’¥çš„åŠ è§£å¯†æ•ˆç‡è¾ƒä½ï¼Œé€ æˆäº†è¾ƒå·®çš„ç”¨æˆ·ä½“éªŒã€‚ è¿™ä¸ªé—®é¢˜å¹¶æ²¡æœ‰å›°æ‰°é˜¿è¾‰å¤ªä¹…ï¼Œå¼ºå¤§çš„èä¼šè´¯é€šèƒ½åŠ›è®©ä»–å¾ˆå¿«æ‰¾åˆ°äº†åˆé€‚çš„è§£å†³æ–¹æ¡ˆï¼Œä¸Šè¿°ä¸¤ä¸ªæ–¹æ¡ˆçš„å†²çªç‚¹åœ¨äº å¯¹ç§°å¯†é’¥å­˜åœ¨å¯†é’¥æ³„æ¼é£é™© éå¯¹ç§°å¯†é’¥å­˜åœ¨æ€§èƒ½ä½ä¸‹é—®é¢˜ ä½•ä¸æŠŠä¸¤è€…å–é•¿è¡¥çŸ­ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œå½“å¼±é¸¡APPç™»å½•æ—¶é‡‡ç”¨éå¯¹ç§°å¯†é’¥çš„äº¤äº’æ–¹å¼ï¼ŒæœåŠ¡ç«¯ä¸‹å‘tokençš„åŒæ—¶é™„å¸¦ä¸€ä¸ªä¸å…¶å…³è”çš„å¯¹ç§°å¯†é’¥ï¼Œä¹‹åçš„ä¸šåŠ¡äº¤äº’éƒ½ä½¿ç”¨è¿™ä¸ªå¯¹ç§°å¯†é’¥åŠ å¯†è¿›è¡Œã€‚ é˜¿è¾‰å¿ƒæƒ…æ¿€åŠ¨çš„è½åœ°äº†è¿™ä¸ªæ€è·¯å¹¶å°†å…¶ä¸Šçº¿ï¼Œå¹¶å°†å®ç°æ€è·¯ä¸è€å¸ˆé˜¿ç”˜äº¤æµç•…è°ˆï¼Œé˜¿ç”˜å¬å®Œåç¬‘ç€è¯´ï¼šä½ è¿™æ˜¯å®ç°äº†ä¸€ä¸ªHTTPSçš„åè®®æµç¨‹å‘€ã€‚é˜¿è¾‰å¬åæœ¬ç€ä¸é‡å¤é€ è½®å­çš„ç²¾ç¥å»äº†è§£äº†ä¸€ä¸‹HTTPSåè®®çš„äº¤äº’æµç¨‹ï¼Œå‘ç°ç¡®å®å’Œè‡ªå·±æ€è·¯å¤§è‡´ä¸€æ ·ï¼Œçœ‹ç€è‡ªå·±å®ç°çš„äº¤äº’æµç¨‹é˜¿è¾‰å¿ƒæƒ³ï¼Œæˆ‘è¿™ç§æ–¹æ¡ˆçš„ç¡®å®ç°äº†éœ€æ±‚ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªå¾ˆä¸¥é‡çš„ç¼ºé™· åœ¨ä¸šåŠ¡å±‚åšåŠ å¯†è€Œä¸æ”¾åœ¨ä¼ è¾“å±‚å¯¹ä¸šåŠ¡ä»£ç çš„ä¾µå…¥æ€§å¤ªå¼º ä»¥è¿™ç§æ–¹å¼å‘å¸ƒçš„æœåŠ¡æ— æ³•åšåˆ°æ™®é€‚æ€§ï¼Œéš¾ä»¥æ¨å¹¿ä½¿ç”¨ ç»¼ä¸ŠåŸå› é˜¿è¾‰é€‰æ‹©æŠ›å¼ƒè‡ªä¸»ç ”å‘çš„â€œHTTPSâ€ï¼Œå¼€å§‹åœ¨ä¼ è¾“å±‚æ”¹é€ è‡ªå·±çš„åº”ç”¨ å¯ç”¨HTTPSé˜¿è¾‰çš„éƒ¨ç½²æ¶æ„æ˜¯ç®€å•çš„Nginx+å¤šTomcatæ­å»ºè€Œæˆçš„å°å‹æœåŠ¡é›†ç¾¤ï¼Œåœ¨æŸ¥é˜…äº†ç›¸å…³çš„æ–‡æ¡£è¯´æ˜åï¼Œé˜¿è¾‰å¼€å§‹äº†HTTPSçš„é…ç½®å·¥ä½œ ä½¿ç”¨ OpenSSL ç”Ÿæˆ SSL Key å’Œ CSR æ–‡ä»¶ ä¿®æ”¹ Nginx çš„é…ç½®æ–‡ä»¶å¹¶é‡å¯ é˜¿è¾‰ä¿¡å¿ƒæ»¡æ»¡çš„å°†å¼€å¯äº†HTTPSé˜²æŠ¤çš„å¼±é¸¡APPä¸Šäº†çº¿ï¼Œå€¼å¾—é«˜å…´çš„æ˜¯æ ¹æ®å®¢æœçš„åé¦ˆç›—å·ç”³è¯‰çš„äººæ˜æ˜¾å‡å°‘ï¼Œä½†æœ‰ä¸€ä¸ªåæ¶ˆæ¯ï¼Œ*ç›—å·æƒ…å†µå´æ²¡å®Œå…¨æ¶ˆå¤±ï¼Œé˜¿è¾‰å¿ƒæƒ³éš¾é“è¿™å¥—ä½“ç³»ä¸‹è¿˜èƒ½è¢«ç›—å–å¯†ç ä¹ˆï¼Ÿéš¾é“æˆ‘è¿™ä½“ç³»è¿˜æœ‰æ¼æ´â€¦é˜¿è¾‰ä¸é»‘å®¢æ–°ä¸€è½®çš„å‘¨æ—‹å¼€å§‹äº†ã€‚ ä¸­é—´äººæ”»å‡»é»‘å®¢å°åˆ˜è‡ªå¼ ä¸‰è¯è´¹äº‹ä»¶å°åˆ°ç”œå¤´ä»¥åå°±ä¸€ç›´åœ¨å…³æ³¨å¼±é¸¡APPï¼Œå¼±é¸¡APPåœ¨ä¸æ–­å‡çº§çš„åŒæ—¶å°åˆ˜ä¹Ÿåœ¨ä¸æ–­æˆé•¿ï¼Œå°åˆ˜ä¸é˜¿è¾‰çš„åšå¼ˆè®©ä¸¤äººçš„æ°´å¹³éƒ½åœ¨ä¸æ–­æ”€å‡ï¼Œä»Šå¤©å°åˆ˜å¾ˆé«˜å…´ï¼Œå› ä¸ºä»–åˆ©ç”¨ä¸­é—´äººæ”»å‡»å†æ¬¡ç ´è§£äº†é˜¿è¾‰çš„å®‰å…¨é˜²çº¿ã€‚ ä½•ä¸ºä¸­é—´äººæ”»å‡»ï¼Ÿ ä¸­é—´äººæ”»å‡»(Man-in-the-MiddleAttackï¼Œç®€ç§°â€œMITMæ”»å‡»â€)æ˜¯æŒ‡æ”»å‡»è€…ä½¿ç”¨å…¬é’¥äº¤æ¢çš„æ–¹å¼æ¥æ‹¦æˆªæ¶ˆæ¯å¹¶è½¬å‘å–ä»£å®ƒä»¬ï¼ŒåŸå§‹åŒæ–¹è¡¨é¢ä¸Šçœ‹ä»ç„¶äº’ç›¸é€šä¿¡ï¼Œä½†æ˜¯å†…å®¹å¯èƒ½å·²ç»è¢«çª¥æ¢æˆ–ç¯¡æ”¹ï¼Œå…¶æ”»å‡»æµç¨‹å¦‚ä¸‹æ‰€ç¤º æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€å…¬é’¥ã€‚ æ”»å‡»è€…æˆªè·çœŸå®çš„å…¬é’¥ï¼Œä¿ç•™åœ¨è‡ªå·±æ‰‹ä¸Šã€‚ æ”»å‡»è€…è‡ªå·±ç”Ÿæˆä¸€ä¸ªä¼ªé€ çš„å…¬é’¥ï¼Œå‘ç»™å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯æ”¶åˆ°ä¼ªé€ çš„å…¬é’¥åï¼Œä½¿ç”¨æ­¤å…¬é’¥åŠ å¯†å¯¹ç§°å¯†é’¥å¾—åˆ°å¯†é’¥å¯†æ–‡å‘ç»™æœåŠ¡å™¨ã€‚ æ”»å‡»è€…æˆªè·è·å¯†é’¥å¯†æ–‡ï¼Œç”¨è‡ªå·±çš„ç§é’¥è§£å¯†è·å¾—å¯¹ç§°å¯†é’¥ï¼ŒåŒæ—¶ä½¿ç”¨çœŸå®çš„å…¬é’¥åŠ å¯†å¯¹ç§°å¯†é’¥å‘ç»™æœåŠ¡å™¨ã€‚ è‡³æ­¤å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é€šæš´éœ²çš„å¯¹ç§°å¯†é’¥è¿›è¡Œé€šä¿¡ï¼Œå¯¹äºæ”»å‡»è€…æ¥è¯´ç­‰åŒäºæ˜æ–‡é€šä¿¡ã€‚ ä¸éš¾ç†è§£ä¸­é—´äººæ”»å‡»æ˜¯å‘ç”Ÿåœ¨æœåŠ¡å™¨çš„è¯ä¹¦çš„ä¸‹å‘é˜¶æ®µï¼Œ\bé—®é¢˜æ ¹æœ¬åŸå› åœ¨äºï¼šå®¢æˆ·ç«¯æ— æ³•ç¡®å®šæœåŠ¡å™¨ä¸‹å‘çš„è¯ä¹¦æ˜¯å¦è¢«ä¸­é—´äººç¯¡æ”¹ï¼Ÿ CAä½“ç³»é˜¿è¾‰ç»è¿‡æŸ¥é˜…èµ„æ–™ä¹Ÿäº†è§£åˆ°äº†ä¸­é—´äººæ”»å‡»ï¼Œ\b\båœ¨äº†è§£åˆ°é—®é¢˜çš„æ ¹æœ¬åŸå› åè§£å†³å®ƒå˜å¾—ç®€å•äº†ï¼Œåªéœ€è¦ç»™å¼±é¸¡APPæ‰¾åˆ°ä¸€ä¸ªéªŒè¯è¯ä¹¦æ˜¯å¦è¢«ç¯¡æ”¹çš„æ–¹å¼å³å¯ï¼Œé˜¿è¾‰åœ¨ç½‘ç»œä¸Šå¯»æ‰¾è§£å†³æ–¹æ¡ˆï¼ŒCAä½“ç³»è¿›å…¥äº†é˜¿è¾‰çš„è§†é‡ã€‚ CA(Certificate Authority)æ˜¯æŒ‡æä¾›å¯ä¿¡è¯ä¹¦çš„è®¤è¯ä¸­å¿ƒæœºæ„ï¼Œå®ƒæŠŠç”¨æˆ·çš„å…¬é’¥å’Œç”¨æˆ·çš„å…¶ä»–æ ‡è¯†ä¿¡æ¯ï¼ˆå¦‚åç§°ã€e-mailã€èº«ä»¹è¯å·ç­‰ï¼‰æ†ç»‘åœ¨ä¸€èµ·ï¼Œåœ¨äº’è”ç½‘ä¸ŠéªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚ ä¹Ÿå°±æ˜¯è¯´é˜¿è¾‰å¯ä»¥å°†å¼±é¸¡APPçš„è¯ä¹¦ä¸å…¶æ ‡è¯†ä¿¡æ¯åœ¨CAæœºæ„ä¸­æ³¨å†Œï¼Œä¹‹åå¼±é¸¡APPè·å–æœåŠ¡å™¨ä¸‹å‘çš„è¯ä¹¦åå…ˆå»CAæœºæ„ä¸­éªŒè¯è¯ä¹¦çš„æ¥æºï¼Œç¡®å®šæ¥æºå¯é åå†è¿›è¡Œç½‘ç»œäº¤äº’ï¼Œè¿™ä¾¿é˜²æ­¢äº†ä¸­é—´äººæ”»å‡»ã€‚ æ‹“å±•å…¶å®ä¸ä»…ä»…åœ¨ç½‘ç«™äº¤äº’ä¸­å­˜åœ¨ä¸­é—´äººæ”»å‡»é—®é¢˜ï¼Œåªè¦æ˜¯åŸºäºéå¯¹ç§°åŠ å¯†çš„ä¼ è¾“åè®®éƒ½ä¼šå­˜åœ¨è¯¥é—®é¢˜ï¼Œæ¯”å¦‚LinuxæœåŠ¡å™¨çš„ç™»å½•è®¤è¯æ˜¯é€šè¿‡SSHåè®®æ¥è¿›è¡Œçš„ï¼Œå¹³å¸¸æˆ‘ä»¬ç™»å½•ä¸€ä¸ªæœåŠ¡å™¨çš„æµç¨‹æ˜¯è¿™æ ·çš„ &gt; ssh root@192.168.31.100 The authenticity of host 'host (192.168.31.100)' can't be established. RSA key fingerprint is 98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d. Are you sure you want to continue connecting (yes/no)? ç³»ç»Ÿä¼šæç¤ºæ— æ³•ç¡®å®š192.168.31.100å…¬é’¥çš„çœŸå®æ€§ï¼ŒåªçŸ¥é“å®ƒçš„å…¬é’¥æŒ‡çº¹ï¼Œæ˜¯å¦è¿˜è¦ç»§ç»­è¿æ¥ï¼Ÿ å…¬é’¥æŒ‡çº¹æ˜¯ä»£è¡¨å¯¹å…¬é’¥MD5è®¡ç®—åçš„å€¼ï¼Œç”±äºå…¬é’¥çš„é•¿åº¦æ¯”è¾ƒé•¿ä¸å®¹æ˜“æ¯”å¯¹ï¼Œä¾¿ç”¨è¿™ä¸ªè¾ƒçŸ­çš„æŒ‡çº¹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸ºä»€ä¹ˆè¦æ¯”è¾ƒï¼Œå…¶å®å°±æ˜¯ä¸ºäº†é˜²æ­¢ä¸­é—´äººæ”»å‡»ç¯¡æ”¹æ‰å…¬é’¥ä¿¡æ¯ã€‚è€Œæˆ‘ä»¬å¦‚ä½•çŸ¥é“æœåŠ¡å™¨çš„å…¬é’¥æŒ‡çº¹å‘¢ï¼Ÿè¿™é‡Œä¹Ÿæ²¡æœ‰æ¯”è¾ƒå¥½çš„åŠæ³•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥åœ¨ç½‘ç«™å…¬ç¤ºæˆ–è€…é‡‡ç”¨å¯†é’¥å¯¹ç™»å½•ã€‚ å½“ä½ è¾“å…¥yesåè¡¨ç¤ºå…¬é’¥è¢«æ¥å—ï¼Œå®ƒå°†è¢«ä¿å­˜äº$HOME/.ssh/known_hostsä¸­ä½œä¸ºä¿¡ä»»çš„ä¸»æœºï¼Œå†æ¬¡è¿æ¥æ—¶å°†è·³è¿‡è­¦å‘Šã€‚ Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added 'host,192.168.31.100' (RSA) to the list of known hosts. Password: ****** é˜¿è¾‰çš„å¿ƒæ€ğŸ¤”ç»è¿‡ä¸€è¿ç»­çš„äº‹ä»¶é˜¿è¾‰çš„å¿ƒæ€æœ‰äº†æ˜æ˜¾çš„å˜åŒ–ï¼Œå®ƒæ„è¯†åˆ°ç³»ç»Ÿçš„å®‰å…¨è®¾è®¡æ˜¯ä¸€ä¸ªå¾ˆé‡è¦æ¨¡å—ï¼Œåœ¨ä¸€äº›æ¶‰åŠèµ„é‡‘çš„æ¨¡å—æ—¶æ›´æ˜¯è¦å¯¹å…¶ä¸¥æ ¼æŠŠå…³ï¼Œæ£€æŸ¥è®¾è®¡ã€å¼€å‘ä¸éƒ¨ç½²æ–¹é¢æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æŠ±ç€è¿™æ ·çš„å¿ƒæ€ï¼Œé˜¿è¾‰å‡†å¤‡é‡æ–°å®¡è§†å¹¶æ£€æŸ¥ä¸€éå¼±é¸¡APPæ˜¯å¦è¿˜å­˜åœ¨å…¶ä»–çš„å®‰å…¨æ¼æ´ã€‚ æ•æ„Ÿä¿¡æ¯é˜²æŠ¤é˜¿è¾‰å…ˆä»å¼±é¸¡APPçš„æ•°æ®åº“è®¾è®¡å¼€å§‹æ£€æŸ¥ï¼Œç»“åˆè‡ªå·±æœ€è¿‘è·å–åˆ°çš„å®‰å…¨çŸ¥è¯†é˜¿è¾‰å¾ˆå¿«å°±å‘ç°äº†ç³»ç»Ÿç”¨æˆ·è¡¨è®¾è®¡çš„æœ‰é—®é¢˜ã€‚ è¿™æ ·çš„è®¾è®¡è™½ç„¶éå¸¸ç®€å•æ˜“æ‡‚ï¼Œä½†æ˜¯é˜¿è¾‰æ¨¡æ‹Ÿäº†ä¸€ä¸‹å¦‚æœæ•°æ®åº“ä¿¡æ¯æ³„æ¼äº†ï¼Œé‚£è‡ªå·±ç³»ç»Ÿçš„æ‰€æœ‰ç”¨æˆ·æ•°æ®ä¸å°±å®Œå…¨å…¬å¼€äº†ä¹ˆï¼Œæƒ³æƒ³éƒ½ä»¤äººå®³æ€•ï¼Œçœ‹æ¥å¾—æ‰¾ä¸ªåŠæ³•å¯¹è„±åº“æ•°æ®è¿›è¡Œä¿æŠ¤ã€‚ å¯†æ–‡å­˜å‚¨ä¸ºäº†è§„é¿å¯†ç æ³„æ¼çš„é£é™©ï¼Œå¯†ç ä¸åº”è¯¥æ˜æ–‡å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œé‚£å°±è½¬æ¢æˆå¯†æ–‡å­˜å‚¨ï¼é˜¿è¾‰ç«‹é©¬æƒ³åˆ°ä¸¤ç§æ‰‹æ®µ é€šè¿‡åŠ å¯†ç®—æ³•å­˜å‚¨å¯†ç ï¼Œç”¨æˆ·ç™»å½•æ—¶å¯¹æ¥æ”¶åˆ°çš„å¯†ç åšåŒæ ·çš„åŠ å¯†ç„¶åå¯¹æ¯”æ•°æ®åº“ é€šè¿‡hashï¼ˆæ‘˜è¦ï¼‰ç®—æ³•å­˜å‚¨å¯†ç ï¼Œç”¨æˆ·ç™»å½•æ—¶å¯¹æ¥æ”¶åˆ°çš„å¯†ç åšåŒæ ·çš„hashç„¶åå¯¹æ¯”æ•°æ®åº“ å¯¹æ¯”ä¸¤ç§æ–¹æ¡ˆåé˜¿è¾‰é€‰æ‹©äº†åè€…ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŸå›  åŠ å¯†ç®—æ³•éœ€è¦ä¸€ä¸ªå¯†é’¥ï¼Œå¯†é’¥çš„å­˜å‚¨ä¹Ÿæ˜¯æœ‰æ³„æ¼é£é™©çš„ å¯†ç ä¸åŒäºç”¨æˆ·åç§°è¿™æ ·çš„å­—æ®µï¼Œå®ƒæ²¡æœ‰è½¬æ¢æ˜æ–‡è¿™ç§éœ€æ±‚å¹¶ä¸”å®ƒä¹Ÿä¸å¸Œæœ›è‡ªå·±èƒ½è¢«é€†å‘è½¬æ¢ï¼Œæ­£å¥½ç¬¦åˆæ‘˜è¦ç®—æ³•çš„åœºæ™¯ ç»è¿‡æ”¹é€ åçš„ç³»ç»Ÿç”¨æˆ·æ•°æ®å¦‚ä¸‹æ‰€ç¤º ç°åœ¨çœ‹æ¥æ•°æ®è„±åº“åçš„é£é™©ä¼¼ä¹é™äº†è®¸å¤šï¼Œä½†é˜¿è¾‰ä¸å¤šä¹…åˆäº†è§£åˆ°ä¸€ä¸ªåè¯ï¼Œå«åšå¯†ç å­—å…¸ï¼Œä»£æŒ‡åŒ…æ‹¬è®¸å¤šäººä»¬ä¹ æƒ¯æ€§è®¾ç½®çš„å¯†ç çš„æ•°æ®å­—å…¸ï¼Œæ¯”å¦‚Githubå°±æœ‰ä¸€ä¸ªå«åšçˆ†ç ´å­—å…¸çš„ä»“åº“ï¼Œé˜¿è¾‰ä¸ç¦å¿ƒæƒ³ï¼Œç”¨æˆ·æ•°æ®è„±åº“åï¼Œäººä»¬å¯ä»¥é€šè¿‡å¯†ç å­—å…¸æ¥åå‘å¯»æ‰¾ä¸å¯†ç ç›¸åŒ¹é…çš„ç”¨æˆ·ï¼Œä¹Ÿèƒ½è¾¾åˆ°ç ´è§£çš„æ•ˆæœï¼ˆå¦‚æœç”¨æˆ·å¯†ç è®¾ç½®çš„ä¸å¤æ‚ï¼‰ï¼Œç ´è§£çš„æ€è·¯å¦‚ä¸‹ éå†å¯†ç å­—å…¸ï¼Œä»å¯†ç å­—å…¸ä¸­å–å‡ºä¸€æ¡å¯†ç ï¼Œå¯¹å…¶åšhashç®—æ³•å¾—åˆ°å¯†ç æ‘˜è¦ ä½¿ç”¨å¯†ç æ‘˜è¦ä½œä¸ºæ¡ä»¶æŸ¥è¯¢æ•°æ®åº“çš„ä¿¡æ¯ä¾¿å¯æ‰¾åˆ°ä»¥æ­¤ä¸ºå¯†ç çš„è´¦æˆ·åˆ—è¡¨ å¯è§è¿™ç§è®¾è®¡æ–¹å¼å¦‚æœæ•°æ®åº“ä¸­å­˜åœ¨ç›¸åŒå¯†ç çš„ç”¨æˆ·ï¼Œä¸€æ¬¡æŸ¥è¯¢åŒ¹é…å¯ä»¥å°†å®ƒä»¬å…¨éƒ¨è·å–ï¼Œè¿™å¯¹ç ´è§£è€…ä¹Ÿå¤ªå‹å¥½äº†ï¼Œçœ‹æ¥æ–¹æ¡ˆè¿˜å¾—æ”¹æ”¹ã€‚ åŠ ç›å­˜å‚¨é˜¿è¾‰ç»è¿‡æœç´¢å¾ˆå¿«å°±å¾—åˆ°äº†ä¸€ç§æ›´å¥½çš„æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯åŠ ç›å­˜å‚¨ï¼Œé˜¿è¾‰ä¿®æ”¹äº†ç³»ç»Ÿç”¨æˆ·çš„è¡¨ç»“æ„ï¼Œç»™å®ƒå¢åŠ äº†ä¸€ä¸ªå­—æ®µå«åšsaltï¼ˆç›å€¼ï¼‰ï¼Œè¿™ä¸ªç›å€¼éœ€è¦éšæœºç”Ÿæˆå¹¶ä¸”å°½é‡ä¿è¯æ¯ä¸ªç”¨æˆ·éƒ½ä¸ä¸€æ ·ï¼Œpasswordå¯†ç å­—æ®µä¸­å­˜å‚¨ä¹Ÿä¸å†åªæ˜¯å¯¹å¯†ç çš„hashäº†ï¼Œè€Œæ˜¯hash(password+salt)ï¼Œæ•°æ®è¡¨å˜æˆäº†å¦‚ä¸‹ç»“æ„ åœ¨ç”¨æˆ·ç™»å½•æ—¶éªŒè¯æµç¨‹å¦‚ä¸‹ è·å–ç”¨æˆ·æäº¤çš„å¯†ç submitPasswordä¸å…¶æ•°æ®åº“ä¸­å­˜å‚¨çš„ç›å€¼salt åˆ¤æ–­hash(submitPassword+salt)æ˜¯å¦ä¸æ•°æ®åº“ä¸­å­˜å‚¨çš„å¯†ç passwordç›¸ç­‰ æµç¨‹æ”¹é€ åå¹¶ä¸å¤æ‚ï¼Œé‡ç‚¹æ˜¯saltæ€ä¹ˆè®©æ•°æ®æ›´åŠ å®‰å…¨çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç ´è§£çš„æµç¨‹ éå†å¯†ç å­—å…¸ï¼Œä»å¯†ç å­—å…¸ä¸­å–å‡ºä¸€æ¡å¯†ç  éå†ç”¨æˆ·æ•°æ®è¡¨å–saltå­—æ®µæ‹¼æ¥åˆ°å¯†ç åé¢å½¢æˆæ–°çš„å­—ç¬¦ä¸²ï¼Œhashåä¸å¯†ç å­—æ®µåŒ¹é… è¿™ä¸ªç ´è§£æµç¨‹å’Œä¸Šé¢çš„æœªåŠ ç›å€¼çš„ç ´è§£æµç¨‹æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼Œç›¸åŒå¯†ç çš„ç”¨æˆ·ä¸ä¼šè¢«ä¸€æ¬¡æ€§è·å–åˆ°äº†ï¼Œå¢åŠ äº†æš´åŠ›ç ´è§£çš„å¤æ‚åº¦ã€‚ æˆ‘ä»¬å‡è®¾å¯†ç å­—å…¸æœ‰20Wæ¡æ•°æ®ï¼Œå¼±é¸¡APPæœ‰100Wä¸ªç”¨æˆ·ï¼Œé‚£ä¹ˆå®Œå…¨è¦†ç›–éœ€è¦åŒ¹é…å¤šå°‘æ¬¡å‘¢ï¼Ÿ ä¸éš¾ç®—å‡ºï¼ŒåŒ¹é…æ¬¡æ•°ä¸º20Wx100Wï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤šéœ€è¦2000äº¿æ¬¡å¯å¾—åˆ°å¯†ç å­—å…¸è¦†ç›–åˆ°çš„ç”¨æˆ·ï¼Œè¿™ä¸ªè¿ç®—é‡çš„æˆæœ¬å·²ç»éå¸¸é«˜äº†ï¼Œè€Œä¸”åœ¨è®¾è®¡çš„æ—¶å€™ä¹Ÿä¸ä¸€å®šå°±æŠŠç›å€¼æ”¾åœ¨å¯†ç ä¹‹åhashï¼Œä¹Ÿå¯ä»¥æ”¾åˆ°å‰é¢æˆ–è€…ä¸­é—´ï¼Œç”±äºç ´è§£è€…ä¸çŸ¥é“ç›å€¼ä¸å¯†ç çš„ç»„æˆæ–¹å¼ï¼Œè¿™ä¼šç»™ç ´è§£å¸¦æ¥æ›´å¤§çš„éš¾åº¦ã€‚ è¿™ä¸ªè®¾è®¡æš‚æ—¶æˆä¸ºäº†é˜¿è¾‰æ»¡æ„çš„æ–¹æ¡ˆï¼Œé™¤äº†æ•°æ®æ–¹é¢ï¼Œé˜¿è¾‰è¿˜å»äº†è§£äº†ä¸€ä¸‹å…¶ä»–å¯èƒ½å‡ºç°çš„å®‰å…¨æ¼æ´ï¼Œå¹¶åšäº†ä»¥ä¸‹æ€»ç»“ å®‰å…¨æ¼æ´é˜²æŠ¤SQL-æ³¨å…¥SQLæ³¨å…¥æ”»å‡»æ˜¯å°†å‡»æ˜¯è¾“å…¥å‚æ•°æœªç»è¿‡æ»¤ï¼Œç›´æ¥æ‹¼æ¥åˆ°SQLè¯­å¥å½“ä¸­è§£æï¼Œæ‰§è¡Œè¾¾åˆ°é¢„æƒ³ä¹‹å¤–çš„ä¸€ç§è¡Œä¸ºã€‚æ¯”å¦‚ä¸‹æ–¹çš„å‡½æ•°å°±å­˜åœ¨sqlæ³¨å…¥é£é™©ï¼Œç¤ºä¾‹ä¸­é€šè¿‡ä¼ é€’å‚æ•°çš„æ–¹å¼æŠŠsys_userè¡¨åˆ é™¤äº†ã€‚ public SysUser findUserByAccount(String account) { String sql = &quot;select * from sys_user where account = &quot; + account; execute(sql); } public static void main(String[] args) { String account = &quot;'';drop table sys_user;&quot; findUserByAccount(account); // select * from sys_user where account = '';drop table sys_user; } é˜¿è¾‰çœ‹äº†çœ‹è‡ªå·±çš„ç³»ç»Ÿï¼Œä½¿ç”¨hibernateä½œä¸ºæŒä¹…å±‚ä¸”æ²¡æœ‰ä»»ä½•SQLæ‹¼æ¥çš„æ“ä½œï¼Œæ¡†æ¶ä¼šå¸®ç³»ç»Ÿé˜²æ­¢SQLæ³¨å…¥ï¼Œæ”¾ä¸‹å¿ƒæ¥ï¼Œæ—¥åå†å»é˜…è¯»æ¡†æ¶æ˜¯æ€ä¹ˆå»é˜²æ­¢SQLæ³¨å…¥çš„ã€‚ XSS-æ”»å‡»XSSæ”»å‡»é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„è„šæœ¬å¹¶è¿è¡Œï¼Œç›—å–ç”¨æˆ·çš„ä»¤ç‰Œä¿¡æ¯ã€‚æ¯”å¦‚ç³»ç»Ÿæœ‰ä¸€å—å…¬å…±è¯„è®ºå±•ç¤ºåŒºï¼Œæœ‰ä¸€ä¸ªç”¨æˆ·ç•™ä¸‹äº†JSè„šæœ¬alert('123')ï¼Œç½‘ç«™å¦‚æœæ²¡æœ‰åšXSSè¿‡æ»¤é‚£ä¹ˆåœ¨è¯„è®ºæ¸²æŸ“æ—¶è„šæœ¬å°±ä¼šè¢«æ‰§è¡Œï¼Œåªè¦æ‰“å¼€è¿™ä¸ªè¯„è®ºåŒºçš„ç”¨æˆ·å°±ä¼šå¼¹å‡ºä¸€ä¸ª123çš„æç¤ºæ¡†ï¼Œå¦‚æœç”¨æˆ·ç•™ä¸‹çš„æ˜¯ä¸€ä¸ªç›—ç”¨tokenå¹¶å°†å…¶å‘åˆ°è‡ªå·±æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥ä¼ªè£…æˆå…¶ä»–ç”¨æˆ·è¿›è¡Œæ“ä½œã€‚ CSRF-æ”»å‡»CSRFæ”»å‡»ä¸XSSæ”»å‡»ä¸åŒä¹‹å¤„åœ¨äºï¼ŒXSSç›—å–äº†ä»¤ç‰Œä¿¡æ¯ï¼Œä½†æ˜¯CSRFæ²¡æœ‰ç›—å–ï¼Œå®ƒè¯±å¯¼ç”¨æˆ·ç‚¹å‡»é“¾æ¥å»è®¿é—®ç”¨æˆ·æ›¾ç»è®¤è¯è¿‡çš„ç½‘ç«™å¹¶è¿è¡Œä¸€äº›æ“ä½œï¼Œè¯¦è§è·¨ç«™è¯·æ±‚ä¼ªé€ wiki æ€»ç»“ç½‘ç»œå®‰å…¨æ˜¯ä¸€ä¸ªæ—¥ç›Šç«çƒ­çš„è¯é¢˜ï¼Œè¿™äº›çŸ¥è¯†ä½œä¸ºä¸€é¡¹è½¯æŠ€èƒ½è™½ç„¶ä¸èƒ½ç»™æˆ‘ä»¬çš„å¼€å‘å¸¦æ¥å¤§çš„å¸®åŠ©ï¼Œä½†å´æ˜¯å¾ˆé‡è¦ä¸”ä¸å¯æˆ–ç¼ºçš„ä¸€å—çŸ¥è¯†ã€‚ å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„ä¸€æ¥ç»™è‡ªå·±æ‰€äº†è§£åˆ°çš„å®‰å…¨çŸ¥è¯†åšä¸€ä¸ªæ€»ç»“ï¼Œç¬¬äºŒä¹Ÿå¸Œæœ›æ–‡ç« èƒ½å¤Ÿå¯¹æƒ³äº†è§£è¿™å—å†…å®¹çš„äººæä¾›ä¸€äº›å¸®åŠ©ï¼Œæ–‡ç« çš„ç¼–å†™å€Ÿé‰´äº†ç½‘ä¸Šéƒ¨åˆ†ä¼˜ç§€æ–‡ç« çš„å†…å®¹ï¼Œéƒ½åœ¨ä¸‹æ–¹çš„å‚è€ƒèµ„æ–™ä¸­ï¼ŒåŒæ ·å¸Œæœ›è¿™äº›ä¼˜ç§€åšæ–‡èƒ½å¤Ÿå¸®åŠ©åˆ°æƒ³è¦äº†è§£è¿™å—å†…å®¹çš„åŒå­¦ä»¬ã€‚å…±å‹‰ã€‚ å‚è€ƒèµ„æ–™ Webç³»ç»Ÿæƒé™æ§åˆ¶å¦‚ä½•è®¾è®¡ æƒé™ç³»ç»Ÿä¸RBACæ¨¡å‹æ¦‚è¿° RBACæƒé™ç®¡ç† ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ï¼Ÿâ€”â€”çŸ¥ä¹ SSHåŸç†ä¸è¿ç”¨ï¼ˆä¸€ï¼‰ï¼šè¿œç¨‹ç™»å½• Nginx é…ç½® HTTPS æœåŠ¡å™¨ ä¸ºä»€ä¹ˆè¦åœ¨å¯†ç é‡ŒåŠ ç‚¹â€œç›â€ WEBåº”ç”¨å¸¸è§15ç§å®‰å…¨æ¼æ´ä¸€è§ˆ","link":"/2019-12-14-safe-on-web/"},{"title":"éšç¬”â€”â€”å¦‚ä½•é˜²æ­¢ç©ºæŒ‡é’ˆ","text":"&emsp;&emsp;å¾ˆä¹…æ²¡å†™åšå®¢å•¦ï¼Œå› ä¸ºå‰æ®µæ—¶é—´å…¬å¸é¡¹ç›®å¿™ç€ä¸Šçº¿ï¼ˆç»å¯¹ä¸æ˜¯å› ä¸ºæ‡’ï¼ï¼‰ï¼Œå…¬å¸äº‹ä¸ºå¤§ï¼Œç°åœ¨ç¨å¾®é—²äº†ç‚¹ï¼Œæ•´ç‚¹éšç¬”å†™å†™åˆ«è’åºŸäº†è‡ªä¸ªçš„å†™ä½œèƒ½åŠ›ã€‚ä»Šå¤©çš„ä¸»é¢˜æ˜¯ç©ºæŒ‡é’ˆï¼Œè¿™ç©æ„å„¿åœ¨å’±ä»¬çš„å¼€å‘ç”Ÿæ¶¯ä¸­åº”è¯¥æ˜¯å‡ºç°æœ€å¤šçš„å¼‚å¸¸å§ï¼Œä»Šå¤©æˆ‘å°±è®²è®²å¦‚ä½•åœ¨ç¨‹åºä¸­æœ‰æ•ˆçš„é˜²æ­¢è¯¥å¼‚å¸¸çš„å‡ºç°ã€‚ å‰è¨€æœ€è¿‘è¯»äº†ä¸€ç¯‡æœ‰æ„æ€çš„åšå®¢å«åšç©ºæŒ‡é’ˆæ¼«è°ˆï¼Œé‡Œé¢æ ‡æ³¨çš„åŸæ–‡é“¾æ¥å·²ç»å¤±æ•ˆäº†ï¼Œæ‰€ä»¥æˆ‘é“¾äº†è½¬è½½çš„åœ°å€ã€‚è¿™ç¯‡åšå®¢è®²è¿°äº†ç©ºæŒ‡é’ˆè®¾è®¡çš„èµ·æºï¼ˆæ²¡æƒ³åˆ°åŸå› ä»…ä»…æ˜¯å› ä¸ºç©ºæŒ‡é’ˆçš„å®ç°ç®€å•è€Œå·²ï¼ï¼‰ï¼Œå¹¶åœ¨åç»­ç»™å‡ºäº†ä¸€äº›æ”¾ç©ºæŒ‡é’ˆå¼‚å¸¸çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥ä»Šå¤©æˆ‘å°±é’ˆå¯¹å¦‚ä½•åœ¨Javaè¯­è¨€ä¸­æœ‰æ•ˆçš„é˜²æ­¢ç©ºæŒ‡é’ˆè¿™ä¸ªé—®é¢˜å±•å¼€è®¨è®ºï¼Œæœ¬æ–‡åŸºäºJDK1.8è¿›è¡Œè®²è¿°ã€‚ ä¸ºä½•äº§ç”Ÿç©ºæŒ‡é’ˆä»ç¨‹åºçš„è§’åº¦nullä½œä¸ºç¨‹åºçš„ä¸€ä¸ªç‰¹æ®ŠçŠ¶æ€ï¼Œåœ¨Javaä¸­ï¼Œé™¤äº†åŸºæœ¬ç±»å‹ä»¥å¤–çš„æ‰€æœ‰å¼•ç”¨ç±»å‹éƒ½å¯ä»¥èµ‹å€¼ä¸ºnullï¼Œå¦‚æœå˜é‡çš„å€¼ä¸ºnullï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ç”¨å®ƒè°ƒç”¨æˆå‘˜å‡½æ•°å¼ä¾¿ä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ public class NullPointTest { public static void main(String[] args) { List&lt;String&gt; strList = null; // NullPointException System.out.println(strList.size()); } } ä»äººä¸ºçš„è§’åº¦å…¶å®åˆ¤æ–­ä»£ç æ˜¯å¦å¯èƒ½å‡ºç°ç©ºæŒ‡é’ˆå¹¶ç»™å‡ºå¥å£®æ€§çš„ä»£ç ä¸éš¾å®ç°ï¼Œåªéœ€è¦å…ˆåˆ¤éç©ºå†è°ƒç”¨å³å¯ï¼Œä½†æ˜¯å°±å¦‚ç©ºæŒ‡é’ˆæ¼«è°ˆæ­¤æ–‡æ‰€è¯´ åœ¨æŸäº›åœ°æ–¹ï¼Œç¨‹åºå‘˜å¯èƒ½ä¼šè§‰å¾—æŸä¸ªå˜é‡ä»é€»è¾‘ä¸Šå¯ä»¥ä¿è¯å®ƒä¸ä¼šä¸ºç©ºï¼Œäºæ˜¯å°±çœç•¥æ‰äº†ç©ºæŒ‡é’ˆæ£€æŸ¥ã€‚å¯æ˜¯ï¼Œæ—¶è¿‡å¢ƒè¿ä¹‹åï¼Œå› ä¸ºä»£ç çš„å„ç§å˜åŒ–ï¼Œå¯¼è‡´è¿™æ ·çš„å‰æä¸å†æˆç«‹çš„æ—¶å€™ï¼Œç©ºæŒ‡é’ˆå¼‚å¸¸å°±å‘ç”Ÿäº†ï¼Œä»£ç å› æ­¤éå¸¸è„†å¼±ã€‚è€Œæœ‰äº›è°¨æ…çš„ç¨‹åºå‘˜ï¼Œä¸ºæœªé›¨ç»¸ç¼ªè®¡ï¼Œä¼šåœ¨å„ä¸ªåœ°æ–¹éƒ½åŠ ä¸Šä¿æŠ¤æ€§çš„ç©ºæŒ‡é’ˆæ£€æŸ¥ï¼Œåˆè®©ä»£ç å˜å¾—éå¸¸è‡ƒè‚¿ã€‚ æ€»ç»“æ¥è¯´å°±æ˜¯ç©ºæŒ‡é’ˆåˆ¤æ–­å…¨åŠ ä»£ç è‡ƒè‚¿ï¼Œä¸åŠ ä»£ç è„†å¼±ï¼Œæç«¯çš„æ–¹å¼å¹¶ä¸èƒ½å¾ˆå¥½çš„è§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬è¦å¯»æ±‚ä¸€ç§åˆç†çš„è§£å†³æ–¹å¼ã€‚ è§£å†³æ–¹æ¡ˆæ›´å®‰å…¨çš„ä½¿ç”¨APIè¿™éƒ¨åˆ†å°±æ˜¯ä¸€äº›æ—¥å¸¸å¼€å‘ç»éªŒäº†ï¼Œæ¯”å¦‚str.equals(&quot;abc&quot;)ä¸&quot;abc&quot;.equals(str)å®ç°çš„æ•ˆæœç›¸åŒï¼Œä½†æ˜¯åè€…ä¸å­˜åœ¨ç©ºæŒ‡é’ˆå¼‚å¸¸çš„å¯èƒ½æ€§ï¼ŒåŒç†çš„è¿˜æœ‰str.toString()ä¸String.valueOf(str)ç­‰ç­‰ï¼Œè¿™éƒ¨åˆ†æŠ€å·§çš„æŒæ¡ç¨‹åº¦è·Ÿä½ çš„è¸©å‘ç»éªŒæˆæ­£æ¯”ï¼Œå‘è¸©å¤šäº†å½“ç„¶å°±è®°ä½äº†ã€‚ ä½¿ç”¨ç©ºæ³¨é‡Š@NonNullä¸@Nullableä¸¤ä¸ªæ³¨è§£å¯ä»¥å‘Šè¯‰IDEæ­¤ä½ç½®ä½ æ˜¯å¦å…è®¸ç©ºå€¼å‡ºç°ï¼Œä»–æ”¯æŒä½¿ç”¨åœ¨ä»¥ä¸‹ä½ç½® æ–¹æ³•å‚æ•° æ–¹æ³•è¿”å› å±€éƒ¨å˜é‡ å­—æ®µ è¿™ç§çº¦å®šå¼è®¾è®¡å¯ä»¥è®©è°ƒç”¨è€…æœ‰è´£ä»»ä¸ä¼ é€’ç©ºå€¼ï¼Œé€šè¿‡@NonNullä¹Ÿå¯ä»¥å‘Šè¯‰è°ƒç”¨è€…æ­¤å¤„å¯ä»¥ä¸åšç©ºå€¼æ ¡éªŒè¯·å¤§èƒ†ä½¿ç”¨ï¼Œä»£ç æ—¶è¿‡å¢ƒè¿ä¹‹åç»´æŠ¤è€…çœ‹åˆ°æ­¤æ³¨è§£ä¹Ÿèƒ½æ˜ç™½æ­¤æ–¹æ³•éœ€è¦ä¿æŒå…¶é€»è¾‘è¿”å›ä¸å¯ä¸ºç©º ä½¿ç”¨OptionalåŒ…è£…ç»“æœOptionalç±»æ˜¯Java8æä¾›çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œå®ƒæ˜¯ä¸ºäº†è§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸è€Œå¼•å…¥çš„ï¼Œè€Œä¸”ï¼Œå®ƒæ˜¯åŸºäºå‡½æ•°å¼é£æ ¼è®¾è®¡çš„ã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆè§£å†³ç©ºæŒ‡é’ˆçš„å‘¢ï¼Ÿä¸”å¬æˆ‘å¨“å¨“é“æ¥ å¦‚ä½•é˜²ç©ºï¼Ÿç»™ç©ºå¯¹è±¡åšä¸€ä¸ªåŒ…è£…ï¼Œä»€ä¹ˆå«åšç»™ç©ºå¯¹è±¡åšä¸€ä¸ªåŒ…è£…ï¼Ÿçœ‹çœ‹ä¸‹é¢çš„ä»£ç  è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªValueWarpç±»ç”¨äºåŒ…è£…å‡½æ•°çš„å“åº”ç»“æœï¼ŒrandomNullContentWarpå‡½æ•°è´Ÿè´£éšæœºè¿”å›å¸¦æœ‰ç©ºå†…å®¹çš„å€¼åŒ…è£…è€Œä¸ç›´æ¥è¿”å›ç©ºå¯¹è±¡ï¼Œmainå‡½æ•°ä¸­å¾ªç¯è°ƒç”¨æ­¤å‡½æ•°æ‰“å°å†…å®¹ï¼Œè¿™é‡Œæˆ‘å°†é‡ç‚¹è®²ä¸€ä¸‹ValueWarpä¸­ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°çš„è®¾è®¡ getï¼šè·å–åŒ…è£…å†…å®¹ï¼Œå†…å®¹ä¸å­˜åœ¨æ—¶æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ orElseï¼šè·å–åŒ…è£…å†…å®¹ï¼Œå½“åŒ…è£…å†…å®¹ä¸å­˜åœ¨æ—¶é‡‡ç”¨ç”¨æˆ·ä¼ å…¥çš„å¤‡é€‰å†…å®¹ ifPresentï¼šå½“åŒ…è£…å†…å®¹ä¸ä¸ºç©ºæ—¶è°ƒç”¨ç”¨æˆ·ä¼ å…¥çš„å†…å®¹æ¶ˆè´¹è¡Œä¸ºï¼Œè¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªjava8å‡½æ•°å¼ç¼–ç¨‹åº“ä¸­çš„Consumeræ¥å£ï¼Œç›¸å…³è¯´æ˜åœ¨å¦‚ä½•ä¼˜é›…çš„éå†æ ‘ç»“æ„è¿™ç¯‡åšå®¢ä¸­æœ‰è®²åˆ° å…¶å®getæ–¹æ³•å¹¶ä¸èƒ½å¾ˆå¥½çš„é˜²æ­¢ç”±äºç©ºæŒ‡é’ˆå¸¦æ¥çš„å¼‚å¸¸é—®é¢˜ï¼Œè€ŒorElseä¸ifPresentåˆ™å¯ä»¥é˜²æ­¢æ­¤é—®é¢˜å‡ºç°ï¼Œæœ€ä½³çš„å®è·µæ–¹å¼åº”è¯¥æ˜¯å½“ä½ æœ‰å¤‡é€‰å€¼æ—¶ä½¿ç”¨orElseå‡½æ•°ï¼Œå½“ä½ åªæ˜¯æƒ³éç©ºæ—¶æ‰§è¡Œåˆ™ä½¿ç”¨ifPresentå‡½æ•°ï¼Œå¦‚ä¸Šè¿°ä¾‹å­ä¸­çš„warp.ifPresent(o -&gt; System.out.println(o));ä»£è¡¨éç©ºæ—¶æ‰“å°åŒ…è£…å†…å®¹ å›åˆ°Optionalç±»ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„ä»£ç  ä»£ç ä¸å¤šä¸”ä¸æ˜¯å¾ˆéš¾æ‡‚ï¼Œå¾ˆå¤šapiéƒ½æ˜¯ä»¥å‡½æ•°å¼çš„é£æ ¼å»è®¾è®¡çš„ï¼Œç¡®å®å…¶ä¸­éƒ¨åˆ†apiå¾ˆé€‚åˆç”¨å‡½æ•°å¼çš„é£æ ¼ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œä¸‹è¿°ä»£ç å¾ªç¯è°ƒç”¨äº†ä¸€ä¸ªå¯èƒ½äº§ç”Ÿç©ºå¯¹è±¡çš„å‡½æ•°ï¼Œå¹¶æ‰“å°ç¬¦åˆæ•°å­—å¤§äº3è¿™ä¸ªæ¡ä»¶çš„å­—ç¬¦ä¸²I am ${æ•°å­—å†…å®¹} è¿™æ®µä»£ç ç®€æ´æ€§ä¸ç”¨å¤šè¯´ï¼Œå¹¶ä¸”ä¸éœ€è¦è€ƒè™‘åŒ…è£…å†…å®¹ä¸ºç©ºçš„æƒ…å†µï¼Œå› ä¸ºåŒ…è£…ç±»å·²ç»ç»™ä½ å†…éƒ¨ç»Ÿä¸€å¥½äº†å¤„ç†é€»è¾‘ï¼Œä½ å¯ä»¥æŠŠé˜²ç©ºåˆ¤æ–­ç»™å»é™¤ï¼Œå°†ä»£ç é‡å¿ƒæ”¾åˆ°ä¸šåŠ¡ä¸Š æ€»ç»“çœ‹åˆ°è¿™é‡Œæˆ‘æƒ³ä½ å¯¹å¦‚ä½•é˜²æ­¢ç©ºæŒ‡é’ˆå·²ç»æœ‰äº†ä¸€äº›æ€è·¯äº†ï¼Œæ€»ç»“æ¥è¯´åˆ†äº†ä¸‰æ–¹é¢å»é˜²æŠ¤ å¯¹äºæ˜ç¡®äº†éç©ºçš„ä½ç½®ä½¿ç”¨@NonNullæ³¨é‡Šæ¥å‘ŠçŸ¥ç»´æŠ¤/è°ƒç”¨è€… å¯¹äºä¸æ˜ç¡®è¿”å›æ˜¯å¦å¯ç©ºçš„å‡½æ•°ä½¿ç”¨Optionalè¿›è¡ŒåŒ…è£…åè¿”å›ï¼Œè°ƒç”¨è€…å¯é€šè¿‡ifPresentæ–¹æ³•æ¥è¿›è¡Œéç©ºè°ƒç”¨ å¯¹äºå­—ç¬¦ä¸²ç±»å‹å¯ä»¥æ›´å®‰å…¨çš„å»ä½¿ç”¨éƒ¨åˆ†API æœ€åï¼Œç¥æ„¿å¤§å®¶ä»¥åçš„ä»£ç æ°¸è¿œæ²¡æœ‰ç©ºæŒ‡é’ˆï¼ïŒŸ å‚è€ƒèµ„æ–™ ç©ºæŒ‡é’ˆæ¼«è°ˆ ä½¿ç”¨ç©ºæ³¨é‡Šâ€”â€”IBM Javaå‡½æ•°å¼å¼€å‘â€”â€”ä¼˜é›…çš„Optionalç©ºæŒ‡é’ˆå¤„ç†","link":"/2019-11-20-null-for-java/"},{"title":"éšç¬”â€”â€”Java SPIã€Dubboä¸SpringBoot","text":"&emsp;&emsp;åœ¨å¹³æ—¶çš„è‡ªæˆ‘å­¦ä¹ ä¸­ï¼Œæ€»ç»“å½’çº³èƒ½åŠ›æ˜¯éå¸¸é‡è¦çš„ï¼Œä½¿ç”¨å·²æœ‰çš„çŸ¥è¯†ä½“ç³»å»é¢„æµ‹æœªçŸ¥çš„é¢†åŸŸï¼Œç„¶åå†è¿›è¡Œä¸æ–­çš„è‡ªæˆ‘ä¿®æ­£ï¼Œä¸ªäººè®¤ä¸ºè¿™æ˜¯ä¸ªä¸é”™çš„å­¦ä¹ æ–¹æ³•ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ€»ç»“å½’çº³ä¸€ä¸‹å¦‚é¢˜çš„ä¸‰å—çŸ¥è¯†ä½“ç³»ï¼Œå¯»æ‰¾å®ƒä»¬çš„å…±æ€§ä¸åŒºåˆ«ã€‚ å‰è¨€SPIæ˜¯ä»€ä¹ˆ&emsp;&emsp;SPIå…¨ç§°service provider interfaceæ˜¯JDKä¸­å†…ç½®çš„æœåŠ¡å‘ç°æœºåˆ¶ï¼Œå¦‚ä½•æ¥ç†è§£è¿™ä¸ªæœåŠ¡å‘ç°æœºåˆ¶ï¼ŒåšJavaå¼€å‘çš„å¿…ç„¶æˆ–å¤šæˆ–å°‘éƒ½äº†è§£Springæ¡†æ¶ä»¥åŠå®ƒçš„å‘¨è¾¹ç”Ÿæ€ï¼ŒSpringå¾ˆå¥½çš„åˆ©ç”¨å·¥å‚æ¨¡å¼+é…ç½®æ–‡ä»¶å®ç°äº†IoCå®¹å™¨ï¼Œè®©Java Beançš„å®ä¾‹åŒ–ç”±ç¡¬ç¼–ç å˜æˆäº†å¯é…ç½®ï¼Œè¿™æ˜¯ä¸ªè§£è€¦çš„æ“ä½œï¼Œé‚£æœåŠ¡å‘ç°æœºåˆ¶å®ƒçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œå®ƒå…¶å®æ˜¯ä¸€ç§Java Beançš„åŠ¨æ€æ›¿æ¢å‘ç°çš„æœºåˆ¶ï¼Œç±»æ¯”Springä½ å°±ä¼šå‘ç°ä»–ä»¬è§£å†³çš„é—®é¢˜æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä¸ºäº†è®©ç¨‹åºèƒ½å¤Ÿæ¶ˆé™¤éƒ¨åˆ†çš„ç¡¬ç¼–ç ã€‚ ä»€ä¹ˆæ˜¯ç¡¬ç¼–ç &emsp;&emsp;ä¸ºäº†èƒ½å¤Ÿæ›´åŠ æ·±å…¥çš„ç†è§£SPIæœºåˆ¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å…ˆæ˜ç™½ç¡¬ç¼–ç æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆç¨‹åºä¸­è¦å°½å¯èƒ½æ¶ˆé™¤ç¡¬ç¼–ç ï¼Ÿåœ¨è¿™é‡Œå¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡æ–‡ç« ï¼šè¯¦è§£æ§åˆ¶åè½¬ SPIçš„ä½¿ç”¨åœºæ™¯ æ•°æ®åº“é©±åŠ¨åŠ è½½æ¥å£å®ç°ç±»çš„åŠ è½½ï¼ŒJDBCåŠ è½½ä¸åŒç±»å‹æ•°æ®åº“çš„é©±åŠ¨ æ—¥å¿—é—¨é¢æ¥å£å®ç°ç±»åŠ è½½ï¼ŒSLF4JåŠ è½½ä¸åŒæä¾›å•†çš„æ—¥å¿—å®ç°ç±» Springä¸­å¤§é‡ä½¿ç”¨äº†SPIï¼Œæ¯”å¦‚ï¼šå¯¹servlet3.0è§„èŒƒå¯¹ServletContainerInitializerçš„å®ç°ã€è‡ªåŠ¨ç±»å‹è½¬æ¢Type Conversion SPI(Converter SPIã€Formatter SPI)ç­‰ Dubboä¸­ä¹Ÿå¤§é‡ä½¿ç”¨SPIçš„æ–¹å¼å®ç°æ¡†æ¶çš„æ‰©å±•, ä¸è¿‡å®ƒå¯¹Javaæä¾›çš„åŸç”ŸSPIåšäº†å°è£…ï¼Œä»¥è§£å†³åŸç”ŸSPIå¸¦æ¥çš„éƒ¨åˆ†å‰¯ä½œç”¨ Java-SPI&emsp;&emsp;æˆ‘ä»¬éƒ½çŸ¥é“Springæ˜¯ä»¥xmlçš„å½¢å¼é…ç½®Java Beanï¼Œç„¶åé€šè¿‡è§£ææ­¤æ–‡ä»¶å®ŒæˆBeançš„å®ä¾‹åŒ–ï¼ŒJava SPIåšçš„äº‹æƒ…æ˜¯ç±»ä¼¼çš„ï¼Œå®ƒå°†è¯»å–META-INF/servicesç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åç§°æ˜¯æ¥å£çš„å…¨é™å®šåï¼Œå†…å®¹ä¸ºè¯¥æ¥å£å®ç°ç±»çš„æƒé™å®šåï¼Œä¸¾ä¸ªSPIçš„ä½¿ç”¨ç¤ºä¾‹ å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ä¸ä¸€ç»„å®ç°ç±»å¦‚ä¸‹ package com.exp.spi; public interface IService { String getServiceName(); } public class MenuService implements IService { @Override public String getServiceName() { return &quot;èœå•æœåŠ¡&quot;; } } public class UserService implements IService { @Override public String getServiceName() { return &quot;ç”¨æˆ·æœåŠ¡&quot;; } } åœ¨ src/main/resources/ ä¸‹å»ºç«‹ /META-INF/services ç›®å½•ï¼Œæ–°å¢æ–‡ä»¶com.exp.spi.IServiceå†…å®¹å¦‚ä¸‹ com.exp.spi.MenuService com.exp.spi.UserService ä½¿ç”¨ ServiceLoader æ¥åŠ è½½é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„å®ç° public class SPIMain { public static void main(String[] args) { ServiceLoader&lt;IService&gt; services = ServiceLoader.load(IService.class); for (IService s : services) { System.out.println(s.getServiceName()); } } } è¿è¡Œæ­¤ç¨‹åºå°†ä¼šè¾“å‡ºä»¥ä¸‹å†…å®¹ èœå•æœåŠ¡ ç”¨æˆ·æœåŠ¡&emsp;&emsp;çœ‹åˆ°è¿™é‡Œä½ ä¼šå‘ç°è¿™æ˜¯ä¸æ˜¯ç‰¹åˆ«åƒSpringBootä¸­æˆ‘ä»¬å®šä¹‰çš„è‡ªåŠ¨åŒ–é…ç½®æ–‡ä»¶META-INF/spring.factoriesï¼Œè¿™é‡Œé¢å†™çš„ä¹Ÿæ˜¯è‡ªåŠ¨åŒ–é…ç½®ç±»çš„å…¨é™å®šåï¼Œå…¶å®å®ƒçš„å®ç°åŸç†å’ŒJava SPIæ˜¯ä¸€æ ·çš„ï¼Œåœ¨äº†è§£SpringBoot SPIä¹‹å‰æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹Java SPIçš„å®ç°åŸç†ã€‚ ä»å…¥å£å‡½æ•°æ¥çœ‹å¾ˆå®¹æ˜“æ‰¾åˆ°æ ¸å¿ƒç±»ï¼ŒæŸ¥çœ‹ServiceLoaderæºç å¦‚ä¸‹ &emsp;&emsp;ä»£ç é‡ä¸å¤šï¼Œæˆ‘ä»¬ä¸»è¦æ¥è¯»ä¸€ä¸‹loadæ–¹æ³•å› ä¸ºæˆ‘ä»¬çš„ä¾‹å­ä¸­å°±æ˜¯è°ƒç”¨çš„å®ƒï¼Œå¯ä»¥çœ‹åˆ°å®ƒæŒ‡å‘äº†æ„é€ å‡½æ•°ï¼Œè€Œæ„é€ å‡½æ•°è°ƒç”¨äº†reloadæ–¹æ³•æœ€ç»ˆè¿”å›äº†ä¸€ä¸ªè¿­ä»£å™¨ &emsp;&emsp;è¿­ä»£å™¨è´Ÿè´£åœ¨éå†æ—¶è°ƒç”¨newInstanceæ–¹æ³•æ„é€ é…ç½®æ–‡ä»¶ä¸­çš„æ¥å£å®ç°ç±»ï¼Œæ‰€ä»¥è¿™ä¹Ÿè¦æ±‚å®ç°ç±»å¿…é¡»è¦æœ‰ä¸€ä¸ªæ— å‚æ„é€ ï¼Œç”±äºè¿”å›çš„æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¦‚æœä½ åªæƒ³ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­ä¸­ä½ åªæƒ³ç”¨UserServiceï¼Œä½ å¿…é¡»è¦éå†å…¨éƒ¨çš„æœåŠ¡æ‰èƒ½ç­›é€‰å‡ºä½ è¦çš„é‚£ä¸ªç±»ï¼Œè€Œè¿™ä¹ˆåšå…¨éƒ¨çš„å®ç°ç±»éƒ½å°†è¢«å®ä¾‹åŒ–ï¼Œé€ æˆäº†èµ„æºçš„æµªè´¹ï¼Œæ­£æ˜¯å› ä¸ºè¿™äº›å‰¯ä½œç”¨çš„å­˜åœ¨ï¼Œå¾ˆå¤šæ¡†æ¶æ‰å»å®ç°äº†è‡ªå·±çš„SPIã€‚ SpringBoot-SPI&emsp;&emsp;SpringBootçš„SPIæœºåˆ¶ç”±spring-coreå·¥ç¨‹ä¸­çš„org.springframework.core.io.support.SpringFactoriesLoaderå®ç°ï¼Œæºç å¦‚ä¸‹ï¼Œä»£ç æ¯”è¾ƒç®€å•å°±ä¸åšè¿‡æè¿°äº†ï¼Œè¿™é‡Œè¦è®²çš„æ˜¯å¦‚æœèƒ½åœ¨çœ‹åˆ°å¹¶ä¸”ç†è§£äº†Java SPIçš„æ—¶å€™å°±å…³è”åˆ°äº†SpringBootçš„è‡ªåŠ¨åŒ–é…ç½®åŸç†ï¼Œå°±æ‹¥æœ‰äº†ä¸¾ä¸€åä¸‰çš„å­¦ä¹ èƒ½åŠ›ï¼Œè¿™æ‰æ˜¯æœ€é‡è¦çš„ã€‚ å°ç»“-SPI&emsp;&emsp;çœ‹åˆ°è¿™é‡Œå…¶å®éƒ½èƒ½å¤Ÿæ¸…æ¥šçŸ¥é“SPIçš„å¤§æ¦‚ç”¨æ³•ä¸åº”ç”¨åœºæ™¯ï¼Œåˆšæ‰æˆ‘ä»¬ä¹Ÿè¯´åˆ°Java SPIçš„ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯æ— æ³•åšåˆ°æŒ‰éœ€åŠ è½½ï¼Œé‚£ä¹ˆå®ƒè¿˜æœ‰æ²¡æœ‰åˆ«çš„ç¼ºç‚¹ã€‚ å›åˆ°æœ€åˆçš„ä¾‹å­ï¼ŒåŸºäºIServiceæˆ‘ä»¬è®¾è®¡äº†UserServiceä¸MenuServiceï¼Œå‡è®¾ç°åœ¨æˆ‘æœ‰ä¸€ä¸ªéœ€æ±‚è¦åœ¨UserServiceä¸­å»è°ƒç”¨MenuServiceçš„æœåŠ¡ï¼Œä½¿ç”¨Java SPIå°±æ— æ³•å®ç°åŠ¨æ€æ³¨å…¥çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆSpringBoot SPIæœ‰æ²¡æœ‰å¯¹åŠ¨æ€æ³¨å…¥çš„åŠŸèƒ½æä¾›æ”¯æŒå‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨çœ‹çœ‹ä»£ç  ä¸éš¾å‘ç°è¿™é‡Œä¹Ÿæ˜¯è°ƒç”¨newInstanceæ–¹æ³•æ¥å®Œæˆå®ä¾‹åŒ–çš„ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æ„é€ å‡½æ•°åšå‚æ•°æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬å†™è‡ªåŠ¨åŒ–é…ç½®ç±»çš„æ—¶å€™æ˜¯å¯ä»¥ä½¿ç”¨æ³¨è§£å®ŒæˆJava Beançš„åŠ¨æ€æ³¨å…¥çš„ï¼Œè¿™é‡Œçš„è¹Šè··ä¹‹å¤„æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±å»æŒ–ä¸€æŒ–ï¼Œåœ¨æœ‰äº†å…¥å£å¹¶äº†è§£äº†Springçš„æ ¸å¿ƒç»„ä»¶çš„å‰æä¸‹ï¼Œè¿™ä¸€éƒ¨åˆ†å¹¶ä¸éš¾æ‡‚ï¼Œè¿™ä¹Ÿæ˜¯åœ¨å­¦ä¹ ä¸Šä¸¾ä¸€åä¸‰çš„å¥½æ—¶å€™ã€‚ Dubbo-SPI&emsp;&emsp;æœ‰å…³Dubbo SPIå®ƒçš„å®ç°å°±è¾ƒä¸ºå¤æ‚äº†ï¼Œå®ƒçš„é…ç½®ä¸ä¸Šé¢è®²çš„æ–¹å¼ä¹Ÿç¨æœ‰ä¸åŒï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­çš„é…ç½®éœ€è¦æ›´æ”¹æˆ menuService=com.exp.spi.MenuService userService=com.exp.spi.UserService ä¸éš¾çœ‹å‡ºè¿™æ˜¯ä¸ªé”®å€¼å¯¹çš„é…ç½®æ–¹å¼ï¼Œç­‰å·å·¦è¾¹æ˜¯è¯¥æœåŠ¡çš„keyï¼Œå³è¾¹ä¸ºæœåŠ¡çš„å…¨é™å®šåï¼Œå…³äºDubbo SPIçš„å…·ä½“è¯´å‡ºå¯ä»¥å‚è€ƒDubbo ä¹‹äº SPI æ‰©å±•æœºåˆ¶çš„å®ç°åˆ†æè¿™ç¯‡æ–‡ç« ï¼Œå› ä¸ºä»–è®²çš„æ¯”æˆ‘å¥½ï¼Œæºœäº† å‚è€ƒèµ„æ–™ ç†è§£çš„Javaä¸­SPIæœºåˆ¶ Dubbo ä¹‹äº SPI æ‰©å±•æœºåˆ¶çš„å®ç°åˆ†æ JDKå’ŒSpringä¸­SPIçš„å®ç°åŸç†å’ŒåŒºåˆ«","link":"/2019-09-01-spi-spring-dubbo/"},{"title":"éšç¬”â€”â€”å¦‚ä½•ä¼˜é›…çš„éå†æ ‘ç»“æ„","text":"&emsp;&emsp;åœ¨ç¼–ç¨‹ç”Ÿæ¶¯ä¸­æˆ‘ä»¬ä¼šç¢°ä¸Šå„å¼å„æ ·çš„æ•°æ®ç»“æ„ï¼Œç®€å•çš„å¦‚æ•°ç»„ã€åˆ—è¡¨ã€å­—å…¸ï¼Œå¤æ‚ä¸€ç‚¹çš„å¦‚æ ‘ç»“æ„ã€å›¾ç­‰ç­‰ï¼Œæœ¬æ–‡å°†åŸºäºJava8è®²è¿°å¦‚ä½•ä¼˜é›…çš„å®ç°æ ‘çš„éå†ã€æ‰“å°ã€å¹³é“ºã€èšåˆæ“ä½œã€‚ æ ‘ç»“æ„æè¿°&emsp;&emsp;æœ¬æ–‡å›´ç»•çš„æ ‘ç»“æ„å¤§ä½“æ ·ä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™ç§ç»“æ„å¸¸ç”¨äºæˆ‘ä»¬Webç³»ç»Ÿçš„èœå•æ•°æ®ç»“æ„çš„å­˜å‚¨ï¼Œåœ¨æ•°æ®åº“æˆ‘ä»¬ä¸€èˆ¬æ˜¯å¹³é“ºå­˜å‚¨ï¼Œä½†æ˜¯ä½¿ç”¨æ—¶éœ€è¦èšåˆæˆæ ‘çŠ¶ç»“æ„ï¼Œåœ¨å¹³æ—¶çš„å®ä½“è®¾è®¡ä¸­ï¼Œå…³äºå­é¡¹çš„keyä¸ä¸€å®šå°±å«childrensï¼Œæ‰€ä»¥æœ¬æ–‡æœ€ç»ˆè®¾è®¡çš„å·¥å…·ç±»ä¹Ÿéœ€è¦è®¾è®¡çš„æ›´ä¸ºé€šç”¨ private Integer id; private String name; private Integer parentId; private List&lt;Node&gt; childrens; å¸¸ç”¨çš„éå†æ–¹å¼é€’å½’public static void traversing(List&lt;Node&gt; root) { for (Node node : root) { List&lt;Node&gt; childres = node.getChildrens(); if (childres != null &amp;&amp; childres.size() &gt; 0) { traversing(childres); } } } æ ˆpublic static void traversing(List&lt;Node&gt; root) { Stack&lt;Node&gt; stack = new Stack&lt;&gt;(); root.forEach(stack::push); while (!stack.isEmpty()) { Node o = stack.pop(); List&lt;Node&gt; childrens = o.getChildrens(); if (childrens != null &amp;&amp; childrens.size() &gt; 0) { childrens.forEach(stack::push); } } } å¦‚ä½•é€šç”¨æ€è€ƒ&emsp;&emsp;è¦åšåˆ°å·¥å…·é€šç”¨å°±è¦è€ƒè™‘å“ªä¸€å—æ˜¯å˜åŒ–çš„éƒ¨åˆ†ï¼Œåœ¨æˆ‘ä»¬çš„æ ‘ç»“æ„å®ä½“æ¨¡å‹ä¸­æœ‰å‡ ä¸ªæ ¸å¿ƒçš„å­—æ®µï¼Œè¿™å‡ ä¸ªå­—æ®µæ¯ä¸ªäººåœ¨è®¾è®¡è‡ªå·±ä¸šåŠ¡æ¨¡å‹ä¸­éƒ½å¯èƒ½ä¸ä¸€æ ·ï¼Œä½†å´æ˜¯å¿…ç„¶å­˜åœ¨çš„ å­èŠ‚ç‚¹å­—æ®µ èŠ‚ç‚¹IDå­—æ®µ çˆ¶èŠ‚ç‚¹IDå­—æ®µ éœ€è¦ç»Ÿä¸€è¿™ç§å˜åŒ–çš„éƒ¨åˆ†æˆ‘ä»¬ä¸€èˆ¬ä¼šæœ‰ä¸¤ç§è§£å†³åŠæ³• å»ºç«‹ä¸€ä¸ªTreeNodeæ¥å£ï¼Œå†™ä¸Šä¸‰ä¸ªå‡½æ•°è®©ç”¨æˆ·è®¾è®¡å®ä½“æ—¶å¿…é¡»å»å®ç°æ­¤æ¥å£æ‰èƒ½ç”¨ä½ çš„å·¥å…·ç±» åˆ©ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³å°†è¿™å‡ ä¸ªè·å–æ“ä½œæŠ½è±¡æˆå‚æ•°ä¼ é€’ï¼Œæ˜¾ç„¶ï¼Œè¿™ç§åŠæ³•å¯¹ç”¨æˆ·æ¥è¯´æ˜¯æ›´åŠ å‹å¥½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ¬¡ä¼šåŸºäºæ­¤æ–¹æ¡ˆæ¥å®ç°å·¥å…·ç±» åœ¨å®ç°ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹Javaä¸­çš„å‡½æ•°å¼ç¼–ç¨‹æ¥å£ Java8-function-apiä»‹ç»Java8çš„java.util.functionåŒ…ä¸‹æä¾›äº†å¾ˆå¤šæ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„ç±»ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å¾ˆå¥½çš„æŠ½è±¡å˜åŒ–çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹function apiçš„å½’çº³ï¼ŒJava8ä¸»è¦æä¾›äº†ä»¥ä¸‹ç±»æ¥æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼Œå…¶ä¸­æ ‡äº†é‡ç‚¹çš„æ˜¯è¿™æ¬¡ç¼–å†™å·¥å…·æ‰€ä½¿ç”¨åˆ°çš„ç±»ã€‚ ç±» æè¿° BiConsumer&lt;T,U&gt; ä»£è¡¨äº†ä¸€ä¸ªæ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°çš„æ“ä½œï¼Œå¹¶ä¸”ä¸è¿”å›ä»»ä½•ç»“æœ BiFunction&lt;T,U,R&gt; ä»£è¡¨äº†ä¸€ä¸ªæ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªç»“æœ BinaryOperator ä»£è¡¨äº†ä¸€ä¸ªä½œç”¨äºäºä¸¤ä¸ªåŒç±»å‹æ“ä½œç¬¦çš„æ“ä½œï¼Œè¿”å›äº†æ“ä½œç¬¦åŒç±»å‹çš„ç»“æœ BiPredicate&lt;T,U&gt; ä»£è¡¨äº†ä¸€ä¸ªä¸¤ä¸ªå‚æ•°çš„booleanå€¼æ–¹æ³• BooleanSupplier ä»£è¡¨äº†booleanå€¼ç»“æœçš„æä¾›æ–¹ Consumer ä»£è¡¨äº†æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°å¹¶ä¸”æ— è¿”å›çš„æ“ä½œ DoubleBinaryOperator ä»£è¡¨äº†ä½œç”¨äºä¸¤ä¸ªdoubleå€¼æ“ä½œç¬¦çš„æ“ä½œï¼Œå¹¶ä¸”è¿”å›äº†ä¸€ä¸ªdoubleå€¼çš„ç»“æœ DoubleConsumer ä»£è¡¨ä¸€ä¸ªæ¥å—doubleå€¼å‚æ•°çš„æ“ä½œï¼Œå¹¶ä¸”ä¸è¿”å›ç»“æœ DoubleFunction ä»£è¡¨æ¥å—ä¸€ä¸ªdoubleå€¼å‚æ•°çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›ç»“æœ DoublePredicate ä»£è¡¨ä¸€ä¸ªæ‹¥æœ‰doubleå€¼å‚æ•°çš„booleanå€¼æ–¹æ³• DoubleSupplier ä»£è¡¨ä¸€ä¸ªdoubleå€¼ç»“æ„çš„æä¾›æ–¹ DoubleToIntFunction æ¥å—ä¸€ä¸ªdoubleç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœ DoubleToLongFunction æ¥å—ä¸€ä¸ªdoubleç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœ DoubleUnaryOperator æ¥å—ä¸€ä¸ªå‚æ•°åŒä¸ºç±»å‹double,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºdouble Function&lt;T,R&gt; æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœ IntBinaryOperator æ¥å—ä¸¤ä¸ªå‚æ•°åŒä¸ºç±»å‹int,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºint IntConsumer æ¥å—ä¸€ä¸ªintç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ IntFunction æ¥å—ä¸€ä¸ªintç±»å‹è¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœ IntPredicate æ¥å—ä¸€ä¸ªintè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„ç»“æœ IntSupplier æ— å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœ IntToDoubleFunction æ¥å—ä¸€ä¸ªintç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ IntToLongFunction æ¥å—ä¸€ä¸ªintç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœ IntUnaryOperator æ¥å—ä¸€ä¸ªå‚æ•°åŒä¸ºç±»å‹int,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºint LongBinaryOperator æ¥å—ä¸¤ä¸ªå‚æ•°åŒä¸ºç±»å‹long,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºlong LongConsumer æ¥å—ä¸€ä¸ªlongç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ LongFunction æ¥å—ä¸€ä¸ªlongç±»å‹è¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœ LongPredicate æ¥å—ä¸€ä¸ªlongè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ç±»å‹ç»“æœ LongSupplier æ— å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœlongç±»å‹çš„å€¼ LongToDoubleFunction æ¥å—ä¸€ä¸ªlongç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ LongToIntFunction æ¥å—ä¸€ä¸ªlongç±»å‹è¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœ LongUnaryOperator æ¥å—ä¸€ä¸ªå‚æ•°åŒä¸ºç±»å‹long,è¿”å›å€¼ç±»å‹ä¹Ÿä¸ºlong ObjDoubleConsumer æ¥å—ä¸€ä¸ªobjectç±»å‹å’Œä¸€ä¸ªdoubleç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ ObjIntConsumer æ¥å—ä¸€ä¸ªobjectç±»å‹å’Œä¸€ä¸ªintç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ ObjLongConsumer æ¥å—ä¸€ä¸ªobjectç±»å‹å’Œä¸€ä¸ªlongç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œæ— è¿”å›å€¼ Predicate æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ç»“æœ Supplier æ— å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœ ToDoubleBiFunction&lt;T,U&gt; æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ ToDoubleFunction æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªdoubleç±»å‹ç»“æœ ToIntBiFunction&lt;T,U&gt; æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœ ToIntFunction æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintç±»å‹ç»“æœ ToLongBiFunction&lt;T,U&gt; æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœ ToLongFunction æ¥å—ä¸€ä¸ªè¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªlongç±»å‹ç»“æœ UnaryOperator æ¥å—ä¸€ä¸ªå‚æ•°ä¸ºç±»å‹Tï¼Œè¿”å›å€¼ç±»å‹ä¹Ÿä¸ºT å·¥å…·ç±»è®¾è®¡ åˆ©ç”¨Function&lt;T,R&gt;æ¥æŠ½è±¡å­èŠ‚ç‚¹/èŠ‚ç‚¹Key/èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹Keyçš„è·å–é€»è¾‘ åˆ©ç”¨Consumer&lt;T&gt;æ¥æŠ½è±¡éå†åˆ°èŠ‚ç‚¹åçš„é€»è¾‘æ“ä½œï¼Œæ¯”å¦‚æ‰“å°/æ’å…¥å…¶ä»–æ•°æ®ç»“æ„ åˆ©ç”¨BiConsumer&lt;T,U&gt;æ¥æŠ½è±¡èŠ‚ç‚¹çš„å†™å…¥æ“ä½œï¼Œå¦‚èšåˆæ ‘æ—¶çš„å­èŠ‚ç‚¹å†™å…¥æ“ä½œ èŠ‚ç‚¹éå†æ–¹é¢ä½¿ç”¨æ ˆæ¥å®ç°ï¼Œé˜²æ­¢åœ¨æ ‘ç»“æ„æ·±åº¦æ¯”è¾ƒå¤§æ—¶çˆ†æ ˆ /** * @author JianhuiChen * @description æ ‘çŠ¶ç»“æ„å·¥å…·ç±» æä¾›é€šç”¨æ ‘ç»“æ„çš„å¹³é“º/èšåˆæ–¹æ³• * @date 2019-08-29 */ public class TreeUtil { /** * éå†æ ‘ç»“æ„ * * @param root èŠ‚ç‚¹æ ‘ç»“æ„ * @param loadChildrenNodes åŠ è½½æ ‘çš„å­èŠ‚ç‚¹åˆ—è¡¨å‡½æ•° æ¥æ”¶ä¸€ä¸ªèŠ‚ç‚¹ è¿”å›èŠ‚ç‚¹çš„å­ç»“æ„ * @param behavior éå†åˆ°çš„èŠ‚ç‚¹è¡Œä¸º * @param &lt;T&gt; æ ‘èŠ‚ç‚¹å¯¹è±¡ */ public static &lt;T&gt; void traversing(List&lt;T&gt; root, Function&lt;T, List&lt;T&gt;&gt; loadChildrenNodes, Consumer&lt;T&gt; behavior) { Stack&lt;T&gt; stack = new Stack&lt;&gt;(); root.forEach(stack::push); while (!stack.isEmpty()) { T o = stack.pop(); behavior.accept(o); List&lt;T&gt; childrens = loadChildrenNodes.apply(o); if (childrens != null &amp;&amp; childrens.size() &gt; 0) { childrens.forEach(stack::push); } } } /** * å¹³é“ºæ ‘ç»“æ„ * * @param root èŠ‚ç‚¹æ ‘ç»“æ„ * @param loadChildrenNodes åŠ è½½æ ‘çš„å­èŠ‚ç‚¹åˆ—è¡¨å‡½æ•° æ¥æ”¶ä¸€ä¸ªèŠ‚ç‚¹ è¿”å›èŠ‚ç‚¹çš„å­ç»“æ„ * @param &lt;T&gt; æ ‘èŠ‚ç‚¹å¯¹è±¡ * @return å¹³é“ºç»“æ„ */ public static &lt;T&gt; List&lt;T&gt; tileTree(List&lt;T&gt; root, Function&lt;T, List&lt;T&gt;&gt; loadChildrenNodes) { List&lt;T&gt; list = new ArrayList&lt;&gt;(); traversing(root, loadChildrenNodes, list::add); return list; } /** * æ‰“å°æ ‘ä¿¡æ¯ * * @param list æ ‘ç»“æ„åˆ—è¡¨ * @param loadChildrenNodes åŠ è½½æ ‘çš„å­èŠ‚ç‚¹åˆ—è¡¨å‡½æ•° æ¥æ”¶ä¸€ä¸ªèŠ‚ç‚¹ è¿”å›èŠ‚ç‚¹çš„å­ç»“æ„ * @param &lt;T&gt; æ ‘èŠ‚ç‚¹å¯¹è±¡ */ public static &lt;T&gt; void printTree(List&lt;T&gt; list, Function&lt;T, List&lt;T&gt;&gt; loadChildrenNodes) { System.out.println(&quot;---------- Tree Nodes Print ----------&quot;); traversing(list, loadChildrenNodes, System.out::println); System.out.println(&quot;---------- Tree Nodes Print ----------&quot;); } /** * èšåˆæ ‘ç»“æ„ * * @param list èŠ‚ç‚¹åˆ—è¡¨ç»“æ„ * @param loadKey èŠ‚ç‚¹å”¯ä¸€keyè¯»å– æ¥æ”¶ä¸€ä¸ªèŠ‚ç‚¹ è¿”å›èŠ‚ç‚¹çš„å”¯ä¸€key * @param loadParentKey èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹keyè¯»å– æ¥æ”¶ä¸€ä¸ªèŠ‚ç‚¹ è¿”å›èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹key * @param write èŠ‚ç‚¹å­é¡¹å†™å…¥å‡½æ•° æ¥æ”¶å¾…å†™å…¥èŠ‚ç‚¹ä¸èŠ‚ç‚¹å­é¡¹ è´Ÿè´£å°†å­èŠ‚ç‚¹å†™å…¥ * @param &lt;T&gt; èŠ‚ç‚¹å¯¹è±¡ * @param &lt;R&gt; èŠ‚ç‚¹å”¯ä¸€keyå¯¹è±¡ * @return æ ‘ç»“æ„ */ public static &lt;T, R&gt; List&lt;T&gt; polymerizationTree(List&lt;T&gt; list, Function&lt;T, R&gt; loadKey, Function&lt;T, R&gt; loadParentKey, BiConsumer&lt;T, List&lt;T&gt;&gt; write) { List&lt;T&gt; root = list.stream().filter(o -&gt; loadParentKey.apply(o) == null).collect(Collectors.toList()); Stack&lt;T&gt; stack = new Stack&lt;&gt;(); root.forEach(stack::push); while (!stack.isEmpty()) { T o = stack.pop(); R key = loadKey.apply(o); List&lt;T&gt; childrens = list.stream() .filter(k -&gt; key.equals(loadParentKey.apply(k))) .collect(Collectors.toList()); write.accept(o, childrens); if (childrens.size() &gt; 0) { childrens.forEach(stack::push); } } return root; } public static void main(String[] args) { List&lt;Node&gt; listNodes = new ArrayList&lt;&gt;(); listNodes.add(new Node(1, &quot;æ ¹èŠ‚ç‚¹1&quot;, null)); listNodes.add(new Node(2, &quot;æ ¹èŠ‚ç‚¹2&quot;, null)); listNodes.add(new Node(3, &quot;æ ¹èŠ‚ç‚¹3&quot;, null)); listNodes.add(new Node(4, &quot;1-1&quot;, 1)); listNodes.add(new Node(5, &quot;1-2&quot;, 1)); listNodes.add(new Node(6, &quot;2-1&quot;, 2)); listNodes.add(new Node(7, &quot;3-1&quot;, 3)); listNodes.add(new Node(8, &quot;1-1-1&quot;, 4)); listNodes.add(new Node(9, &quot;1-1-2&quot;, 4)); printTree(listNodes, Node::getChildrens); // èšåˆ List&lt;Node&gt; treeNodes = polymerizationTree(listNodes, Node::getId, Node::getParentId, Node::setChildrens); printTree(treeNodes, Node::getChildrens); // å¹³é“º listNodes = tileTree(treeNodes, Node::getChildrens); printTree(listNodes, Node::getChildrens); } private static class Node { private Integer id; private String name; private Integer parentId; private List&lt;Node&gt; childrens; public Node(Integer id, String name, Integer parentId) { this.id = id; this.name = name; this.parentId = parentId; } public Integer getId() { return id; } public void setId(Integer id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public Integer getParentId() { return parentId; } public void setParentId(Integer parentId) { this.parentId = parentId; } public List&lt;Node&gt; getChildrens() { return childrens; } public void setChildrens(List&lt;Node&gt; childrens) { this.childrens = childrens; } @Override public String toString() { return &quot;Node{&quot; + &quot;id=&quot; + id + &quot;, name='&quot; + name + '\\'' + '}'; } } }","link":"/2019-08-29-essay/"},{"title":"Shellå­¦ä¹ ä¸å½’çº³","text":"&emsp;&emsp;ä½œä¸ºä¸€ä¸ªåç«¯å¼€å‘å·¥ç¨‹å¸ˆåœ¨å·¥ä½œä¸­ä¸å¯èƒ½ä¸ä¸LinuxæœåŠ¡å™¨æ‰“äº¤é“ï¼Œåº”ç”¨çš„éƒ¨ç½²æµ‹è¯•ï¼Œä¸­é—´ä»¶çš„ç¯å¢ƒæ­å»ºï¼Œæ­å»ºä¸ªäººçš„åšå®¢ï¼Œç”šè‡³ç©ç©æ ‘è“æ´¾è¿™äº›æ¯”è¾ƒå†·é—¨çš„å•ç‰‡æœºè®¡ç®—æœºéƒ½ç¦»ä¸å¼€LinuxæŒ‡ä»¤ä¸Shellç¼–ç¨‹ï¼Œæœ¬æ–‡å°±æ¥å­¦ä¹ ä¸å½’çº³ä¸€äº›æˆ‘ä¸ªäººç”¨åˆ°çš„LinuxæŒ‡ä»¤ä¸Shellè¯­æ³•å¹¶ç»™å‡ºç¤ºä¾‹ï¼Œæœ¬æ–‡åªè®²åŸºç¡€ï¼Œç»†ææœ«èŠ‚å°†å¦èµ·åšæ–‡è¯¦ç»†åˆ†æã€‚ Shellè¯­æ³•å½’çº³å˜é‡ä¸å‚æ•°å˜é‡å®šä¹‰ä¸å¼•ç”¨#!/bin/sh str=&quot;My name is JianhuiChen.&quot; echo ${str} str=&quot;Reset my name&quot; echo ${str} unset str echo ${str} å‚æ•°å¼•ç”¨#!/bin/sh echo &quot;ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š$1&quot; echo &quot;ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š$2&quot; echo &quot;ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°ä¸ºï¼š$#&quot; echo &quot;æ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ä¸ºï¼š$*&quot; echo &quot;è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹IDå·ä¸ºï¼š$$&quot; echo &quot;åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„IDå·ä¸ºï¼š$!&quot; echo &quot;æ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ä¸ºï¼š$@&quot; echo &quot;Shellä½¿ç”¨çš„å½“å‰é€‰é¡¹ä¸ºï¼š$-&quot; echo &quot;æœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ä¸ºï¼š$?&quot; é€»è¾‘åˆ¤æ–­ã€å¾ªç¯ä¸åˆ†æ”¯é€‰æ‹©é€»è¾‘åˆ¤æ–­#!/bin/sh x=5 y=10 z=20 # if then echo &quot;if then command&quot; if [ $x != $y ] then echo &quot;$x != $y&quot; echo &quot;Print again $x == $y&quot; fi # if else echo &quot;if else command&quot; if [ $x != $y ] then echo &quot;$x != $y&quot; echo &quot;Print again $x != $y&quot; else echo &quot;$x == $y&quot; fi # if else-if else echo &quot;if else-if else command&quot; if [ $x == $y ] then echo &quot;$x == $y&quot; elif [ $y == $z ] then echo &quot;$x != $y and $y == $z&quot; else echo &quot;$x != $y and $y != $z&quot; fi å¾ªç¯#!/bin/sh # Define array arr=(1 2 3 4 5) # For loop echo &quot;For loop&quot; for var in ${arr[*]} do echo &quot;$var&quot; done # While loop echo &quot;While loop&quot; i=0 while (( $i &lt; ${#arr[*]} )) do echo &quot;${arr[$i]}&quot; let &quot;i++&quot; done # Break and continue echo &quot;Break and continue&quot; j=0 while [[ $j &lt; ${#arr[*]} ]] do if [ $j == 3 ] then echo &quot;Break in ${arr[$j]}&quot; break elif [ $j == 1 ] then echo &quot;Dump ${arr[$j]}&quot; let &quot;j++&quot; continue else echo &quot;Print ${arr[$j]}&quot; fi let j++ done åˆ†æ”¯é€‰æ‹©#!/bin/sh x=3 case $x in 1) echo 'Case 1' ;; 2) echo 'Case 2' ;; 3) echo 'Case 3' ;; 4) echo 'Case 4' ;; *) echo 'Default' ;; esac è¾“å‡ºé‡å®šå‘#!/bin/sh export BIN_PATH=$(cd `dirname $0`;pwd) echo BIN_PATH:[$BIN_PATH] # è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ &gt;&gt; ä»£è¡¨è¿½åŠ  nohup ping 127.0.0.1 &gt; exec.log 2&gt;&amp;1 &amp; echo [if you want stop app, can run] kill -9 $! echo [if you want search logs, can run] tail -f $BIN_PATH/exec.log ç¬¬ä¸€æ¬¡çœ‹åˆ°nohup ping 127.0.0.1 &gt; exec.log 2&gt;&amp;1 &amp;è¿™æ¡è¯­å¥çš„åŒå­¦å¯èƒ½ä¼šæœ‰ç‚¹æ‡µé€¼ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸€æ®µä¸€æ®µæ¥ç†è§£è¿™æ¡è¯­å¥ nohubï¼šå½“å‰è¿›ç¨‹é€€å‡ºåè¿è¡Œç¨‹åºä¸é€€å‡ºï¼Œä¹Ÿå°±æ˜¯åå°è¿è¡Œ ping 127.0.0.1ï¼šå…·ä½“æ‰§è¡Œçš„è¯­å¥ï¼Œè¿™å¥å°±ä¸è¿‡å¤šè§£é‡Šäº† &gt; exec.logï¼šå°†è¯­å¥æ‰§è¡Œçš„ç»“æœè¾“å‡ºåˆ°shellè„šæœ¬åŒçº§ç›®å½•çš„exec.logæ–‡ä»¶ï¼Œé‡‡ç”¨è¦†ç›–çš„æ¨¡å¼ï¼Œå¦‚æœæ˜¯è¿½åŠ è¾“å‡ºå¯ä½¿ç”¨&gt;&gt;æ›¿æ¢&gt; 2&gt;&amp;1ï¼šè¿™å¥å¯èƒ½ä¼šå¤æ‚ç‚¹ï¼Œæ„æ€æ˜¯å°†æ ‡å‡†é”™è¯¯ç­‰æ•ˆäºæ ‡å‡†è¾“å‡ºï¼Œå…¶ä¸­&amp;èµ·åˆ°äº†ç­‰æ•ˆçš„ä½œç”¨ 0 è¡¨ç¤ºstdinæ ‡å‡†è¾“å…¥ 1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡º 2 è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯ æœ€åä¸€ä¸ª&amp;ï¼šè¿™ä¸ªæ˜¯é…åˆnohubä½¿ç”¨çš„ï¼Œæ„æ€æ˜¯åœ¨è„šæœ¬çš„ç»“å°¾è®©ç¨‹åºè‡ªåŠ¨è¿è¡Œï¼Œæ²¡æœ‰æ­¤æŒ‡ä»¤è„šæœ¬è¿è¡Œä¼šå¡åœ¨nohubå¤„éœ€è¦æŒ‰ä¸€ä¸‹ä»»æ„é”®æ‰å¯ç»§ç»­æ‰§è¡Œ LinuxæŒ‡ä»¤ä¸å¸¸ç”¨åº“å½’çº³æ–‡ä»¶ä¸ç›®å½• lsï¼šåˆ—è¡¨æ˜¾ç¤ºæ–‡ä»¶ä¸ç›®å½•ä¿¡æ¯ treeï¼šæ ‘å½¢æ˜¾ç¤ºæ–‡ä»¶ä¸ç›®å½•ä¿¡æ¯ cdï¼šåˆ‡æ¢ç›®å½• mkdirï¼šåˆ›å»ºç›®å½• pwdï¼šä»¥ç»å¯¹è·¯å¾„çš„æ–¹å¼æ˜¾ç¤ºç”¨æˆ·å½“å‰å·¥ä½œç›®å½• cpï¼šæ‹·è´æ–‡ä»¶ rmï¼šåˆ é™¤æ–‡ä»¶ mvï¼šç§»åŠ¨æ–‡ä»¶ diffï¼šæ¯”è¾ƒæ–‡ä»¶å·®å¼‚ chmodï¼šæ–‡ä»¶æˆæƒ catï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹ headï¼šæ˜¾ç¤ºæ–‡ä»¶çš„å¤´å‡ è¡Œ tailï¼šæ˜¾ç¤ºæ–‡ä»¶çš„åå‡ è¡Œ touchï¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ tarï¼šå‹ç¼©ä¸è§£å‹ç¼© sedï¼šéäº¤äº’å¼æ–‡æœ¬ç¼–è¾‘ viï¼šäº¤äº’å¼æ–‡æœ¬ç¼–è¾‘ï¼ŒæŒ‰iæ’å…¥æ–‡æœ¬ç¼–è¾‘æ–‡ä»¶ï¼ŒæŒ‰ESCè¾“å…¥æŒ‡ä»¤é€€å‡º :wï¼šå†™å…¥æ–‡ä»¶ :w!ï¼šä¸è¯¢é—®æ–¹å¼å†™å…¥æ–‡ä»¶ :wqï¼šä¿å­˜å¹¶é€€å‡º :qï¼šé€€å‡º, :q!ï¼šä¸ä¿å­˜é€€å‡º å®Œæˆä¸‹é¢çš„è¯­å¥å¯¹ä½ è®°å¿†è¿™äº›åŸºç¡€æŒ‡ä»¤ä¼šæœ‰å¸®åŠ© #!/bin/sh # æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•ä¸å…¶ç»“æ„ pwd ls tree # åˆ›å»ºä¸€ä¸ªç›®å½• test-dir mkdir test-dir # è¿›å…¥æ­¤ç›®å½• cd test-dir # åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ README.md touch README.md # ç¼–è¾‘æ–‡ä»¶æ’å…¥ä¸€äº›å†…å®¹ vi README.md # æŸ¥çœ‹å†…å®¹ cat README.md # æŸ¥çœ‹æ–‡ä»¶çš„å‰ä¸¤è¡Œ head -n2 README.md # å¾ªç¯è¯»å–æ–‡ä»¶çš„åä¸‰è¡Œ tail -n3 -f README.md # å¤åˆ¶ README.md åˆ°åŒçº§ç›®å½• README-COPY.md cp README.md README-COPY.md # ä¿®æ”¹ README-COPY.md çš„å†…å®¹ vi README-COPY.md # ä¸åŸæ–‡ä»¶æ¯”è¾ƒå·®å¼‚æ€§ diff README.md README-COPY.md # ç§»åŠ¨ README.md åˆ°ä¸Šä¸€çº§ç›®å½• mv README.md .. # åˆ é™¤ä¸Šä¸€çº§ç›®å½•çš„ README.md rm ../README.md # å°† README-COPY.md é‡å‘½åä¸º README.md mv README-COPY.md README.md # æˆäºˆ README.md æƒé™ chmod +x README.md # å‹ç¼© test-dir ç›®å½• cd .. tar -czvf test-dir.tar.gz test-dir # åˆ é™¤ test-dir ç›®å½• å»ºè®®ä½¿ç”¨å‚æ•° -i è¿›å…¥è¯¢é—®æ¨¡å¼ rm -rf test-dir # è§£å‹ test-dir.tar.gz tar -xzvf test-dir.tar.gz ç½‘ç»œä¸å¸¸ç”¨åº“ ifconfigï¼šæŸ¥çœ‹ç½‘ç»œç½‘å¡ä¿¡æ¯ netstatï¼šæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ï¼ŒæŸ¥çœ‹ç½‘ç»œç«¯å£æˆ–è€…è·¯ç”±ä¿¡æ¯ lsofï¼šç”¨äºæŸ¥çœ‹ä½ è¿›ç¨‹å¼€æ‰“çš„æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶çš„è¿›ç¨‹ï¼Œè¿›ç¨‹æ‰“å¼€çš„ç«¯å£(TCPã€UDP) pingï¼šä¸å¤šè¯´äº† telnetï¼šæ‰§è¡Œè¿œç¨‹ç™»å½•ï¼Œå¯ç”¨æµ‹è¯•ç½‘ç»œç«¯å£é“¾è·¯æ˜¯å¦é€šç•… sshï¼šä½¿ç”¨sshåè®®è¿œç¨‹ç™»å½•ä¸»æœº scpï¼šç”¨äºLinuxä¹‹é—´å¤åˆ¶æ–‡ä»¶å’Œç›®å½• ftpï¼šåŸºäºftpåè®®çš„æ–‡ä»¶ä¼ è¾“æŒ‡ä»¤ wgetï¼šç½‘ç»œä¸‹è½½å™¨ curlï¼šhttpå‘½ä»¤è¡Œå·¥å…· ç³»ç»Ÿ shutdownï¼šå…³æœº rebootï¼šé‡å¯ mountï¼šæŒ‚åœ¨æ¬¡ç›˜/æ–‡ä»¶ç³»ç»Ÿ umountï¼šå¸è½½ç£ç›˜/æ–‡ä»¶ç³»ç»Ÿ exitï¼šé€€å‡ºå½“å‰ç»ˆç«¯ lastï¼šæ˜¾ç¤ºæœ€è¿‘ä¸€æ¬¡ç™»å½•çš„ç”¨æˆ· historyï¼šæ˜¾ç¤ºè¾“å…¥è¿‡çš„å†å²æŒ‡ä»¤ psï¼šåˆ—å‡ºç³»ç»Ÿä¸­å½“å‰è¿è¡Œçš„è¿›ç¨‹ topï¼šå®æ—¶æ˜¾ç¤ºç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µ freeï¼šæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ quotaï¼šæ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ killï¼šä¸­æ­¢ä¸€ä¸ªè¿›ç¨‹ unameï¼šæ˜¾ç¤ºæ“ä½œç³»ç»Ÿç›¸å…³ä¿¡æ¯çš„å‘½ä»¤ duï¼šè®¡ç®—ç£ç›˜ç©ºé—´çš„ä½¿ç”¨æƒ…å†µ dfï¼šæŠ¥å‘Šæ–‡ä»¶ç³»ç»Ÿç£ç›˜ç©ºé—´çš„ä½¿ç”¨æƒ…å†µ suï¼šåˆ‡æ¢èº«ä»½","link":"/2019-08-25-learn-shell/"},{"title":"Vue+SpringBootå•jaréƒ¨ç½²","text":"&emsp;&emsp;åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œåˆ°é¡¹ç›®çš„æ‰“åŒ…å‘å¸ƒé˜¶æ®µæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ä¼šé‡‡ç”¨ä¸€ä¸ªæ”¯æŒHTTPåŠ¨é™åˆ†ç¦»çš„ä¸­é—´ä»¶æ¥éƒ¨ç½²å‰åç«¯åº”ç”¨ï¼Œæœ€å¸¸è§çš„å°±æ˜¯Nginxï¼Œå®ƒä¸ä»…å¯ä»¥å¸®æˆ‘ä»¬åšåŠ¨é™åˆ†ç¦»ï¼Œè¿˜å¯ä»¥åšåç«¯è¯·æ±‚çš„è´Ÿè½½å‡è¡¡ï¼Œè¿™ä¸€éƒ¨åˆ†çš„å®ç°æ•™ç¨‹å¾ˆå¤šåœ¨æ­¤å°±ä¸åšè¿‡å¤šè§£é‡Šï¼Œæœ¬æ–‡æƒ³è®²çš„æ˜¯å¦‚ä½•ä¸ä¾èµ–ä¸­é—´ä»¶ï¼Œå°†å‰ç«¯æ‰“åŒ…çš„å†…å®¹åµŒå…¥åç«¯ï¼Œä»¥ä¸€ä¸ªjarå‘å¸ƒã€‚ æ€è€ƒ&emsp;&emsp;æœ¬äººæ˜¯åŸºäºSpringBoot+Vuejsæ¥åšå‰åç«¯åˆ†ç¦»å¼€å‘çš„ï¼Œæ‰€ä»¥æœ¬æ¬¡ä¹ŸåŸºäºè¿™ä¸¤ä¸ªæŠ€æœ¯å±•æ¥æ€è€ƒå¦‚ä½•å®ç°ï¼Œåœ¨æƒ³å¦‚ä½•ä¸ä¾èµ–ä¸­é—´ä»¶å®ç°éƒ¨ç½²æ—¶æˆ‘ä»¬å¾—å…ˆæ€è€ƒä¸­é—´ä»¶ä¸ºæˆ‘ä»¬çš„å‰åç«¯åˆ†ç¦»éƒ¨ç½²å¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ &emsp;&emsp;ä»¥Nginxä¸¾ä¾‹ï¼Œå¦‚ä¸‹æ˜¯å‰åç«¯åˆ†ç¦»éƒ¨ç½²æ¨¡å¼ä¸‹çš„ä¸€ä¸ªé…ç½®ç¤ºä¾‹ä¸»è¦å¹²äº†ä¸‰ä»¶äº‹æƒ… ä½¿ç”¨aliaså®ç°é™æ€èµ„æºçš„åˆ†å‘ ä½¿ç”¨try_fileså®ç°å‰ç«¯è·¯ç”±çš„è½¬å‘ï¼Œå¦‚http://localhost/homeè¿™ä¸ªåœ°å€æ˜¯å¯¹åº”ä¸åˆ°é™æ€èµ„æºçš„ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘404å“åº”ï¼Œtry_filesæŒ‡ä»¤åœ¨å¯¹åº”ä¸åˆ°é™æ€èµ„æºæ—¶å°†å†…å®¹è½¬å‘åˆ°/index.htmlä¹Ÿå°±æ˜¯å‰ç«¯é¦–é¡µï¼Œä»¥æ­¤æ¥å®ç°historyæ¨¡å¼çš„å‰ç«¯è·¯ç”± ä½¿ç”¨proxy_passå®ç°åç«¯è¯·æ±‚çš„åˆ†å‘ location /front { alias $application_path/traffic-sso/html; try_files $uri $uri/ /index.html last; index index.html index.htm; } location /api/ { proxy_pass http://localhost:8080/; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } &emsp;&emsp;åœ¨çŸ¥é“ä¸­é—´ä»¶å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½åï¼Œæˆ‘ä»¬éœ€è¦åŸºäºSpringBooté¡¹ç›®ä¹Ÿå»å®Œæˆè¿™ä¹ˆä¸€å¥—åŠŸèƒ½ï¼Œå³å¯å®ç°é›†æˆéƒ¨ç½²äº†ï¼Œæˆ‘ä»¬ç°åœ¨ä¸€é¡¹ä¸€é¡¹åŠŸèƒ½åˆ†æä¸€ä¸‹ é™æ€èµ„æºçš„åˆ†å‘ï¼šå¯é€šè¿‡é…ç½®é™æ€æ–‡ä»¶æ˜ å°„æ¥å®ç° å‰ç«¯è·¯ç”±çš„è½¬å‘ï¼šå¯é€šè¿‡æ‹¦æˆªå™¨æ¥å®ç° åç«¯è¯·æ±‚çš„åˆ†å‘ï¼šå¯é€šè¿‡æ‹¦æˆªå™¨æ¥å®ç° &emsp;&emsp;æ€»ä½“æ¥è¯´å®ç°ä¸Šä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œé™æ€æ–‡ä»¶æ˜ å°„é…ç½®å¾ˆå®¹æ˜“åœ¨æ­¤ä¸åšè¿‡å¤šæè¿°ï¼Œé—®é¢˜ä¸»è¦åœ¨æ‹¦æˆªå™¨çš„å®ç°ï¼Œéœ€è¦æœ‰ä¸¤ä¸ªæ‹¦æˆªå™¨åˆ†åˆ«å®ç°ä»¥ä¸‹ä¸¤ä¸ªåˆ†å‘ http://localhost:8080/front/** =&gt; index.html http://localhost:8080/api/** =&gt; http://localhost:8080/** ä»£ç å®ç°&emsp;&emsp;è§‚å¯Ÿä¸Šé¢æ‹¦æˆªå™¨å…¶å®ä¸»è¦å°±æ˜¯å®ç°ä¸€ä¸ªè·¯å¾„åŒ¹é…ä¸å¤„ç†å™¨è½¬å‘çš„åŠŸèƒ½ï¼ŒåŸºäºæ­¤éœ€æ±‚æˆ‘ä»¬å®šä¹‰RewriteFilter.javaå¦‚ä¸‹ï¼Œè¿™é‡Œä½¿ç”¨Spring Web MVCçš„AntPathMatcheræ¥åšè·¯å¾„åŒ¹é…å™¨ï¼Œä½¿ç”¨äº†Java8çš„Functionæ¥åšè½¬å‘é€»è¾‘å®šä¹‰ï¼Œä»£ç æ¯”è¾ƒç®€å•å°±ä¸åšè¿‡å¤šæè¿°äº† /** * @author JianhuiChen * @description åŸºäºè½¬å‘é€»è¾‘çš„è¿‡æ»¤å™¨ * @date 2019-08-15 */ public class RewriteFilter implements Filter { private Logger log = LoggerFactory.getLogger(RewriteFilter.class); /** * é…ç½®urlé€šé…ç¬¦ */ private final String urlPattern; /** * è½¬å‘é€»è¾‘ */ private final Function&lt;HttpServletRequest, String&gt; rewriteHandler; /** * è·¯å¾„åŒ¹é…å™¨ */ private AntPathMatcher pathMatcher = new AntPathMatcher(); public RewriteFilter(String urlPattern, Function&lt;HttpServletRequest, String&gt; rewriteHandler) { this.urlPattern = urlPattern; this.rewriteHandler = rewriteHandler; } @Override public void doFilter(ServletRequest req, ServletResponse resp, FilterChain chain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) req; String servletPath = request.getServletPath(); String context = request.getContextPath(); // åŒ¹é…çš„è·¯å¾„é‡å†™ if (pathMatcher.match(urlPattern, servletPath)) { String rewritePath = rewriteHandler.apply(request); log.debug(&quot;Rewrite {} to {}&quot;, servletPath, rewritePath); String fullPath; if (rewritePath.startsWith(&quot;/&quot;)) { fullPath = context + rewritePath; } else { fullPath = context + &quot;/&quot; + rewritePath; } req.getRequestDispatcher(fullPath).forward(req, resp); } else { chain.doFilter(req, resp); } } } &emsp;&emsp;ç°åœ¨æˆ‘ä»¬å°†é™æ€èµ„æºä¸æ‹¦æˆªå™¨é…ç½®ä½¿ç”¨ é¦–å…ˆè¿è¡Œå‰ç«¯é¡¹ç›®çš„æ‰“åŒ…æŒ‡ä»¤å°†æ‰“åŒ…çš„é™æ€èµ„æºæ‹·è´åˆ°SpringBootçš„public/static/resourcesç›®å½•ä¸‹ é…ç½®å‰ç«¯è·¯ç”±çš„è½¬å‘æ‹¦æˆªå™¨ /** * åŒ¹é…è·¯ç”±è½¬å‘ * æ‰€æœ‰ /front/** è¯·æ±‚æ˜ å°„è‡³ /index.html * exp /front/home -&gt; /index.html */ @Bean public FilterRegistrationBean frontFilter() { FilterRegistrationBean&lt;RewriteFilter&gt; registration = new FilterRegistrationBean&lt;&gt;(); registration.setFilter(new RewriteFilter(&quot;/front/**&quot;, http -&gt; &quot;index.html&quot;)); registration.addUrlPatterns(&quot;/front/*&quot;); registration.setName(&quot;frontFilter&quot;); registration.setOrder(1); return registration; } é…ç½®åç«¯è·¯ç”±çš„è½¬å‘æ‹¦æˆªå™¨ /** * åŒ¹é…åŠ¨æ€è¯·æ±‚ * æ‰€æœ‰ /api/** è¯·æ±‚æ˜ å°„è‡³ /** * exp /api/resources/users/me -&gt; /resources/users/me */ @Bean public FilterRegistrationBean apiFilter() { FilterRegistrationBean&lt;RewriteFilter&gt; registration = new FilterRegistrationBean&lt;&gt;(); registration.setFilter(new RewriteFilter(&quot;/api/**&quot;, http -&gt; http.getServletPath().replaceFirst(&quot;/api&quot;, &quot;&quot;))); registration.addUrlPatterns(&quot;/api/*&quot;); registration.setName(&quot;apiFilter&quot;); registration.setOrder(1); return registration; } æµ‹è¯•&emsp;&emsp;æ‰“å¼€æµè§ˆå™¨è¾“å…¥é“¾æ¥http://localhost:8080/frontå®Œæˆæµ‹è¯• å…¶ä»–AntPathMatcherç›¸å…³è®°å½•&emsp;&emsp;AntPathMatcheræ˜¯Springç”¨äºè·¯å¾„åŒ¹é…çš„å·¥å…·ç±»ï¼Œæˆ‘ä»¬ç»å¸¸å†™çš„@RequestMappingçš„åŒ¹é…é€»è¾‘å°±ä¸å®ƒæœ‰å…³ï¼Œå®ƒä¸»è¦çš„åŒ¹é…æ¨¡å¼æœ‰ä»¥ä¸‹ä¸‰ç§ ? åŒ¹é…ä»»ä½•å•å­—ç¬¦ * åŒ¹é…0æˆ–è€…ä»»æ„æ•°é‡çš„å­—ç¬¦ ** åŒ¹é…0æˆ–è€…æ›´å¤šçš„ç›®å½• &emsp;&emsp;AntPathMatcheré‡‡ç”¨æœ€é•¿åŒ¹é…åŸåˆ™ï¼Œå¦‚/api/**ä¸/api/resources/**æ¥åŒ¹é…/api/resources/users/meï¼Œåè€…ä¼šè¢«æˆåŠŸåŒ¹é…","link":"/2019-08-15-server-front-separate-package/"},{"title":"æµ·å²›å¯»å®é—®é¢˜","text":"&emsp;&emsp;5ä¸ªäººå»ä¸€ä¸ªæµ·å²›å¯»å®ï¼Œæœ€åä¸€å…±æ‰¾åˆ°äº†100æšé‡‘å¸ã€‚ä»–ä»¬çº¦å®šäº†ä¸€ä¸ªåˆ†é…æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼šäº”ä¸ªæµ·ç›—æŒ‰ç…§æŠ½ç­¾çš„é¡ºåºä¾æ¬¡æå‡ºæ–¹æ¡ˆï¼ŒæŸä¸€ä¸ªäººæå‡ºæ–¹æ¡ˆä¹‹åï¼Œå‰©ä½™å­˜æ´»çš„äººæŠ•ç¥¨è¡¨å†³ï¼šæ–¹æ¡ˆéœ€è¦è·å¾—è¶…è¿‡åŠæ•°äººçš„è®¤å¯ä¹‹åæ‰èƒ½è¢«é€šè¿‡ï¼Œå¦åˆ™æ–¹æ¡ˆæå‡ºè€…å°†ä¼šè¢«æ‰”è¿›å¤§æµ·å–‚é²¨é±¼ï¼ŒæŸä¸€ä¸ªæ–¹æ¡ˆè¢«é€šè¿‡åæ¸¸æˆå°±ç»“æŸã€‚æ³¨ï¼šæ¯ä¸ªäººçš„æŠ•ç¥¨éƒ½æ˜¯åœ¨è¿½æ±‚è‡ªå·±åˆ©ç›Šçš„æœ€å¤§åŒ–ï¼šä¿è¯è‡ªå·±ä¸ä¼šè¢«å–‚é²¨é±¼çš„å‰æä¸‹ï¼Œå°½é‡ä½¿è‡ªå·±åˆ†åˆ°æ›´å¤šçš„é‡‘å¸ã€‚ é¢˜æ„è§£è¯»&emsp;&emsp;æˆ‘ä»¬å…ˆæ¥ç†è§£ä¸€ä¸‹é¢˜ç›®æ„æ€ï¼Œå¦‚é¢˜è¯´çš„äº”ä¸ªæµ·ç›—æŒ‰ç…§æŠ½ç­¾é¡ºåºä¾æ¬¡æå‡ºæ–¹æ¡ˆï¼Œæ‰€ä»¥è¿™æ˜¯æœ‰é¡ºåºçš„ï¼Œç„¶ååŠæ•°ä»¥ä¸Šçš„äººè®¤å¯æ‰èƒ½è¢«é€šè¿‡ï¼Œå¦åˆ™äººå°±æ²¡äº†ï¼Œæ¯”å¦‚å‰©ä¸‹ä¸¤ä¸ªæµ·ç›—äº†ï¼Œé‚£ä¹ˆå‰é¢é‚£ä¸ªæµ·ç›—å°±è‚¯å®šæŒ‚äº†ï¼Œå› ä¸ºæœ€åé‚£ä½æµ·ç›—è‚¯å®šä¼šæŠ•ç¥¨ç»™è‡ªå·±ï¼Œåªè¦å‰é¢é‚£äººæŒ‚äº†ä»–å°±å¯ä»¥ç‹¬åé‡‘å¸ã€‚ä¸ºäº†è§£é¢˜æˆ‘ä»¬å¯ä»¥å…ˆå‡è®¾ä¸€ä¸ªé¡ºåºå‡ºæ¥ï¼Œç„¶åå†åˆ†æåˆ†ææ€ä¹ˆmake more money è§£é¢˜æ€è€ƒ&emsp;&emsp;æˆ‘ä»¬å…ˆç»™äº”ä¸ªæµ·ç›—æŒ‰ç…§é¡ºåºç¼–ä¸ªå·åˆ†åˆ«æ˜¯Aã€Bã€Cã€Dã€Eï¼Œåœ¨è¿™ä¸ªæ¸¸æˆä¸­å’±ä»¬çš„æ¯ä¸ªæµ·ç›—éƒ½è¦è€ƒè™‘ä¸¤ç‚¹make more moneyä¸æ´»ç€ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªè¯æˆ‘åˆ’é‡ç‚¹äº†ï¼‰ï¼Œåˆšæ‰æˆ‘ä»¬è¯´åˆ°ï¼Œå½“åªå‰©ä¿©äººæ—¶ï¼Œå³åªå‰©Dã€Eæ—¶ï¼ŒDè‚¯å®šå°±æŒ‚äº†ï¼Œæ‰€ä»¥æœºæ™ºçš„Dè‚¯å®šä¸èƒ½è®©è‡ªå·±é™·å…¥åªå‰©ä¿©äººçš„å°´å°¬å¤„å¢ƒä¸­ã€‚ &emsp;&emsp;è€ƒè™‘åˆ°è¿™ä¸€ç‚¹æ˜¯ä¸æ˜¯æœ‰ç‚¹æ€è·¯äº†ï¼Œæˆ‘ä»¬åº”è¯¥é€†å‘æ¥æ¨è¿™ä¸ªé—®é¢˜ï¼Œä»ä¸¤ä¸ªäººçš„æƒ…å†µå¼€å§‹æ¨¡æ‹Ÿï¼› å‰©ä½™Dã€E Då¿…ç„¶è¢«æŠ•æ­»ï¼Œæ”¶è·é‡‘å¸0 Eæ”¶è·é‡‘å¸100 å‰©ä½™Cã€Dã€E Céœ€è¦ä¸¤ç¥¨ä¸”CçŸ¥é“Dä¸ä¼šè®©è‡ªå·±é™·å…¥ä¸¤äººå›°å¢ƒè‚¯å®šä¼šæ”¯æŒè‡ªå·±ï¼Œå†åŠ ä¸Šè‡ªå·±çš„ç¥¨å…±2ç¥¨è¶…è¿‡äº†åŠæ•°ï¼Œäºæ˜¯å¤§èƒ†çš„åšå‡ºäº†100ã€0ã€0çš„åˆ†é… Dæ”¶è·é‡‘å¸0 Eæ”¶è·é‡‘å¸0 å‰©ä½™Bã€Cã€Dã€E Béœ€è¦ä¸‰ç¥¨ä¸”BçŸ¥é“è‡ªå·±æ­»åDã€Eéƒ½æ”¶ä¸åˆ°ä¸€ä¸ªé‡‘å¸ï¼Œäºæ˜¯å®ƒå¯ä»¥èŠ±1ä¸ªé‡‘å¸æŠŠè¿™ä¿©äººæ”¶ä¹°äº†è®©ä»–ä»¬æŠ•è‡ªå·±ï¼Œå†åŠ ä¸Šè‡ªå·±çš„ç¥¨å…±3ç¥¨è¶…è¿‡äº†åŠæ•°ï¼Œäºæ˜¯åšå‡ºäº†98ã€0ã€1ã€1çš„åˆ†é… Cæ”¶è·é‡‘å¸0 Dæ”¶è·é‡‘å¸1 Eæ”¶è·é‡‘å¸1 å…„å¼Ÿå…¨åœ¨Aã€Bã€Cã€Dã€E Aéœ€è¦ä¸‰ç¥¨ä¸”AçŸ¥é“è‡ªå·±æ­»åCæ”¶ä¸åˆ°ä¸€ä¸ªé‡‘å¸ï¼Œæ‰€ä»¥å¯ä»¥èŠ±1ä¸ªé‡‘å¸æ”¶ä¹°äº†Cï¼Œè¿˜å·®ä¸€ç¥¨å¯ä»¥åœ¨Dã€Eä¸­é€‰ä¸€ä¸ªèŠ±2ä¸ªé‡‘å¸æ”¶ä¹°è®©å…¶ç»™è‡ªå·±æŠ•ç¥¨ï¼Œå†åŠ ä¸Šè‡ªå·±çš„ç¥¨å…±3ç¥¨è¶…è¿‡äº†åŠæ•°ï¼Œäºæ˜¯å¯ä»¥åšå‡º97ã€0ã€1ã€2ã€0æˆ–è€…97ã€0ã€1ã€0ã€2çš„åˆ†é… Bæ”¶è·é‡‘å¸0 Cæ”¶è·é‡‘å¸1 D/Eæ”¶è·é‡‘å¸2 &emsp;&emsp;æ‰€ä»¥é¢˜ç›®çš„ç­”æ¡ˆæ˜¯ï¼Œåœ¨ç¬¬ä¸€ä¸ªä½ç½®çš„äººæœ€æœ‰åˆ©ï¼Œæœ€å¤šèƒ½å¤Ÿåˆ†åˆ°æœ€å¤š97ä¸ªé‡‘å¸ï™†â™‚","link":"/2019-07-14-thinking-topic/"},{"title":"ç®—æ³•â€”â€”çŒ«é¼ æ¸¸æˆ","text":"&emsp;&emsp;ç»™å®šä¸€å¼ åœ°å›¾ï¼Œå…¶ä¸­åŒ…å«çŒ«ã€è€é¼ ã€éšœç¢ç‰©ä¸‰ç±»å…ƒç´ ï¼Œæ¸¸æˆåˆå§‹åŒ–æ—¶çŒ«åœ¨åœ°å›¾çš„å·¦ä¸Šè§’ï¼Œè€é¼ åœ¨åœ°å›¾çš„å³ä¸‹è§’ï¼ŒçŒ«æ¯ä¸ªå›åˆå¯ä»¥é€‰æ‹©è‡ªå·±ä¸´è¿‘æ ¼å­ç§»åŠ¨ä¸€æ­¥ï¼Œä¸å¯è¶…è¿‡åœ°å›¾è¾¹ç•Œï¼Œä¸å¯ç§»åŠ¨è‡³æœ‰éšœç¢ç‰©å¤„ï¼Œè¯·è®¾è®¡ä¸€ä¸ªç®—æ³•è®©çŒ«ä½¿ç”¨æœ€å°‘çš„å›åˆæŠ“ä½è€é¼ ã€‚ æ¸¸æˆè®¾è®¡&emsp;&emsp;é¦–å…ˆæˆ‘ä»¬éœ€è¦è®¾è®¡å‡ºæ•´ä¸ªæ¸¸æˆï¼Œå¹¶é¢„ç•™å‡ºçŒ«çš„ç§»åŠ¨é€»è¾‘äº¤ç»™ç”¨æˆ·å»å®ç°ï¼Œè¿™é‡Œæˆ‘åŸºäºcanvasè®¾è®¡äº†cat-mouse-game-gen.jsæ¥ä½œä¸ºæ¸¸æˆæ„å»ºç¨‹åºï¼Œå€ŸåŠ©è¿™ä¸ªè„šæœ¬ä½¿ç”¨å¦‚ä¸‹ä»£ç å³å¯æ„å»ºä¸€ä¸ªçŒ«é¼ æ¸¸æˆæ£‹ç›˜ï¼š &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;body&gt; &lt;canvas id=&quot;gamePlace&quot;&gt;not support canvas&lt;/canvas&gt; &lt;/body&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;https://resources.chenjianhui.site/cat-mouse-game-gen-0.1.9.js&quot;&gt;&lt;/script&gt; &lt;script&gt; gameGen.initGame('gamePlace') &lt;/script&gt; &lt;/html&gt; not support canvas &emsp;&emsp;å…¶ä¸­gameGen.initGame(canvasId, catHandler, mouseHandler, options)æ˜¯æ¸¸æˆçš„åˆå§‹åŒ–å‡½æ•°ï¼Œå®ƒè´Ÿè´£æ¸²æŸ“ç»Ÿè®¡æ•°æ®åŠè¿è¡Œæ¸¸æˆï¼Œå‡½æ•°å…±æ¥æ”¶å››ä¸ªå‚æ•° canvasIdï¼šcanvasç”»å¸ƒID catHandlerï¼š çŒ«çš„è¡ŒåŠ¨å†³ç­–å‡½æ•°function(chessboard, curIndex, canMovePoints) ï¼Œä¸ä¼ æ­¤å‚æ•°ä»£è¡¨ä¸è¡ŒåŠ¨ï¼Œå‡½æ•°çš„è¿”å›å€¼å³æ˜¯çŒ«çš„ä¸‹ä¸€æ­¥ä½ç½®ï¼Œè¡ŒåŠ¨ç›®æ ‡æ˜¯æŠ“ä½è€é¼  chessboardï¼šæ£‹ç›˜å±€åŠ¿ï¼Œæ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦ä¸ºæ£‹ç›˜çš„æ€»æ ¼å­æ•°ï¼Œæ¯ä¸ªç‚¹ä½çš„å€¼éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆexp { flag: 1, depletePower: null }ï¼‰ï¼ŒåŒ…æ‹¬flagï¼ˆæ£‹å­ç±»å‹ï¼‰ä¸depletePowerï¼ˆå½“flagä¸º0æ—¶æ­¤å€¼ä¸ä¸ºç©ºï¼Œä»£è¡¨è¡Œèµ°éœ€è¦æ¶ˆè€—çš„ä½“åŠ›å€¼ï¼‰ä¸¤ä¸ªå±æ€§ï¼Œå…¶ä¸­flagçš„ç±»å‹ç å®šä¹‰å¦‚ä¸‹ 0ï¼šå¯ç§»åŠ¨æ ¼å­ 1ï¼šçŒ« 2ï¼šè€é¼  3ï¼šéšœç¢ç‰© curIndexï¼šçŒ«çš„å½“å‰ä½ç½® canMovePointsï¼šå¯ä»¥ç§»åŠ¨çš„ç‚¹ä½ï¼Œæ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œä»£è¡¨å¯ç§»åŠ¨çš„ä½ç½®ä¿¡æ¯ï¼Œå¦‚æœè¿”å›å€¼ä¸åœ¨æ­¤èŒƒå›´å†…æ£‹å­å°†ä¸ä¼šç§»åŠ¨ mouseHandler: è€é¼ çš„è¡ŒåŠ¨å†³ç­–å‡½æ•°ï¼Œä»‹ç»åŒcatHandlerï¼Œè¡ŒåŠ¨ç›®æ ‡æ˜¯èº²é¿çŒ«çš„è¿½å‡» options: é…ç½®ä¿¡æ¯ columnsï¼šæ£‹ç›˜åˆ—çš„æ•°é‡ï¼Œé»˜è®¤ä¸º8 rowsï¼šæ£‹ç›˜è¡Œçš„æ•°é‡ï¼Œé»˜è®¤ä¸º16 delayï¼šå›åˆæ—¶é—´å»¶è¿Ÿæ¯«ç§’æ•°ï¼Œé»˜è®¤ä¸º800 complexRoadï¼šæ˜¯å¦å¼€å¯å¤æ‚é“è·¯ï¼Œé»˜è®¤ä¸ºfalseï¼Œå¼€å¯åå°†ä¼šå¼•å…¥ä¸åŒç±»å‹çš„é“è·¯å¦‚è‰åœ°/æºªæµï¼Œä¸åŒçš„é“è·¯è¡Œèµ°æ¶ˆè€—çš„ä½“åŠ›ä¹Ÿä¸åŒï¼Œé—®é¢˜å°†æ¼”å˜æˆæœ‰ä¼˜å…ˆçº§çš„æœ€çŸ­è·¯å¾„ &emsp;&emsp;ä¸¾ä¸ªä¾‹å­ï¼Œä»¥ä¸‹ä»£ç å®ç°äº†ä¸€ä¸ªéšæœºè¡ŒåŠ¨çš„çŒ«ï¼Œè™½ç„¶éšæœºç§»åŠ¨çš„çŒ«æŠ“åˆ°è€é¼ å…¨å‡­è¿æ°”ï¼Œä¸è¿‡è¿™ä¹Ÿç®—ä¸€ç§ç§»åŠ¨ç­–ç•¥äº† &lt;canvas id=&quot;randomPlace&quot;&gt;not support canvas&lt;/canvas&gt; &lt;script&gt; const randomHandler = (chessboard, curIndex, canMovePoints) =&gt; { const randomIndex = Math.round(Math.random() * (canMovePoints.length - 1)) return canMovePoints[randomIndex] } gameGen.initGame('randomPlace', randomHandler) &lt;/script&gt; not support canvas ç®—æ³•è®¾è®¡&emsp;&emsp;è‡³æ­¤æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå¯ä»¥æ ¹æ®ç®—æ³•ç§»åŠ¨çš„çŒ«äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®¾è®¡çŒ«æŠ“è€é¼ çš„ç®—æ³•ï¼Œæˆ‘ä»¬ç¨å¾®è½¬åŒ–ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®å°±æ˜¯æ ¹æ®è¡ŒåŠ¨å†³ç­–å‡½æ•°ä¸­çš„æ£‹ç›˜å±€åŠ¿æ•°ç»„å»æ‰¾çŒ«åˆ°è€é¼ ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼Œæ—¢ç„¶è¦æ‰¾æœ€çŸ­è·¯å¾„æˆ‘ä»¬å…ä¸äº†è¦å¯¹æ£‹ç›˜è¿›è¡Œéå†æœç´¢ï¼Œåœ¨ä¸Šä¸€ç¯‡åšå®¢24ç‚¹æ¸¸æˆä¸­æˆ‘ä»¬è®²åˆ°æœç´¢ç®—æ³•æœ‰DFSä¸BFSä¸¤ç§ç­–ç•¥ï¼Œæˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤ç§ç­–ç•¥ï¼ŒDFSç®—æ³•å±äºä¸€ç§ç›²ç›®æœç´¢ï¼Œè¦æ‰¾åˆ°æœ€çŸ­è·¯å¾„å¿…ç„¶è¦éå†å…¨å±€ï¼Œè€ŒBFSæ‰©æ•£å¼æœç´¢ï¼Œåªè¦ç¬¬ä¸€æ¬¡æœç´¢åˆ°ç»ˆç‚¹å°±å¯ä»¥é€€å‡ºï¼Œä¸éœ€è¦éå†å…¨å±€ï¼Œå› æ­¤åœ¨è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨BFSå®ç°çŒ«çš„è¡ŒåŠ¨ç­–ç•¥ã€‚ è®¾è®¡æ€è·¯&emsp;&emsp;æˆ‘ä»¬å…ˆå‡è®¾æœ‰ä¸€ä¸ª4*8çš„æ£‹ç›˜ï¼ŒçŒ«åœ¨æ£‹ç›˜çš„å·¦ä¸Šè§’ï¼ˆæ•°ç»„çš„ä¸‹æ ‡0å¤„ï¼‰ï¼Œè€é¼ åœ¨æ£‹ç›˜çš„å³ä¸‹è§’ï¼ˆæ•°ç»„ä¸‹æ ‡31å¤„ï¼‰ï¼Œå¹¶åœ¨3ã€ 10ã€ 13ã€ 18ã€ 28å¤„ä½ç½®è®¾ç½®äº†5ä¸ªéšœç¢ç‰©ï¼Œç°åœ¨æˆ‘å°†åŸºäºè¿™ä¸ªå±€åŠ¿å»æ¨¡æ‹ŸBFSç®—æ³•çš„æœç´¢æµç¨‹ã€‚ 0ï± 1 2 3ïšµ 4 5 6 7 8 9 10ïšµ 11 12 13ïšµ 14 15 16 17 18ïšµ 19 20 21 22 23 24 25 26 27 28ïšµ 29 30 31ï­ [å›åˆ1] åŸºäºä½ç½®0æœç´¢å¯èƒ½çš„èµ°æ³•å¾—åˆ°[1, 8]ï¼Œåˆ¤æ–­æ‰€åœ¨ç‚¹ä½å¹¶éè€é¼ æ‰€åœ¨ç‚¹ä½ï¼Œå¦åˆ™åŸºäºè¿™ä¸¤ä¸ªç‚¹ä½ç»§ç»­æœç´¢ [å›åˆ2] åŸºäºä½ç½®1æœç´¢ =&gt; [0, 2, 9]ï¼Œç”±äº0æ˜¯å†å²èµ°è¿‡ç‚¹ä½ï¼Œå› æ­¤è¿‡æ»¤æ­¤é¡¹ =&gt; [2, 9]ï¼Œéç›®æ ‡ç‚¹ï¼Œå›åˆ°ç‚¹ä½8è¿›è¡Œæœç´¢ [å›åˆ2] åŸºäºä½ç½®8æœç´¢ =&gt; [0, 9, 16]ï¼Œè¿‡æ»¤ =&gt; [16]ï¼Œéç›®æ ‡ç‚¹ï¼Œå›åˆ°ç‚¹ä½2è¿›è¡Œæœç´¢ï¼Œåé¢çš„æ­¥éª¤é»˜è®¤è¿‡æ»¤ [å›åˆ3] åŸºäºä½ç½®2æœç´¢ =&gt; []ï¼Œ æ²¡æœ‰å¯ç§»åŠ¨ç‚¹ä½ï¼Œå›åˆ°ç‚¹ä½9è¿›è¡Œæœç´¢ [å›åˆ3] 9 =&gt; [17]ï¼Œéç›®æ ‡ç‚¹ï¼Œå›åˆ°16 [å›åˆ3] 16 =&gt; [24]ï¼Œéç›®æ ‡ç‚¹ [å›åˆ4 - 8] 24 =&gt; [25]ï¼Œ25 =&gt; [26]ï¼Œ26 =&gt; [27]ï¼Œ27 =&gt; [19]ï¼Œ19 =&gt; [11, 20]ï¼Œéç›®æ ‡ç‚¹ [å›åˆ9] 11 =&gt; [12]ï¼Œ20 =&gt; [21] [å›åˆ10] 12 =&gt; [4]ï¼Œ21 =&gt; [22, 29] [å›åˆ11] 4 =&gt; [5]ï¼Œ22 =&gt; [23, 30]ï¼Œ29 =&gt; [] [å›åˆ12] 5 =&gt; [6]ï¼Œ23 =&gt; [31]ï¼Œåˆ°è¾¾ç›®æ ‡ç‚¹ï¼Œç´¢å¼•èµ°è¿‡çš„è·¯å¾„ä¸º31,23,22,21,20,19,27,26,25,24,16,8,0 &emsp;&emsp;æ•´ä¸ªæµç¨‹ç®€å•æ¥è¯´å°±æ˜¯è‡ªå·¦åˆ°å³è‡ªä¸Šåˆ°ä¸‹éå†äº†å…¨éƒ¨çš„èŠ‚ç‚¹ï¼Œåªä¸è¿‡å®ƒæ˜¯æ ¹æ®å±‚æ¬¡ä¼˜å…ˆè¿›è¡Œéå†çš„ï¼Œåœ¨å±‚æ¬¡éå†çš„è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°äº†ç›®æ ‡ç‚¹ä½å³å¯è¿”å›ï¼Œå› ä¸ºåŒä¸€ä¸ªå±‚æ¬¡æ‰€æ¶ˆè€—çš„å›åˆæ•°æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡é‡åˆ°ç›®æ ‡ç‚¹ä½çš„è·¯å¾„å³æ˜¯æœ€ä¼˜è§£ä¹‹ä¸€ã€‚ ä»£ç å®ç°&emsp;&emsp;æ¸…æ¥šç®—æ³•æµç¨‹åï¼Œä»£ç çš„å®ç°ç›¸å¯¹ç®€å•ï¼Œå¯ä»¥ä½¿ç”¨é€’å½’ä¹Ÿå¯ä»¥ä½¿ç”¨é˜Ÿåˆ—ï¼Œæˆ‘è¿™è¾¹æ˜¯é€’å½’å®Œæˆæœ€çŸ­è·¯å¾„æœç´¢çš„ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š class BFSCat { constructor(options) { // å®šä¹‰åŸºç¡€è¡Œåˆ—ä¿¡æ¯ this.columns = (options &amp;&amp; options.columns) || 16 this.rows = (options &amp;&amp; options.rows) || 8 } /** * è·å–æœ€çŸ­è·¯å¾„ * @param chessboard æ£‹ç›˜ä¿¡æ¯ * @param catIndex çŒ«çš„ä½ç½® * @returns {Array} è·¯å¾„ä¿¡æ¯ æ— è§£æ—¶è¿”å›ç©ºæ•°ç»„ */ getShortestWays(chessboard, catIndex) { return this.search(chessboard, [{cur: catIndex, ways: []}]) } /** * æ ¹æ®å½“å‰æ£‹ç›˜å±€åŠ¿æœç´¢å‡ºä¸€æ¡æœ€çŸ­è·¯å¾„ * @param curChessboard å½“å‰æ£‹ç›˜å±€åŠ¿ * @param curs çŒ«çš„å½“å‰ä½ç½® * @param history å†å²èµ°è¿‡çš„è·¯å¾„ * @returns {Array} è¿”å›æœ€çŸ­è·¯å¾„ æ— è§£æ—¶è¿”å›ç©ºæ•°ç»„ */ search(curChessboard, curs, history) { if (!history) history = [] let nexts = [] for (let i in curs) { const curObj = curs[i]; const cur = curObj.cur const ways = curObj.ways const effectNeighbors = this.getEffectNeighbors(history, cur, curChessboard) for (let j in effectNeighbors) { const next = effectNeighbors[j] if (curChessboard[next].flag === 2) { // å¹¿åº¦éå†æŠ“åˆ°è€é¼  ç›´æ¥è¿”å›è·¯å¾„ return ways.slice().concat([cur, next]) } } // ç¼“å­˜å†å²è·¯å¾„ history = history.concat(effectNeighbors) nexts = nexts.concat(effectNeighbors.map(next =&gt; ({ cur: next, ways: ways.slice().concat([cur]) }))) } if (nexts.length === 0) { // æ— è·¯å¯èµ° æ­¤é¢˜æ— è§£ return [] } return this.search(curChessboard, nexts, history) } /** * * @param history å†å²èµ°è¿‡çš„è·¯å¾„ é˜²æ­¢èµ°å›å¤´è·¯ * @param cur å½“å‰ä½ç½® * @param chessboard æ£‹ç›˜ä¿¡æ¯ * @returns {Array} ä¸‹ä¸€æ­¥å¯èƒ½çš„èµ°æ³• */ getEffectNeighbors(history, cur, chessboard) { let result = [] const p = this.computeXY(cur) const columns = this.columns const rows = this.rows if (p.x &gt; 0 &amp;&amp; this.checkNextPoint(chessboard[cur - 1])) result.push(cur - 1) if (p.x &lt; columns - 1 &amp;&amp; this.checkNextPoint(chessboard[cur + 1])) result.push(cur + 1) if (p.y &gt; 0 &amp;&amp; this.checkNextPoint(chessboard[cur - columns])) result.push(cur - columns) if (p.y &lt; rows - 1 &amp;&amp; this.checkNextPoint(chessboard[cur + columns])) result.push(cur + columns) return result.filter(next =&gt; !(history &amp;&amp; history.includes(next))) } /** * æ ¹æ®æ£‹ç›˜çš„ç›¸å¯¹ä½ç½®è®¡ç®—æ£‹å­çš„åæ ‡ * @param index æ£‹ç›˜ç›¸å¯¹ä½ç½® * @returns {{x: number, y: number}} */ computeXY(index) { const columns = this.columns const x = index % columns const y = Math.floor(index / columns) return {x, y} } /** * åˆ¤æ–­ä¸‹ä¸€æ­¥ç‚¹ä½æ˜¯å¦å¯ä»¥ç§»åŠ¨ */ checkNextPoint(point) { return point.flag !== 3 } } æ•ˆæœæ¼”ç¤º&emsp;&emsp;å°†ä½¿ç”¨åŸºäºBFSç®—æ³•ç­–ç•¥è®¾è®¡çš„çŒ«åŠ å…¥åˆ°çŒ«é¼ æ¸¸æˆï¼Œæ•ˆæœå¦‚ä¸‹ï¼š &lt;canvas id=&quot;BFSPlace&quot;&gt;not support canvas&lt;/canvas&gt; &lt;script&gt; let cacheWays = null let index = 0 const catHandler = (chessboard, curIndex, canMovePoints) =&gt; { if (cacheWays === null) { cacheWays = new BFSCat().getShortestWays(chessboard, curIndex) if (cacheWays.length === 0) { throw new Error('æ­¤é¢˜æ— è§£') } } return cacheWays[index++] } gameGen.initGame('BFSPlace', catHandler , null) &lt;/script&gt; not support canvas åŠ å¼ºç‰ˆçŒ«é¼ æ¸¸æˆ&emsp;&emsp;æ™®é€šç‰ˆçš„çŒ«é¼ æ¸¸æˆæˆ‘ä»¬ä½¿ç”¨åŸºäºBFSçš„æœ€çŸ­è·¯å¾„æœç´¢ç®—æ³•å³å¯æ‰¾åˆ°æœ€ä¼˜è§£äº†ï¼Œç°åœ¨æˆ‘ä»¬å°†æ¸¸æˆå‡çº§ï¼Œå¼•å…¥ä¸åŒç±»å‹çš„é“è·¯ï¼Œè¯·è®¾è®¡ä¸€ä¸ªç®—æ³•è®©çŒ«ä½¿ç”¨æœ€å°‘çš„ä½“åŠ›æŠ“ä½è€é¼ ï¼Œå…¶ä¸­åŠ å¼ºç‰ˆçŒ«é¼ æ¸¸æˆå¼•å…¥çš„ä¸‰ç§é“è·¯ç±»å‹å¦‚ä¸‹ï¼š æ™®é€šé“è·¯ ï¼šæ¶ˆè€—ä¸€ç‚¹ä½“åŠ›å€¼ è‰åœ° ï¼šæ¶ˆè€—ä¸¤ç‚¹ä½“åŠ›å€¼ æºªæµ ï¼šæ¶ˆè€—ä¸‰ç‚¹ä½“åŠ›å€¼ &emsp;&emsp;åŒæ ·æˆ‘ä»¬å…ˆæ„å»ºå‡ºè¿™ä¸ªæ£‹ç›˜ï¼Œåªéœ€è¦å°†options.complexRoadé…ç½®ä¸ºtrueå³å¯ï¼ŒæœªåŠ å…¥è¡ŒåŠ¨å†³ç­–ç®—æ³•çš„æ£‹ç›˜æ•ˆæœå¦‚ä¸‹ï¼š &lt;canvas id=&quot;complexRoadPlace&quot;&gt;not support canvas&lt;/canvas&gt; &lt;script&gt; gameGen.initGame('complexRoadPlace', null, null, { complexRoad: true }) &lt;/script&gt; not support canvas è§£é¢˜æ€è€ƒ&emsp;&emsp;åŠ å¼ºç‰ˆæœ¬çš„æ¸¸æˆè¦è€ƒè™‘ä½“åŠ›æ¶ˆè€—æœ€å°ï¼Œå› æ­¤æœ€çŸ­çš„è·¯å¾„æœªå¿…æ¶ˆè€—çš„ä½“åŠ›å°±æ˜¯æœ€å°‘çš„ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å•è€ƒè™‘æœ€çŸ­è·¯å¾„è¿™ä¸ªæ–¹é¢å»è§£é¢˜äº†ï¼Œè¿˜åº”è¯¥è€ƒè™‘åˆ°ä¸åŒé“è·¯çš„ä½“åŠ›æ¶ˆè€—ã€‚ Aæ˜Ÿå¯»è·¯ç®—æ³•&emsp;&emsp;å¯ä»¥ç›´æ¥ç‚¹å‡»A*ç®—æ³•wikiæŸ¥çœ‹ä¸€ä¸‹ç®—æ³•çš„èƒŒæ™¯ï¼Œæˆ‘åœ¨è¿™é‡Œåªä»‹ç»ç®—æ³•çš„ä¸€äº›æ ¸å¿ƒæ¦‚å¿µï¼Œåœ¨A*ç®—æ³•ä¸­æœ‰ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µ Gå€¼ï¼šèµ·å§‹ç‚¹åˆ°è¡ŒåŠ¨ç‚¹çš„ç§»åŠ¨é‡ èµ·å§‹ç‚¹ï¼šçŒ«çš„åˆå§‹ä½ç½® è¡ŒåŠ¨ç‚¹ï¼šçŒ«çš„ä¸‹ä¸€æ­¥å†³ç­–ä½ç½® ç§»åŠ¨é‡ï¼šåœ¨è¿™é‡Œæˆ‘ä»¬è€ƒè™‘åœ°å½¢çš„æƒ…å†µä¸‹æ˜¯å¯ç§»åŠ¨æ ¼å­çš„ä½“åŠ›æ¶ˆè€—é‡ Hå€¼ï¼šè¡ŒåŠ¨ç‚¹åˆ°ç»ˆç‚¹çš„ä¼°ç®—é‡ï¼Œè¿™ä¸ªå€¼ä»…ä»…æ˜¯ä¸€ä¸ªä¼°ç®—å€¼ï¼Œæ¯”å¦‚ä½ç½®1åˆ°ä½ç½®31çš„ä¼°ç®—å€¼æˆ‘ä»¬å¿½ç•¥åœ°å½¢å¯ä»¥å–æœ€å°æ ¼å­æ•°ï¼Œå³9 ç»ˆç‚¹ï¼šè€é¼ çš„ä½ç½® ä¼°ç®—é‡ï¼šè¿™é‡Œæ˜¯ä¸è€ƒè™‘éšœç¢ç‰©çš„ä¸€ä¸ªä¼°ç®—ç§»åŠ¨é‡ &emsp;&emsp;å¥½çš„æ ¸å¿ƒæ¦‚å¿µä»‹ç»å®Œï¼Œæˆ‘ä»¬åŸºäºä¸€ä¸ªæ£‹ç›˜æ¥å®ŒæˆAæ˜Ÿç®—æ³•çš„å†³ç­–æµç¨‹ï¼Œä¸‹é¢çš„æ£‹ç›˜å’Œä¸Šé¢çš„åŸºæœ¬ä¸€è‡´ï¼ŒåŒºåˆ«åœ¨äºåŠ å…¥äº†åœ°å½¢å› ç´ ï¼Œæ¯ä¸ªå¯è¡Œèµ°çš„æ ¼å­ä¸­ç”¨æ‹¬å·æ‹¬èµ·æ¥çš„å°±æ˜¯ç‰¹æ®Šåœ°å½¢çš„ä½“åŠ›æ¶ˆè€—å€¼ï¼Œè¿™å°†ä¼šå½±å“åˆ°å„ä¸ªç‚¹ä½çš„Gã€Hå€¼ã€‚ 0ï± 1(2) 2 3ïšµ 4 5 6 7 8 9(2) 10ïšµ 11 12 13ïšµ 14 15(2) 16 17 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2) 25 26 27 28ïšµ 29 30 31ï­ &emsp;&emsp;ç°åœ¨æˆ‘ä»¬åŸºäºä¸Šè¿°æ£‹ç›˜æ¥ç®€è¿°ä¸€ä¸‹Aæ˜Ÿç®—æ³•çš„å†³ç­–æµç¨‹ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åŸºäºå½“å‰è¡ŒåŠ¨ç‚¹æ±‚å‡ºé‚»è¿‘å¯ç§»åŠ¨ç‚¹çš„Gã€Hå€¼ï¼Œæ ¹æ®F = G + Hå…¬å¼å¾—å‡ºç‚¹ä½çš„å’Œå€¼Fï¼Œç„¶åæ‰¾ä¸€ä¸ªFå€¼æœ€å°çš„ç‚¹ä½œä¸ºå½“å‰è¡ŒåŠ¨ç‚¹ç»§ç»­è¿›è¡Œåˆ¤æ–­ï¼Œç›´åˆ°æ‰¾åˆ°è€é¼ ä½ç½®æˆ–è€…æ— ç‚¹å¯é€‰ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸¤ä¸ªåˆ—è¡¨ openåˆ—è¡¨ï¼šè®°å½•ä¸‹æ‰€æœ‰è¢«è€ƒè™‘çš„ç‚¹ä½åˆ—è¡¨ closeåˆ—è¡¨ï¼šè®°å½•ä¸‹æ‰€æœ‰ä¸è¢«è€ƒè™‘çš„ç‚¹ä½åˆ—è¡¨ &emsp;&emsp;ç°åœ¨æˆ‘å°†åŸºäºè¿™ä¸ªå±€åŠ¿å»æ¨¡æ‹ŸAæ˜Ÿç®—æ³•çš„æœç´¢æµç¨‹ï¼Œå…¶ä¸­ğŸ”•ä»£è¡¨ä¸è¢«è€ƒè™‘çš„ç‚¹ä½closeã€ïš¶ä»£è¡¨å½“å‰è¡ŒåŠ¨ç‚¹ã€ï±ä»£è¡¨è¢«è€ƒè™‘çš„ç‚¹ä½openã€F()æ‹¬å·å†…éƒ¨çš„å€¼ä»£è¡¨è¢«è€ƒè™‘ç‚¹ä½çš„å’Œå€¼G + Hï¼Œç°åœ¨æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çš„æ¨¡æ‹Ÿå¦‚ä¸‹ï¼š [å›åˆ1] åŸºäºä½ç½®0æœç´¢åˆ°å¯èƒ½èµ°æ³•[1, 8]ï¼Œè®¡ç®—å’Œå€¼ä¸º[1(2 + 9), 8(1 + 9)]ï¼Œopen = [1(11), 8(10)]ã€close = [0(10)]ï¼Œæ‹¬å·å†…ä¸ºå’Œå€¼F 0ï”•ïš¶ 1(2)ï±F(11) 2 3ïšµ 4 5 6 7 8ğŸ±F(10) 9(2) 10ïšµ 11 12 13ïšµ 14 15(2) 16 17 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2) 25 26 27 28ïšµ 29 30 31ï­ [å›åˆ2] åœ¨openåˆ—è¡¨æ‰¾åˆ°å’Œå€¼æœ€å°çš„ç‚¹ä½œä¸ºå½“å‰è¡ŒåŠ¨ç‚¹ï¼Œæ‰¾åˆ°å¯èƒ½èµ°æ³•è®¡ç®—å’Œå€¼å¹¶åŠ å…¥åˆ°openåˆ—è¡¨ï¼ŒåŒæ—¶å½“å‰è¡ŒåŠ¨ç‚¹æ”¾å…¥closeåˆ—è¡¨ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†é€‰æ‹©ç‚¹8ä½œä¸ºå½“å‰è¡ŒåŠ¨ç‚¹ï¼Œæ­¤æ—¶ open = [1(11), 9(11), 16(10)ã€close = [0(10), 8(10)] 0ï”• 1(2)ğŸ±F(11) 2 3ïšµ 4 5 6 7 8ï”•ïš¶ 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ğŸ±F(10) 17 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2) 25 26 27 28ïšµ 29 30 31ï­ [å›åˆ3] é€‰æ‹©16ï¼Œæ­¤æ—¶open = [1(11), 9(11), 17(10), 24(11)ã€close = [0(10), 8(10), 16(10)] 0ï”• 1(2)ğŸ±F(11) 2 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ï”•ïš¶ 17ğŸ±F(10) 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2)ğŸ±F(11) 25 26 27 28ïšµ 29 30 31ï­ [å›åˆ4] é€‰æ‹©17 0ï”• 1(2)ğŸ±F(11) 2 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ï”• 17ï”•ïš¶ 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2)ğŸ±F(11) 25ğŸ±F(10) 26 27 28ïšµ 29 30 31ï­ [å›åˆ5] é€‰æ‹©25 0ï”• 1(2)ğŸ±F(11) 2 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2)ğŸ±F(11) 25ï”•ïš¶ 26ğŸ±F(10) 27 28ïšµ 29 30 31ï­ [å›åˆ6] é€‰æ‹©26 0ï”• 1(2)ğŸ±F(11) 2 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19 20(3) 21(3) 22 23(3) 24(2)ğŸ±F(11) 25ï”• 26ğŸ”•ğŸš¶ 27ğŸ±F(10) 28ïšµ 29 30 31ï­ [å›åˆ7] é€‰æ‹©27ï¼Œæ³¨æ„ï¼Œè¿™é‡Œç”±äºè·¯éšœé—®é¢˜ç»•è·¯äº†ï¼Œæ‰€ä»¥Få€¼å˜ä¸ºäº†12(7 + 5) 0ï”• 1(2)ğŸ±F(11) 2 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19ğŸ±F(12) 20(3) 21(3) 22 23(3) 24(2)ğŸ±F(11) 25ï”• 26ğŸ”• 27ğŸ”•ğŸš¶ 28ïšµ 29 30 31ï­ [å›åˆ8] é€‰æ‹©1 0ï”• 1(2)ğŸ”•ğŸš¶ 2ğŸ±F(11) 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ±F(11) 10ïšµ 11 12 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19ğŸ±F(12) 20(3) 21(3) 22 23(3) 24(2)ğŸ±F(11) 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ9 - 12] é€‰æ‹©2ã€9ã€24ï¼Œå‘ç°éƒ½ä¸ºæ­»è·¯ï¼ŒåŠ å…¥closeåˆ—è¡¨ï¼Œæœ€ç»ˆåªèƒ½é€‰æ‹©19 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ±F(14) 12 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19ğŸ”•ğŸš¶ 20(3)ğŸ±F(14) 21(3) 22 23(3) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ13] é€‰æ‹©20ï¼Œå½“å‡ºç°Få€¼ç›¸åŒçš„æƒ…å†µæˆ‘ä»¬å°±å–ç¬¬ä¸€ä¸ªåˆ¤æ–­ç”Ÿæˆçš„ï¼Œæˆ‘çš„åˆ¤æ–­æ˜¯è‡ªå·¦å‘å³ã€è‡ªä¸Šåˆ°ä¸‹ï¼Œæ‰€ä»¥ç‚¹ä½20å…ˆè¢«åˆ¤æ–­ 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ±F(14) 12ğŸ±F(16) 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”•ğŸš¶ 21(3)ğŸ±F(16) 22 23(3) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ14] é€‰æ‹©11ï¼Œæˆ‘ä»¬å‘ç°ä»¥ç‚¹11ä¸ºè¡ŒåŠ¨ç‚¹çš„ç›¸é‚»ç‚¹12è®¡ç®—å‡ºçš„Få€¼ä¸º14æ¯”16å°ï¼Œæ•…æ›´æ–°èŠ‚ç‚¹ 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4 5 6 7 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ”•ğŸš¶ 12ğŸ±F(14) 13ïšµ 14 15(2) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”• 21(3)ğŸ±F(16) 22 23(3) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ15 - 18] é€‰æ‹©12ã€4ã€5ã€6 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4ğŸ”• 5ğŸ”• 6ğŸ”•ğŸš¶ 7ğŸ±F(16) 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ”• 12ğŸ”• 13ïšµ 14ğŸ±F(16) 15(2) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”• 21(3)ğŸ±F(16) 22 23(3) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ19] é€‰æ‹©7 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4ğŸ”• 5ğŸ”• 6ğŸ”• 7ğŸ”•ğŸš¶ 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ”• 12ğŸ”• 13ïšµ 14ğŸ±F(16) 15(2)ğŸ±F(17) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”• 21(3)ğŸ±F(16) 22 23(3) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ20] é€‰æ‹©14 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4ğŸ”• 5ğŸ”• 6ğŸ”• 7ğŸ”• 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ”• 12ğŸ”• 13ïšµ 14ğŸ”•ğŸš¶ 15(2)ğŸ±F(17) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”• 21(3)ğŸ±F(16) 22ğŸ±F(16) 23(3) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30 31ï­ [å›åˆ21] é€‰æ‹©22 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4ğŸ”• 5ğŸ”• 6ğŸ”• 7ğŸ”• 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ”• 12ğŸ”• 13ïšµ 14ğŸ”• 15(2)ğŸ±F(17) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”• 21(3)ğŸ±F(16) 22ğŸ”•ğŸš¶ 23(3)ğŸ±F(18) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29 30ğŸ±F(16) 31ï­ [å›åˆ22] é€‰æ‹©30ï¼Œå‘ç°é‚»è¿‘ç‚¹ä¸­æœ‰ç›®æ ‡ç‚¹ï¼Œä¸”å€¼ä¸º16æ˜¯æœ€çŸ­è·¯å¾„ä¹‹ä¸€ï¼Œéå†å®Œæˆï¼Œå…·ä½“è·¯å¾„ä¸º 0,8,16,17,25,26,27,19,11,12,4,5,6,14,22,30,31ï¼Œå…±æ¶ˆè€—ä½“åŠ›å€¼16ç‚¹ 0ï”• 1(2)ğŸ”• 2ğŸ”• 3ïšµ 4ğŸ”• 5ğŸ”• 6ğŸ”• 7ğŸ”• 8ï”• 9(2)ğŸ”• 10ïšµ 11ğŸ”• 12ğŸ”• 13ïšµ 14ğŸ”• 15(2)ğŸ±F(17) 16ï”• 17ï”• 18ïšµ 19ğŸ”• 20(3)ğŸ”• 21(3)ğŸ±F(16) 22ğŸ”• 23(3)ğŸ±F(18) 24(2)ğŸ”• 25ï”• 26ğŸ”• 27ğŸ”• 28ïšµ 29ğŸ±F(18) 30ğŸ”•ğŸš¶ 31ï­ğŸ±F(16) ä»£ç å®ç°-1class AStarCat { constructor(options) { // å®šä¹‰åŸºç¡€è¡Œåˆ—ä¿¡æ¯ this.columns = (options &amp;&amp; options.columns) || 16 this.rows = (options &amp;&amp; options.rows) || 8 } /** * è·å–æœ€ä¼˜è§£ * @param chessboard æ£‹ç›˜ä¿¡æ¯ * @returns {Array} è·¯å¾„ä¿¡æ¯ æ— è§£æ—¶è¿”å›ç©ºæ•°ç»„ */ getShortestWays(chessboard) { const catIndex = chessboard.findIndex(item =&gt; item.flag === 1) const mouseIndex = chessboard.findIndex(item =&gt; item.flag === 2) return this.search(chessboard, {cur: catIndex, ways: []}, catIndex, mouseIndex) } /** * æœç´¢è·¯å¾„ * @param curChessboard æ£‹ç›˜ä¿¡æ¯ * @param curObj å½“å‰è¡ŒåŠ¨ç‚¹å¯¹è±¡ * @param catIndex çŒ«çš„åˆå§‹ä½ç½® * @param mouseIndex è€é¼ çš„åˆå§‹ä½ç½® * @param open è¢«è€ƒè™‘çš„ç‚¹ä½ * @param close ä¸è¢«è€ƒè™‘çš„ç‚¹ä½ * @returns {Array} è¿”å›æœ€ä¼˜è·¯å¾„ æ— è§£æ—¶è¿”å›ç©ºæ•°ç»„ */ search(curChessboard, curObj, catIndex, mouseIndex, open, close) { if (!open) open = [] if (!close) close = [] const cur = curObj.cur close.push(cur) open.splice(open.findIndex(o =&gt; o.cur === cur), 1) const effectNeighbors = this.getEffectNeighbors(close, cur, curChessboard) const nextOpen = effectNeighbors.map(next =&gt; { const ways = curObj.ways.concat([next]) return { cur: next, f: this.computeF(mouseIndex, next, ways, curChessboard), ways: ways } }) // å¦‚æœopenä¸nextOpenæœ‰äº¤é›†ï¼Œå–æ›´å°å€¼ nextOpen.forEach(n =&gt; { let sameIndex = open.findIndex(o =&gt; o.cur === n.cur) if (sameIndex &gt; -1) { if (n.f &lt; open[sameIndex].f) { open.splice(sameIndex, 1, n) } } else { open.push(n) } }) open = open.concat() const success = open.find(o =&gt; o.cur === mouseIndex) if (success) { return success.ways } if (open.length &gt; 0) { return this.search(curChessboard, open.sort((a, b) =&gt; (a.f - b.f))[0], catIndex, mouseIndex, open.slice(), close.slice()) } return [] } /** * * @param close ä¸è¢«è€ƒè™‘çš„èŠ‚ç‚¹ * @param cur å½“å‰ä½ç½® * @param chessboard æ£‹ç›˜ä¿¡æ¯ * @returns {Array} ä¸‹ä¸€æ­¥å¯èƒ½çš„èµ°æ³• */ getEffectNeighbors(close, cur, chessboard) { let result = [] const p = this.computeXY(cur) const columns = this.columns const rows = this.rows if (p.x &gt; 0 &amp;&amp; this.checkNextPoint(chessboard[cur - 1])) result.push(cur - 1) if (p.x &lt; columns - 1 &amp;&amp; this.checkNextPoint(chessboard[cur + 1])) result.push(cur + 1) if (p.y &gt; 0 &amp;&amp; this.checkNextPoint(chessboard[cur - columns])) result.push(cur - columns) if (p.y &lt; rows - 1 &amp;&amp; this.checkNextPoint(chessboard[cur + columns])) result.push(cur + columns) return result.filter(next =&gt; !(close &amp;&amp; close.includes(next))) } /** * è®¡ç®—GHçš„å’Œå€¼ * @param mouseIndex è€é¼ çš„ä½ç½® * @param curIndex å½“å‰è¡ŒåŠ¨ç‚¹ * @param ways å½“å‰è¡ŒåŠ¨ç‚¹çš„å†å²è·¯å¾„ * @param chessboard æ£‹ç›˜ä¿¡æ¯ */ computeF(mouseIndex, curIndex, ways, chessboard) { const mouseP = this.computeXY(mouseIndex) const curP = this.computeXY(curIndex) const g = ways.reduce((a, b) =&gt; (chessboard[a].depletePower + chessboard[b].depletePower), 0) const h = Math.abs(curP.x - mouseP.x) + Math.abs(curP.y - mouseP.y) return g + h } /** * æ ¹æ®æ£‹ç›˜çš„ç›¸å¯¹ä½ç½®è®¡ç®—æ£‹å­çš„åæ ‡ * @param index æ£‹ç›˜ç›¸å¯¹ä½ç½® * @returns {{x: number, y: number}} */ computeXY(index) { const columns = this.columns const x = index % columns const y = Math.floor(index / columns) return {x, y} } /** * åˆ¤æ–­ä¸‹ä¸€æ­¥ç‚¹ä½æ˜¯å¦å¯ä»¥ç§»åŠ¨ */ checkNextPoint(point) { return point.flag !== 3 } } æ•ˆæœæ¼”ç¤º-1&lt;canvas id=&quot;AStarPlace&quot;&gt;not support canvas&lt;/canvas&gt; &lt;script&gt; let cacheWays = null let index = 0 const catHandler = (chessboard, curIndex, canMovePoints) =&gt; { if (cacheWays === null) { cacheWays = new AStarCat().getShortestWays(chessboard) if (cacheWays.length === 0) { throw new Error('æ­¤é¢˜æ— è§£') } } return cacheWays[index++] } gameGen.initGame('AStarPlace', catHandler , null, { complexRoad: true }) &lt;/script&gt; not support canvas å‡çº§ç©æ³•&emsp;&emsp;åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥è®¾è®¡çŒ«çš„è¡ŒåŠ¨ç­–ç•¥å‡½æ•°ï¼Œè¿˜å¯ä»¥è®¾è®¡è€é¼ çš„è¡ŒåŠ¨ç­–ç•¥å‡½æ•°æ¥èº²é¿çŒ«çš„è¿½å‡»ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æƒ³æƒ³å¦‚æœèº²é¿ç®—æ³•åˆåº”è¯¥å¦‚ä½•å®ç°ã€‚ å‚è€ƒèµ„æ–™ Aæ˜Ÿå¯»è·¯ç®—æ³•-(å…¥é—¨çº§) - Colinä¸¶- CSDNåšå®¢ gameGen.initGame('staticPlace') gameGen.initGame('randomPlace', (chessboard, curIndex, canMovePoints) => canMovePoints[Math.round(Math.random() * (canMovePoints.length - 1))]) let cacheWaysOfBSF = null let indexOfBSF = 0 const catHandlerOfBFS = (chessboard, curIndex, canMovePoints) => { if (cacheWaysOfBSF === null) { cacheWaysOfBSF = new BFSCat().getShortestWays(chessboard, curIndex) if (cacheWaysOfBSF.length === 0) { throw new Error('æ­¤é¢˜æ— è§£') } } return cacheWaysOfBSF[indexOfBSF++] } gameGen.initGame('BFSPlace', catHandlerOfBFS , null) gameGen.initGame('complexRoadPlace', null, null, { complexRoad: true }) let cacheWaysOfAStar = null let indexOfAstar = 0 const catHandlerOfAstar = (chessboard, curIndex, canMovePoints) => { if (cacheWaysOfAStar === null) { cacheWaysOfAStar = new AStarCat().getShortestWays(chessboard) if (cacheWaysOfAStar.length === 0) { throw new Error('æ­¤é¢˜æ— è§£') } } return cacheWaysOfAStar[indexOfAstar++] } gameGen.initGame('AStarPlace', catHandlerOfAstar , null, { complexRoad: true })","link":"/2019-06-20-algorithm-topic/"},{"title":"ç®—æ³•â€”â€”24ç‚¹æ¸¸æˆ","text":"&emsp;&emsp;ç»™å®šå››ä¸ª1-10çš„æ­£æ•´æ•°ï¼Œå¯ä»¥è¿›è¡Œ+ - * / å››ç§è¿ç®—ï¼Œæ¯ä¸ªæ•°å­—åªèƒ½ç”¨ä¸€æ¬¡ï¼Œä»»æ„ç»„åˆæ„é€ è¡¨è¾¾å¼ä½¿ç»“æœä¸º24ï¼Œè¦æ‰¾å‡ºæ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼Ÿ è§£é¢˜æ€è€ƒ&emsp;&emsp;åˆæ‹¿åˆ°é¢˜ç›®æœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯ç©·ä¸¾æ³•äº†ï¼Œæˆ‘ä»¬å…ˆå‡è®¾å››ä¸ªæ•°å­—ä¸ºAã€Bã€Cã€Dï¼Œç„¶åç©·ä¸¾æ‰€æœ‰çš„å¯èƒ½æ€§ï¼Œç®€å•ç®—ä¸€ä¸‹å¯ä»¥å¾—åˆ°ä¸€å…±æœ‰4! * 4^3 = 1536ç§å¯èƒ½æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š DFSè§£æ³•&emsp;&emsp;DFSæ˜¯Depth-First search æ·±åº¦ä¼˜å…ˆæœç´¢çš„ç®€ç§°ï¼Œä¸å…¶å¯¹åº”çš„è¿˜æœ‰BFS(Breadth-First-Search å¹¿åº¦ä¼˜å…ˆæœç´¢)ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨é€’å½’çš„æ–¹å¼æ·±åº¦ä¼˜å…ˆéå†æœç´¢æ ‘æ‰¾åˆ°æ‰€æœ‰å¯èƒ½æ€§ï¼Œç„¶åæ ¹æ®å¾—å‡ºçš„ç®—æœ¯è¡¨è¾¾å¼ï¼ˆå¦‚1+2+3*4ï¼‰è®¡ç®—å¹¶åˆ¤æ–­ç­›é€‰å‡ºè®¡ç®—ç»“æœä¸º24çš„ç»„åˆï¼Œä»£ç å¦‚ä¸‹ï¼š import java.util.*; import java.util.regex.Pattern; import java.util.stream.Collectors; /** * @author JianhuiChen * @description 24ç‚¹æ¸¸æˆ * @date 2019/6/18 */ public class Count24 { public static void main(String[] args) { List&lt;String&gt; results = permutation(Arrays.asList(1, 2, 3, 4), Arrays.asList(Operator.PLUS, Operator.MINUS, Operator.MULTIPLY, Operator.DIVIDE)); results.stream() .filter(express -&gt; expectCalc(express, 24)) .forEach(System.out::println); } private static List&lt;String&gt; permutation(List&lt;Integer&gt; numbers, List&lt;Operator&gt; operators) { return permutation(numbers, operators, null); } /** * æ·±åº¦ä¼˜å…ˆæœç´¢ç­–ç•¥å¾—å‡ºæ‰€æœ‰çš„ç»„åˆå¯èƒ½æ€§ * * @param numbers å‚ä¸é€‰æ‹©çš„æ•°å­— * @param operators å‚ä¸è¿ç®—çš„è¿ç®—ç¬¦ * @param expressRecord ç®—æœ¯è¡¨è¾¾å¼è®°å½•å€¼ * @return å¯èƒ½æ€§ç»„åˆ */ private static List&lt;String&gt; permutation(List&lt;Integer&gt; numbers, List&lt;Operator&gt; operators, String expressRecord) { if (expressRecord == null) { expressRecord = &quot;&quot;; } List&lt;String&gt; resultList = new ArrayList&lt;&gt;(); for (int num : numbers) { if (numbers.size() == 1) { // åªå‰©ä¸€ä¸ªæ•°å­—æœªé€‰æ—¶é€€å‡ºå¾ªç¯ resultList.add(expressRecord + num); break; } for (Operator oper : operators) { // è¿‡æ»¤æ‰å·²é€‰é¡¹ List&lt;Integer&gt; optional = numbers.stream() .filter(n -&gt; n != num) .collect(Collectors.toList()); resultList.addAll(permutation(optional, operators, expressRecord + num + oper)); } } return resultList; } /** * è¿›è¡Œé¢„æœŸè¿ç®— * * @param aritExpression ç®—æœ¯è¡¨è¾¾å¼ * @param targetVal ç›®æ ‡å€¼ * @return æ˜¯å¦ç¬¦åˆé¢„æœŸ */ private static boolean expectCalc(String aritExpression, int targetVal) { return calculation(aritExpression) == targetVal; } /** * æ ¹æ®ç®—æœ¯è¡¨è¾¾å¼æ±‚å€¼ * * @param aritExpression ç®—æœ¯è¡¨è¾¾å¼ exp: 4*2/1*3 * @return è®¡ç®—ç»“æœ */ private static int calculation(String aritExpression) { // å°†è¡¨è¾¾å¼æ ¹æ®è¿ç®—ç¬¦åˆ‡å‰² StringTokenizer tokenizer = new StringTokenizer(aritExpression, &quot;+-*/&quot;, true); Stack&lt;Double&gt; numStack = new Stack&lt;&gt;(); // å­˜æ”¾æ•°å­— Stack&lt;Operator&gt; operStack = new Stack&lt;&gt;(); // å­˜æ”¾æ“ä½œç¬¦ String currentEle; // å½“å‰å…ƒç´  while (tokenizer.hasMoreTokens()) { currentEle = tokenizer.nextToken().trim(); // å»æ‰å‰åçš„ç©ºæ ¼ if (!&quot;&quot;.equals(currentEle)) { // åªå¤„ç†éç©ºå­—ç¬¦ if (Pattern.matches(&quot;^\\\\d+(\\\\.\\\\d+)?$&quot;, currentEle)) { // ä¸ºæ•°å­—æ—¶åˆ™åŠ å…¥åˆ°æ•°å­—æ ˆä¸­ numStack.push(Double.valueOf(currentEle)); } else { Operator currentOper = Operator.getOperatorBySymbol(currentEle);//è·å–å½“å‰è¿ç®—æ“ä½œç¬¦ if (currentOper == null) { throw new RuntimeException(&quot;å­˜åœ¨æ— æ•ˆçš„æ“ä½œç¬¦&quot; + currentEle); } while (!operStack.empty() &amp;&amp; operStack.peek().priority() &gt;= currentOper.priority()) { compute(numStack, operStack); } // è®¡ç®—å®ŒåæŠŠå½“å‰æ“ä½œç¬¦åŠ å…¥åˆ°æ“ä½œæ ˆä¸­ operStack.push(currentOper); } } } // ç»è¿‡ä¸Šé¢ä»£ç çš„éå†åæœ€åçš„åº”è¯¥æ˜¯numsé‡Œé¢å‰©ä¸¤ä¸ªæ•°æˆ–ä¸‰ä¸ªæ•°ï¼Œoperatorsé‡Œé¢å‰©ä¸€ä¸ªæˆ–ä¸¤ä¸ªè¿ç®—æ“ä½œç¬¦ while (!operStack.empty()) { compute(numStack, operStack); } return numStack.pop().intValue(); } /** * å–numStackçš„æœ€é¡¶ä¸Šä¸¤ä¸ªæ•°å­— * operStackçš„æœ€é¡¶ä¸Šä¸€ä¸ªè¿ç®—ç¬¦è¿›è¡Œè¿ç®— * ç„¶åæŠŠè¿ç®—ç»“æœå†æ”¾åˆ°numStackçš„æœ€é¡¶ç«¯ * * @param numStack æ•°å­—æ ˆ * @param operStack æ“ä½œæ ˆ */ private static void compute(Stack&lt;Double&gt; numStack, Stack&lt;Operator&gt; operStack) { Double num2 = numStack.pop(); // å¼¹å‡ºæ•°å­—æ ˆæœ€é¡¶ä¸Šçš„æ•°å­—ä½œä¸ºè¿ç®—çš„ç¬¬äºŒä¸ªæ•°å­— Double num1 = numStack.pop(); // å¼¹å‡ºæ•°å­—æ ˆæœ€é¡¶ä¸Šçš„æ•°å­—ä½œä¸ºè¿ç®—çš„ç¬¬ä¸€ä¸ªæ•°å­— Double computeResult = operStack.pop().compute(num1, num2); // å¼¹å‡ºæ“ä½œæ ˆæœ€é¡¶ä¸Šçš„è¿ç®—ç¬¦è¿›è¡Œè®¡ç®— numStack.push(computeResult); // æŠŠè®¡ç®—ç»“æœé‡æ–°æ”¾åˆ°é˜Ÿåˆ—çš„æœ«ç«¯ } /** * æ”¯æŒçš„è¿ç®—ç¬¦ */ private enum Operator { PLUS(&quot;+&quot;) { @Override public int priority() { return 1; } @Override public double compute(double a, double b) { return a + b; } }, MINUS(&quot;-&quot;) { @Override public int priority() { return 1; } @Override public double compute(double a, double b) { return a - b; } }, MULTIPLY(&quot;*&quot;) { @Override public int priority() { return 2; } @Override public double compute(double a, double b) { return a * b; } }, DIVIDE(&quot;/&quot;) { @Override public int priority() { return 2; } @Override public double compute(double a, double b) { return a / b; } }; Operator(String symbol) { this.symbol = symbol; } /** * è¿ç®—ç¬¦ */ private String symbol; /** * @return è¿ç®—ä¼˜å…ˆçº§ */ public abstract int priority(); /** * @param a ç¬¬ä¸€ä¸ªè¿ç®—æ•° * @param b ç¬¬äºŒä¸ªè¿ç®—æ•° * @return ä¸¤ä¸ªæ•°å¯¹åº”çš„è¿ç®—ç»“æœ */ public abstract double compute(double a, double b); /** * æ ¹æ®è¿ç®—ç¬¦æŸ¥æ‰¾è¿ç®—æ“ä½œç±» * * @param symbol è¿ç®—ç¬¦ * @return è¿ç®—æ“ä½œç±» */ public static Operator getOperatorBySymbol(String symbol) { for (Operator operator : Operator.values()) { if (symbol.equals(operator.toString())) { return operator; } } return null; } @Override public String toString() { return symbol; } } } &emsp;&emsp;è¾“å…¥2ã€4ã€6ã€8èƒ½å¾—åˆ°ä»¥ä¸‹éƒ¨åˆ†ç»“æœ 2*6+4+8 2*6+8+4 2*6*8/4 2*6/4*8 2*8*6/4 2*8/4*6 2/4*6*8 2/4*8*6 2/8+4*6 2/8+6*4 4+2*6+8 4+6*2+8 4+8+2*6 4+8+6*2 4*6+2/8 4*8-2-6 ...ä¼˜åŒ–æ€è·¯&emsp;&emsp;ä¸Šè¿°ç®—æ³•åšäº†å¾ˆå¤šçš„é‡å¤è®¡ç®—ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼ŒåŠ æ³•å’Œä¹˜æ³•æ˜¯æ»¡è¶³äº¤æ¢å¾‹çš„ï¼Œæ‰€ä»¥å¦‚1*2*3*4è¿™ç±»ç»„åˆä»»æ„æ’åˆ—æ‰€å¾—çš„è®¡ç®—ç»“æœéƒ½æ˜¯ç›¸åŒçš„ï¼Œé’ˆå¯¹è¿™éƒ¨åˆ†æˆ‘ä»¬å¯ä»¥å¦‚çˆ¬æ¥¼æ¢¯é—®é¢˜çš„å¤‡å¿˜å½•ç®—æ³•ç¼“å­˜è®¡ç®—ç»“æœï¼Œé˜²æ­¢é‡å¤è®¡ç®—ã€‚ é¢˜ç›®æ‹“å±•ï¼Œæ·»åŠ ä¼˜å…ˆçº§&emsp;&emsp;æˆ‘ä»¬ç®€å•çš„å°†ä¸Šè¿°çš„24ç‚¹æ¸¸æˆæ‰©å±•ä¸€ä¸‹ï¼Œé™¤äº†æ•°å­—å’Œè¿ç®—ç¬¦æˆ‘ä»¬å†åŠ ä¸Šæ‹¬å·çš„é€‰æ‹©ï¼Œè¿™ä¸ªæ—¶å€™æœ‰å¤šå°‘ç§æƒ…å†µï¼Ÿä»£ç è¯¥å¦‚ä½•å˜æ›´ï¼Ÿå…¶å®ç®€å•æƒ³æƒ³åŠ ä¸Šæ‹¬å·å³è®©ä»»æ„ç»„åˆå¦‚ABCDåˆæ¼”å˜å‡ºäº†äº”ç§åŠ æ‹¬å·çš„æ–¹å¼((AB)C)Dã€(A(BC))Dã€(AB)(CD)ã€A(((BC)D)ã€A(B(CD))ï¼Œç„¶åæ ¹æ®æ‹¬å·è¿ç®—æœç´¢å‡ºæ­£ç¡®ç­”æ¡ˆå³å¯ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ä¿®æ”¹ä¸Šè¿°ä»£ç å®Œæˆè¯¥é¢˜ã€‚","link":"/2019-06-17-algorithm-topic/"},{"title":"ç®—æ³•â€”â€”çˆ¬æ¥¼æ¢¯é—®é¢˜","text":"&emsp;&emsp;æœ‰ä¸€åº§é«˜åº¦æ˜¯1000çº§å°é˜¶çš„å¤©æ¢¯ï¼Œä»ä¸‹å¾€ä¸Šèµ°ï¼Œæ¯è·¨ä¸€æ­¥åªèƒ½å‘ä¸Š1çº§æˆ–è€…2çº§å°é˜¶ã€‚è¦æ‰¾å‡ºä¸€å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ è§£é¢˜æ€è€ƒ&emsp;&emsp;å¦‚é¢˜1000çº§å°é˜¶ç€å®æœ‰ç‚¹å¤šäº†ï¼Œæˆ‘ä»¬å…ˆæ¥æ€è€ƒ6çº§é˜¶æ¢¯çš„æƒ…å†µï¼Œå…±13ç§ ïƒ 1+1+1+1+1+1 ïƒ 1+1+1+1+2 ïƒ 1+1+1+2+1 ïƒ 1+1+2+1+1 ïƒ 1+2+1+1+1 ïƒ 2+1+1+1+1 ïƒ 1+1+2+2 ïƒ 1+2+1+2 ïƒ 1+2+2+1 ïƒ 2+1+1+2 ïƒ 2+1+2+1 ïƒ 2+2+1+1 ïƒ 2+2+2 &emsp;&emsp;åœ¨ä»…æœ‰6çº§é˜¶æ¢¯çš„æƒ…å†µä¸‹ç©·ä¸¾å·²ç»æœ‰ä¸€äº›è´¹åŠ›äº†ï¼Œå¦‚æœæ˜¯1000çº§é‚£å‡ ä¹ä¸å¯èƒ½ç©·ä¸¾äº†ï¼Œæˆ‘ä»¬è¦æ€è€ƒæ‰¾å‡ºå…¶ä¸­çš„å¾®å¦™ä¹‹å¤„ã€‚&emsp;&emsp;ç°åœ¨æˆ‘ä»¬å‡è®¾åªå·®æœ€åä¸€æ­¥å°±èƒ½è¾¾åˆ°ç¬¬6çº§é˜¶æ¢¯äº†ï¼Œé‚£ä¹ˆä¼šå‡ºç°å‡ ç§æƒ…å†µï¼Ÿæ— éå°±æ˜¯ä»ç¬¬5çº§èŠ±è´¹ä¸€æ­¥æˆ–è€…ä»ç¬¬4çº§èŠ±è´¹ä¸¤æ­¥è·³åˆ°ç¬¬6çº§é˜¶æ¢¯ï¼Œæˆ‘ä»¬ç°åœ¨å‡è®¾0-4çº§é˜¶æ¢¯æœ‰Xç§èµ°æ³•ï¼Œ0-5çº§é˜¶æ¢¯æœ‰Yç§èµ°æ³•ï¼Œé‚£ä¹ˆ0-6çº§é˜¶æ¢¯çš„èµ°æ³•æœ‰å¤šå°‘ç§ï¼Ÿ ïƒå·®ä¸€æ­¥ ==6çº§== ïƒå·®ä¸¤æ­¥ ==5çº§== ?ç§èµ°æ³•ï´ ==4çº§== Yç§èµ°æ³•ï´ ==3çº§== Xç§èµ°æ³•ï´ ==2çº§== ==1çº§== &emsp;&emsp;æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œè¦èµ°åˆ°ç¬¬6çº§é˜¶æ¢¯æœ€åä¸€æ­¥å¿…ç„¶ä»4æˆ–5çº§é˜¶æ¢¯å¼€å§‹çš„ï¼Œè€Œ4æˆ–5çº§é˜¶æ¢¯æˆ‘ä»¬çŸ¥é“å®ƒçš„èµ°æ³•ä¸ºXä¸Yï¼Œé‚£ä¹ˆæ˜¾ç„¶0-6çº§é˜¶æ¢¯çš„èµ°æ³•å³ä¸ºX+Yï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ¯ä¸€çº§é˜¶æ¢¯çš„èµ°æ³•æ•°ç›®å…¶å®éƒ½æ˜¯ç”±å®ƒçš„å‰ä¸¤çº§é˜¶æ¢¯æ¥å†³å®šçš„ï¼Œå³å¯ç”¨æ­¤å‡½æ•°è¡¨ç¤º fun(N) = func(N - 1) + func(N - 2) &emsp;&emsp;ä¸”æˆ‘ä»¬çŸ¥é“ç¬¬1çº§çš„é˜¶æ¢¯æœ‰ä¸€æ­¥èµ°æ³•ï¼Œç¬¬äºŒçº§çš„é˜¶æ¢¯æœ‰ä¸¤æ­¥èµ°æ³•ï¼Œæ‰€ä»¥å‡½æ•°å®Œæ•´çš„è¡¨ç¤ºä¸º func(1) = 1func(2) = 2fun(N) = func(N - 1) + func(N - 2) &emsp;&emsp;è¿™ç§è§£é¢˜æ€è·¯å³æ˜¯åŠ¨æ€è§„åˆ’æ€æƒ³ï¼Œå°†å¤§äº‹åŒ–å°ï¼Œå°äº‹åŒ–äº†ï¼Œè½¬æ¢ä¸ºç®€å•çš„é—®é¢˜ï¼Œå…¶ä¸­æœ€åä¸€æ­¥å¿…ç„¶ä»4æˆ–5çº§é˜¶æ¢¯å¼€å§‹è¿™ä¸ªç§°ä¹‹ä¸ºæœ€ä¼˜å­ç»“æ„ï¼Œä¸Šè¿°çš„æ–¹ç¨‹ç§°ä¹‹ä¸ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œfunc(1|2)ç§°ä¹‹ä¸ºè¾¹ç•Œã€‚ ç¼–ç å®ç°é€’å½’å®ç°&emsp;&emsp;ä¸Šè¿°çš„æ–¹ç¨‹éšçœ¼ä¸€çœ‹å³çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’æ–¹ç¨‹ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨é€’å½’ç¼–ç¨‹æ¥å®ç°æ­¤é¢˜çš„è§£æ³•ã€‚ public int getStairsWays(int n) { if (n &lt;= 0) { return 0; } if (n == 1 || n == 2) { return n; } return getStairsWays(n - 1) + getStairsWays(n - 2); } &emsp;&emsp;å…¶å®ç¨å¾®è®¡ç®—ä¸€ä¸‹è¿™å¥—å®ç°çš„æ—¶é—´å¤æ‚åº¦ä½ å°±ä¼šå‘ç°éå¸¸ææ€–ï¼Œå®ƒçš„è®¡ç®—é‡ç›¸å½“äºä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº†O(2^N)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚è¿™é“é¢˜ç›®çš„ä¼˜åŒ–ç©ºé—´æ˜¯å¾ˆå¤§çš„ï¼Œæˆ‘ä»¬é¦–å…ˆæ€è€ƒä¸€ä¸‹å®ƒçš„è®¡ç®—è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å¾ˆå¤šéƒ½æ˜¯é‡å¤è®¡ç®—çš„ func(5) = func(4) + func(3) func(4) = func(3) + func(2) func(3) = func(2) + func(1) &emsp;&emsp;func(3)è¢«é‡å¤è®¡ç®—äº†å¾ˆå¤šæ¬¡ï¼Œä¸ºäº†é™ä½è®¡ç®—æ¬¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å·²ç»è®¡ç®—è¿‡çš„ç¼“å­˜èµ·æ¥ï¼Œä¸å»é‡æ–°è®¡ç®—å®ƒã€‚ å¤‡å¿˜å½•ç®—æ³•&emsp;&emsp;å¤‡å¿˜å½•ç®—æ³•æ˜¯é€’å½’å®ç°äº†ä¸€ç§æ”¹è‰¯ç‰ˆï¼Œä½¿ç”¨äº†ä¸€å—å†…å­˜åŒºåŸŸæ¥å­˜å‚¨å·²ç»è®¡ç®—è¿‡çš„é˜¶æ¢¯æ•°ï¼Œé˜²æ­¢é‡å¤è®¡ç®—ï¼Œåœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯HashMapå¯¹è±¡ï¼Œå…¶å®æ›´ä¼˜çš„é€‰æ‹©åº”è¯¥æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºé˜¶æ¢¯é«˜åº¦çš„intæ•°ç»„ã€‚ public int getStairsWays(int n) { return getStairsWays(n, null); } public int getStairsWays(int n, Map&lt;Integer, Integer&gt; cache) { if (n &lt;= 0) { return 0; } if (n == 1 || n == 2) { return n; } if (cache == null) { // åˆå§‹åŒ–ä¸€ä¸ªç¼“å­˜å¯¹è±¡ å®¹é‡ä¸ºlog(n)çš„å‘ä¸Šå–æ•´ cache = new HashMap&lt;&gt;((int) Math.ceil(Math.log(n) / Math.log(2))); } if (cache.containsKey(n)) { return cache.get(n); } int value = getStairsWays(n - 1, cache) + getStairsWays(n - 2, cache); cache.put(n, value); return value; } &emsp;&emsp;æˆ‘ä»¬å¤§æ¦‚çœ‹ä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦ï¼Œå¤‡å¿˜å½•ç¼“å­˜äº†å„çº§èƒŒåŒ…çš„è®¡ç®—ç»“æœå› æ­¤å®ƒçœŸæ­£è®¡ç®—çš„åªæœ‰næ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼Œç”±äºéœ€è¦å†…å­˜å»ç¼“å­˜è®¡ç®—ç»“æœï¼Œæ‰€ä»¥å®ƒçš„ç©ºé—´å¤æ‚åº¦ä¹Ÿä¸ºO(N)&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å†åˆ†æä¸€ä¸‹ï¼Œè¿˜æœ‰æ²¡æœ‰æ›´ä¼˜çš„è§£æ³•å‘¢ï¼Ÿé‡æ–°è§‚å¯Ÿæˆ‘ä»¬çš„è®¡ç®—è¿‡ç¨‹ func(6) = func(5) + func(4) func(5) = func(4) + func(3) func(4) = func(3) + func(2) func(3) = func(2) + func(1) &emsp;&emsp;func(6)åªä¾èµ–äºfunc(5)ä¸func(4)ï¼Œæ‰€ä»¥å½“func(5)ä¸func(4)çš„ç»“æœå€¼å‡ºæ¥ä»¥åï¼Œfunc(3)è¿™ä¸ªç»“æœå°±å†æ²¡å¿…è¦ç¼“å­˜äº†ï¼Œæˆ‘ä»¬æŠŠæ€ç»´é€†è½¬ä¸€ä¸‹ï¼Œä»func(3)å¼€å§‹è®¡ç®—åˆ°func(6)ã€‚ åŠ¨æ€è§„åˆ’ç®—æ³•&emsp;&emsp;è¿™é‡Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨è‡ªåº•å‘ä¸Šçš„è§£æ³•ï¼Œåªéœ€è¦ç”¨ä¸¤ä¸ªå˜é‡æ¥å­˜å‚¨å®ƒçš„ä¸¤ä¸ªä¾èµ–å€¼ï¼Œåˆ†åˆ«æ˜¯å·®ä¸¤æ­¥çš„èµ°æ³•æ•°ç›®(pre)ä»¥åŠå·®ä¸€æ­¥çš„èµ°æ³•æ•°ç›®(next)ï¼Œæœ€ç»ˆçš„èµ°æ³•æ•°ç›®ä¸ºè¿™ä¸¤ä¸ªä¾èµ–å€¼çš„å’Œã€‚ public int getStairsWays(int n) { if (n &lt;= 0) { return 0; } if (n == 1 || n == 2) { return n; } int pre = 1; int next = 2; for (int i = 3; i &lt; n; i++) { int temp = next; next = pre + next; pre = temp; } return pre + next; } &emsp;&emsp;åˆ†æä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦ï¼Œå¾ªç¯n-2æ¬¡è®¡ç®—ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯O(N)ï¼Œå†…å­˜ä¸Šåªå¼€è¾Ÿäº†ä¸¤ä¸ªä¸´æ—¶å˜é‡æ²¡æœ‰é¢å¤–çš„å†…å­˜ç©ºé—´ä½¿ç”¨ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼Œè¿™å°±æ˜¯çœŸæ­£çš„åŠ¨æ€è§„åˆ’ç®—æ³•ã€‚&emsp;&emsp;æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æµ‹è¯•ä¸€ä¸‹ä»¥ä¸Šä¸‰ä¸ªç®—æ³•åœ¨1000ä¸ªé˜¶æ¢¯çš„é‡çº§ä¸‹è¿è¡Œæ—¶é—´ï¼Œåæ­£æˆ‘ä½¿ç”¨é€’å½’è¿è¡Œäº†ä¸€ä¸‹1000æ¬¡é˜¶æ¢¯ï¼Œç­‰äº†ååˆ†é’Ÿä¹Ÿæ²¡ç»“æœæœ€ç»ˆæ”¾å¼ƒäº†â€¦ æœ‰æ²¡æœ‰æ›´ä¼˜è§£&emsp;&emsp;ç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œä¸”æ—¶é—´å¤æ‚åº¦ä¸ºO(logN)ï¼Œæœ‰å…´è¶£çš„å¯ä»¥æœç´¢æ•°è®ºä¸­çš„çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œå¯æ ¹æ®çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¿«é€Ÿè®¡ç®—å‡ºç»“æœï¼Œä¸åŠ¨æ€è§„åˆ’æ€æƒ³ç»“åˆä½¿ç”¨ã€‚&emsp;&emsp;è¿˜æœ‰å°±æ˜¯æˆ‘ä»¬æ¥è§‚å¯Ÿä¸Šé¢è®²åˆ°çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œä¸éš¾çœ‹å‡ºè¿™è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œè€Œæ–æ³¢é‚£å¥‘æ•°åˆ—æ˜¯æœ‰é€šé¡¹å…¬å¼çš„ï¼Œåœ¨å¦‚è¿™ç§ç‰¹å®šé—®é¢˜ä¸‹å¯ä»¥ç›´æ¥ä»£å…¥é€šé¡¹å…¬å¼æ±‚è§£ã€‚ é¢˜ç›®æ‰©å±•ï¼Œ-èƒŒåŒ…é—®é¢˜&emsp;&emsp;ç»™å®šä¸€ç»„å¤šä¸ªï¼ˆnï¼‰ç‰©å“ï¼Œæ¯ç§ç‰©å“éƒ½æœ‰è‡ªå·±çš„é‡é‡ï¼ˆWiï¼‰å’Œä»·å€¼ï¼ˆViï¼‰ï¼Œæ¯ç§ç‰©å“è‡³å¤šé€‰æ‹©ä¸€ä¸ªï¼Œåœ¨é™å®šå¯æ‰¿å—æ€»é‡é‡ï¼ˆCï¼‰çš„èƒŒåŒ…å†…ï¼Œè¦æƒ³èƒŒåŒ…å†…ç‰©å“çš„æ€»ä»·å€¼æœ€é«˜ï¼Œåº”è¯¥é€‰æ‹©é‚£å‡ ä»¶ç‰©å“ï¼Ÿ ç®€åŒ–é¢˜ç›®&emsp;&emsp;æˆ‘ä»¬å…ˆå‡è®¾æœ‰5ç»„ç‰©å“ï¼Œå…¶ä¸­å®ƒçš„ä»·å€¼ä¸é‡é‡åˆ†åˆ«ä¸º[4,2,1,3,1]ã€[4,3,2,1,2]ï¼ŒèƒŒåŒ…å¯æ‰¿å—æ€»é‡é‡ä¸º6ï¼Œæ±‚åº”è¯¥é€‰é‚£å‡ ä»¶ç‰©å“ä½¿å¾—èƒŒåŒ…ä¸­çš„ç‰©å“ä»·å€¼æœ€å¤§ï¼Ÿ åŠ¨æ€è§„åˆ’æ€è·¯å››æ­¥è§£é¢˜é—®é¢˜æ˜¯å¦å¯æ‹†åˆ†ï¼Ÿ&emsp;&emsp;å¦‚çˆ¬æ¥¼æ¢¯é—®é¢˜å¯ä»¥æ‹†åˆ†æˆå‰©ä½™ä¸€æ­¥ä¸å‰©ä½™ä¸¤æ­¥çš„èµ°æ³•ï¼Œæ­¤é—®é¢˜è¯¥å¦‚ä½•æ‹†åˆ†ï¼Ÿ æˆ‘ä»¬å…ˆé’ˆå¯¹æœ€åä¸€ä¸ªç‰©å“(ä»·å€¼ä¸º1ï¼Œé‡é‡ä¸º2)åšå‡è®¾(1) è£…è½½ç‰©å“è¿›å…¥èƒŒåŒ…ï¼Œé—®é¢˜æ¼”å˜æˆï¼Œæœ‰4ç»„ç‰©å“ï¼ŒèƒŒåŒ…æ‰¿é‡é‡ä¸º4ï¼Œåº”è¯¥é€‰é‚£å‡ ä»¶ç‰©å“ä½¿å¾—èƒŒåŒ…ä¸­çš„ç‰©å“ä»·å€¼æœ€å¤§ï¼Ÿ(2) ç‰©å“ä¸è¢«è£…è½½ï¼Œé—®é¢˜æ¼”å˜æˆï¼Œæœ‰4ç»„ç‰©å“ï¼ŒèƒŒåŒ…æ‰¿é‡é‡ä¸º6ï¼Œåº”è¯¥é€‰é‚£å‡ ä»¶ç‰©å“ä½¿å¾—èƒŒåŒ…ä¸­çš„ç‰©å“ä»·å€¼æœ€å¤§ï¼Ÿ(3) æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜å¯ä»¥å¯¹å­æƒ…å†µ(1)ã€(2)åˆ†åˆ«åšå‡è®¾ï¼Œå› æ­¤è¯¥é—®é¢˜æ˜¯å¯æ‹†åˆ†çš„ã€‚ æœ€ä¼˜å­ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ&emsp;&emsp;å¦‚çˆ¬æ¥¼æ¢¯çš„é—®é¢˜çš„æœ€ä¼˜å­ç»“æ„æ˜¯å‰©ä½™ä¸€æ­¥ä¸å‰©ä½™ä¸¤æ­¥çš„èµ°æ³•ç›¸åŠ ï¼Œæ­¤é—®é¢˜çš„æœ€ä¼˜ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ &emsp;&emsp;é’ˆå¯¹æˆ‘ä»¬åˆšåˆšçš„å‡è®¾(1)ã€(2)ï¼Œè¦æƒ³ä½¿å¾—èƒŒåŒ…ç‰©å“ä»·å€¼æœ€å¤§ï¼Œæœ€ä¼˜çš„ç»“æ„æ˜¾è€Œæ˜“è§æ˜¯(1)ã€(2)æƒ…å†µä¸­èƒŒåŒ…ä»·å€¼æ›´å¤§çš„é‚£ä¸ªæ–¹æ¡ˆã€‚ çŠ¶æ€è½¬ç§»æ–¹ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ é—®é¢˜æ‹†åˆ†åŠæ‰¾å‡ºæœ€ä¼˜å­ç»“æ„åï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹å°±å¾ˆå¥½æ¨å¯¼äº†ï¼Œå­˜åœ¨ä¸¤ç§æƒ…å†µ(1) èƒŒåŒ…å®¹é‡å¤§äºç­‰äºä¸‹ä¸€ä¸ªç‰©å“çš„é‡é‡ï¼šç‰©å“å­˜åœ¨é€‰æ‹©ä¸ä¸é€‰ä¸¤ç§æƒ…å†µ(2) èƒŒåŒ…å®¹é‡å°äºä¸‹ä¸€ä¸ªç‰©å“é‡é‡ï¼šç‰©å“ä¸å¯è¢«é€‰æ‹©ï¼Œæƒ…å†µåªæœ‰ä¸€ç§ &emsp;&emsp;å¯å¾—èƒŒåŒ…é—®é¢˜çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸º func(n, c) = max(func(n - 1, c - W[n - 1]) + V[n - 1], func(n - 1, c)) (n &gt; 1, c &gt;= W[n - 1])func(n, c) = func(n - 1, c) (n &gt; 1, c &lt; W[n - 1])å…¶ä¸­n =&gt; å‰©ä½™ç‰©å“æ•°é‡c =&gt; èƒŒåŒ…å‰©ä½™å®¹é‡W =&gt; ç‰©å“é‡é‡æ•°ç»„V =&gt; ç‰©å“ä»·å€¼æ•°ç»„ è¾¹ç•Œæ˜¯ä»€ä¹ˆï¼Ÿ&emsp;&emsp;é—®é¢˜ä¸æ–­çš„å‘å­é—®é¢˜æ‹†åˆ†åä¸€å®šä¼šæœ‰ä¸€ä¸ªå¤´ï¼Œå¦‚çˆ¬æ¥¼æ¢¯æ˜¯å°†ä¸€é˜¶å’ŒäºŒé˜¶æ¥¼æ¢¯ä½œä¸ºè¾¹ç•Œï¼Œé’ˆå¯¹èƒŒåŒ…é—®é¢˜ï¼Œå®ƒçš„è¾¹ç•Œæ˜¯ä»€ä¹ˆï¼Ÿ ä¸éš¾æƒ³åˆ°ï¼Œå½“åªå‰©æœ€åä¸€ä¸ªç‰©å“ï¼Œæ­¤æ—¶æ²¡æœ‰å¤šä½™çš„ç‰©å“èƒ½å¤Ÿé€‰æ‹©äº†ï¼Œå°±åªèƒ½é€‰æ‹©æ­¤ç‰©å“ï¼Œè€Œé€‰æ‹©æ­¤é—®é¢˜æœ‰ä¸¤ç§æƒ…å†µ(1) èƒŒåŒ…å®¹é‡å¤§äºç­‰äºç‰©å“é‡é‡ï¼šæ­¤æ—¶è¿”å›ç‰©å“ä»·å€¼(2) èƒŒåŒ…å®¹é‡å°äºç‰©å“é‡é‡ï¼šæ­¤æ—¶è¿”å›0 &emsp;&emsp;å¯å¾—èƒŒåŒ…é—®é¢˜çš„è¾¹ç•Œä¸º func(1, c) = V[0] (n = 1, c &gt;= W[0])func(1, c) = 0 (n = 1, c &lt; W[0]) ç¼–ç å®ç°-1ç®€å•é€’å½’/** * è·å–æœ€å¤§ä»·å€¼ * * @param n ç‰©å“æ•°é‡ * @param c èƒŒåŒ…å‰©ä½™æ‰¿é‡é‡ * @param w ç‰©å“é‡é‡ * @param v ç‰©å“ä»·å€¼ * @return èƒŒåŒ…è£…é…ç‰©å“çš„æœ€å¤§ä»·å€¼ */ int getMaxValues(int n, int c, int[] w, int[] v) { if (n == 1) { // è¾¹ç•Œ if (c &gt;= w[0]) { return v[0]; } else { return 0; } } if (c &gt;= w[n - 1]) { // çŠ¶æ€è½¬ç§»å…¬å¼ return Math.max(getMaxValues(n - 1, c - w[n - 1], w, v) + v[n - 1], getMaxValues(n - 1, c, w, v)); } else { return getMaxValues(n - 1, c, w, v); } } å¤‡å¿˜å½•ç®—æ³•-1int getMaxValues(int n, int c, int[] w, int[] v) { return getMaxValues(n, c, w, v, null); } int getMaxValues(int n, int c, int[] w, int[] v, Map&lt;String, Integer&gt; cache) { if (n == 1) { // è¾¹ç•Œ if (c &gt;= w[0]) { return v[0]; } else { return 0; } } if (cache == null) { cache = new HashMap&lt;&gt;((int) Math.ceil(Math.log(n) / Math.log(2))); } if (cache.containsKey(generatorCacheKey(n, c))) { return cache.get(generatorCacheKey(n, c)); } int value; if (c &gt;= w[n - 1]) { // çŠ¶æ€è½¬ç§»å…¬å¼ value = Math.max(getMaxValues(n - 1, c - w[n - 1], w, v, cache) + v[n - 1], getMaxValues(n - 1, c, w, v, cache)); } else { value = getMaxValues(n - 1, c, w, v, cache); } cache.put(generatorCacheKey(n, c), value); return value; } String generatorCacheKey(int n, int c) { return String.format(&quot;%s_%s&quot;, n, c); } åŠ¨æ€è§„åˆ’ç®—æ³•-1&emsp;&emsp;è·Ÿçˆ¬æ¥¼æ¢¯é—®é¢˜ä¸€æ ·ï¼Œæˆ‘ä»¬è‡ªåº•å‘ä¸Šæ¥æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¦¨åŸºäºç®€åŒ–çš„é—®é¢˜ç”»ä¸€ä¸ªè¡¨æ ¼æ¥åˆ†æè¿™ä¸ªæƒ…å†µï¼Œè¡¨æ ¼ç¬¬ä¸€åˆ—è¡¨ç¤º5ä¸ªç‰©å“çš„æƒ…å†µï¼Œæ‹¬å·å†…ä»£è¡¨ä»·å€¼ä¸é‡é‡ï¼Œè¡¨æ ¼çš„ç¬¬ä¸€è¡Œè¡¨ç¤ºç»™äºˆçš„èƒŒåŒ…å®¹é‡ï¼Œå…¶ä½™çš„ç©ºç™½æ ¼å­ä»£è¡¨èƒŒçš„æœ€å¤§ä»·å€¼æ•°ã€‚ &emsp;&emsp;ç®€åŒ–çš„é—®é¢˜ï¼šæœ‰5ç»„ç‰©å“ï¼Œå…¶ä¸­å®ƒçš„ä»·å€¼ä¸é‡é‡åˆ†åˆ«ä¸º[4,2,1,3,1]ã€[4,3,2,1,2]ï¼ŒèƒŒåŒ…å¯æ‰¿å—æ€»é‡é‡ä¸º6ã€‚ å‰©ä½™1å®¹é‡ å‰©ä½™2å®¹é‡ å‰©ä½™3å®¹é‡ å‰©ä½™4å®¹é‡ å‰©ä½™5å®¹é‡ å‰©ä½™6å®¹é‡ ç‰©å“1 (4,4) ç‰©å“2 (2,3) ç‰©å“3 (1,2) ç‰©å“4 (3,1) ç‰©å“5 (1,2) &emsp;&emsp;ç¬¬ä¸€è¡Œéå¸¸å®¹æ˜“å¡«å†™ï¼Œåªæœ‰ä¸€ä¸ªç‰©å“çš„æƒ…å†µä¸‹ï¼ŒèƒŒåŒ…æœ€å¤§ä»·å€¼è¦ä¹ˆä¸º0è¦ä¹ˆä¸º4ï¼Œå„è‡ªä¸­ç®­å¤´å‰é¢æè¿°çš„æ˜¯é€‰æ‹©äº†é‚£å‡ ä¸ªç‰©å“ã€‚ å‰©ä½™1å®¹é‡ å‰©ä½™2å®¹é‡ å‰©ä½™3å®¹é‡ å‰©ä½™4å®¹é‡ å‰©ä½™5å®¹é‡ å‰©ä½™6å®¹é‡ ç‰©å“1 (4,4) 0 0 0 1 =&gt; 4 1 =&gt; 4 1 =&gt; 4 ç‰©å“2 (2,3) ç‰©å“3 (1,2) ç‰©å“4 (3,1) ç‰©å“5 (1,2) &emsp;&emsp;æˆ‘ä»¬å°†å…¶ä½™çš„æ ¼å­å…¨éƒ¨å¡«å†™å®Œæˆï¼Œæ¥ä¸‹æ¥çš„è¿™å‡ æ®µå¾ˆé‡è¦ï¼Œç†è§£å®ƒå°±ç†è§£äº†åŠ¨æ€è§„åˆ’ç®—æ³•çš„æ ¸å¿ƒã€‚ ç‰©å“(v,w)/c å‰©ä½™1å®¹é‡ å‰©ä½™2å®¹é‡ å‰©ä½™3å®¹é‡ å‰©ä½™4å®¹é‡ å‰©ä½™5å®¹é‡ å‰©ä½™6å®¹é‡ ç‰©å“1 (4,4) 0 0 0 1 =&gt; 4 1 =&gt; 4 1 =&gt; 4 ç‰©å“2 (2,3) 0 0 2 =&gt; 2 1 =&gt; 4ï’§ 1 =&gt; 4 1 =&gt; 4ï’§ ç‰©å“3 (1,2) 0 3 =&gt; 1 2 =&gt; 2 1 =&gt; 4ïŒ™ 1 =&gt; 4ïŒ™ 1,3 =&gt; 5ïŒ€ ç‰©å“4 (3,1) 4 =&gt; 3 4 =&gt; 3 3,4 =&gt; 4 1,3 =&gt; 5 1,4 =&gt; 7â­ 1,4 =&gt; 7 ç‰©å“5 (1,2) 4 =&gt; 3 4 =&gt; 3 3,4 =&gt; 4 1,3 =&gt; 5 1,4 =&gt; 7 1,4 =&gt; 7 æˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹è§„å¾‹ å…ˆå›é¡¾ä¸€ä¸‹æ ¸å¿ƒçš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ func(n, c) = max(func(n - 1, c - W[n - 1]) + V[n - 1], func(n - 1, c)) æˆ‘ä»¬å…ˆçœ‹ïŒ€/ï’§è¿™ä¸ªå›¾æ ‡ç»„åˆï¼Œåšä¸€ä¸ªæ–¹ç¨‹ä»£å…¥ n = 3 , c = 6 , V[2] = 1 , W[2] = 2æ³¨æ„ï¼Œè¿™é‡ŒV[2]ã€W[2]å¯¹åº”çš„æ˜¯ç‰©å“3ï¼Œå› ä¸ºæ•°ç»„ä»0å¼€å§‹ç¼–å·func(3, 6) = max(func(2, 4) + 1 , func(2, 6)) å†çœ‹â­/ïŒ™è¿™ä¸ªå›¾æ ‡ç»„åˆï¼Œåšä¸€ä¸ªæ–¹ç¨‹ä»£å…¥ n = 4 , c = 5 , V[3] = 3 , W[3] = 1func(4, 5) = max(func(3, 4) + 3 , func(3, 5)) &emsp;&emsp;è§„å¾‹å·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œæ¯ä¸ªæ ¼å­çš„æ•°æ®éƒ½åªä¾èµ–äºå®ƒçš„å‰ä¸€è¡Œæ•°æ®ï¼Œå’Œçˆ¬æ¥¼æ¢¯ä¸­æˆ‘ä»¬æœ€ååªå­˜å‚¨äº†å‰ä¸¤æ­¥æ•°æ®çš„æ€è·¯ä¸€æ ·ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åªéœ€è¦å­˜å‚¨å‰ä¸€è¡Œçš„æ•°æ®å³å¯æ¨å¯¼å‡ºä¸‹ä¸€è¡Œçš„æ•°æ®ï¼Œç¼–ç çš„æ€è·¯å’Œæˆ‘ä»¬å¡«å……è¡¨æ ¼çš„æ€è·¯ä¸€è‡´ï¼Œä»£ç å¦‚ä¸‹ï¼š int getMaxValues(int n, int c, int[] w, int[] v) { int[] pre = new int[c + 1]; // å‰ä¸€è¡Œ int[] current = new int[c + 1]; // å½“å‰è¡Œ for (int i = 1; i &lt;= c; i++) { // å…ˆå¡«å……ç¬¬ä¸€è¡Œ if (i &lt; w[0]) { pre[i] = 0; } else { pre[i] = v[0]; } } for (int i = 1; i &lt; n; i++) { for (int j = 1; j &lt;= c; j++) { // å¡«å……ç¬¬äºŒè¡Œåˆ°æœ€å if (j &lt; w[i]) { // å®¹é‡ä¸å¤Ÿ current[j] = pre[j]; } else { current[j] = Math.max(pre[j - w[i]] + v[i], pre[j]); } } // æ­¤å¤„ä¸å¯ç›´æ¥ä½¿ç”¨ç­‰å· ä¼šå‡ºç°å¼•ç”¨æ··ä¹±çš„æƒ…å†µ pre = Arrays.copyOf(current, current.length); } return current[c]; } é¢˜ç›®æ‰©å±•ï¼Œé‡‡é‡‘çŸ¿&emsp;&emsp;æœ‰ä¸€ä¸ªå›½å®¶å‘ç°äº†nåº§é‡‘çŸ¿ï¼Œæ¯åº§é‡‘çŸ¿çš„é»„é‡‘å‚¨é‡ï¼ˆViï¼‰ä¸åŒï¼Œéœ€è¦å‚ä¸æŒ–æ˜çš„å·¥äººæ•°ï¼ˆLiï¼‰ä¹Ÿä¸åŒã€‚å‚ä¸æŒ–çŸ¿å·¥äººçš„æ€»æ•°æ˜¯Cäººã€‚æ¯åº§é‡‘çŸ¿è¦ä¹ˆå…¨æŒ–ï¼Œè¦ä¹ˆä¸æŒ–ï¼Œä¸èƒ½æ´¾å‡ºä¸€åŠäººæŒ–å–ä¸€åŠé‡‘çŸ¿ã€‚è¦æƒ³å¾—åˆ°å°½å¯èƒ½å¤šçš„é»„é‡‘ï¼Œåº”è¯¥é€‰æ‹©æŒ–å–å“ªå‡ åº§é‡‘çŸ¿ï¼Ÿ &emsp;&emsp;æ­¤é¢˜æ˜¯èƒŒåŒ…é—®é¢˜çš„å˜ç§ï¼Œè§£é¢˜æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±æ€è€ƒä¸€ä¸‹ã€‚","link":"/2019-06-13-algorithm-topic/"},{"title":"ç®—æ³•â€”â€”è€é¼ æ¯’è¯é—®é¢˜","text":"&emsp;&emsp;æœ‰16ç“¶æ°´ï¼Œå…¶ä¸­ä¸€ç“¶æœ‰æ¯’ï¼Œå°ç™½é¼ å–ä¸€æ»´æœ‰æ¯’çš„æ°´ä¸€å°æ—¶åä¼šæ­»ï¼Œè¦åœ¨ä¸€å°æ—¶æ‰¾å‡ºæ¥å“ªç“¶æ°´æœ‰æ¯’æœ€å°‘éœ€è¦å‡ åªå°ç™½é¼  ï¼Ÿ æ„é€ é¢˜ç›®/** * @author JianhuiChen * @description è€é¼ æ¯’è¯é—®é¢˜ * @date 2019/6/12 */ public class MousePoisonQuestion { public static void main(String[] args) { normalSolution(); } /** * æ™®é€šè§£æ³• 16ç“¶æ°´ç”¨16åªè€é¼ æ¥æ‰¾ å“ªåªæ­»äº†ä»£è¡¨å“ªç“¶æ°´æœ‰æ¯’ */ private static void normalSolution() { final int bottleCount = 16; List&lt;Mouse&gt; mouseList = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; bottleCount; i++) { mouseList.add(new Mouse(i, Collections.singleton(i))); } findPoisonWater(bottleCount, mouseList, mouses -&gt; mouses.stream() .filter(Mouse::isDie) .findFirst() .get() .getId()); } /** * å¯»æ‰¾æœ‰æ¯’çš„æ°´ * * @param bottleCount æ°´çš„ç“¶æ•° * @param mouses è€é¼ åˆ—è¡¨ * @param judge æ ¹æ®è€é¼ å–å®Œæ°´çš„çŠ¶æ€åˆ¤æ–­å‡ºæ¯’è¯çš„ç¼–å· */ private static void findPoisonWater(int bottleCount, List&lt;Mouse&gt; mouses, Function&lt;List&lt;Mouse&gt;, Integer&gt; judge) { List&lt;Water&gt; waters = initWaters(bottleCount); mouses.forEach(mouse -&gt; mouse.setDie(waters)); // ä¸€å°æ—¶å int resultPoisonId = judge.apply(mouses); int poisonId = waters.indexOf(waters.stream().filter(Water::isPoison).findFirst().get()); Water water = waters.get(poisonId); assert (water.isPoison()) : &quot;åˆ¤æ–­æœ‰è¯¯,ç¬¬&quot; + poisonId + &quot;ç“¶æ°´ä¸æ˜¯æ¯’è¯,æ­£ç¡®ç­”æ¡ˆæ˜¯ç¬¬&quot; + resultPoisonId + &quot;ç“¶&quot;; System.out.println(&quot;æ­å–œä½ æ‰¾å‡ºäº†åŒ…å«æ¯’è¯çš„æ°´,å…±ä½¿ç”¨äº†&quot; + mouses.size() + &quot;åªè€é¼ &quot;); } /** * åˆå§‹åŒ–Lenç“¶æ°´ * * @param len æ°´ç“¶æ•° * @return å¸¦æœ‰ä¸€ç“¶æ¯’è¯çš„æ°´åˆ—è¡¨ */ private static List&lt;Water&gt; initWaters(int len) { Boolean[] poisons = new Boolean[len]; poisons[new Random().nextInt(len)] = true; return Arrays.stream(poisons) .map(poison -&gt; new Water(poison != null)) .collect(Collectors.toList()); } /** * è€é¼ å¯¹è±¡ */ static class Mouse { /** * è€é¼ å–è¿‡çš„æ°´ID */ private Integer[] drinkWaterIds; /** * è€é¼ ID */ private int id; /** * è€é¼ æ˜¯å¦æ­»äº¡ */ private boolean die; Mouse(int id, Collection&lt;Integer&gt; drinkWaterIds) { this.id = id; this.drinkWaterIds = drinkWaterIds.toArray(new Integer[]{}); } void setDie(List&lt;Water&gt; waters) { this.die = Arrays.stream(drinkWaterIds) .anyMatch(id -&gt; waters.get(id).isPoison()); } boolean isDie() { return die; } int getId() { return id; } } /** * æ°´å¯¹è±¡ */ static class Water { /** * æ˜¯å¦æœ‰æ¯’ */ private boolean poison; Water(boolean poison) { this.poison = poison; } boolean isPoison() { return poison; } } } è§£é¢˜æ€è€ƒ&emsp;&emsp; æ˜¾ç„¶ï¼Œä½¿ç”¨äº†åå…­åªè€é¼ æ¥æ‰¾è¿™ç“¶æ¯’è¯è‚¯å®šä¸æ˜¯æœ€ä¼˜è§£ï¼Œæˆ‘ä»¬æ¥æƒ³ï¼Œ16ç“¶æ°´ä¸­æœ‰ä¸€ç“¶æ¯’è¯ä¸€å…±æœ‰16ç§å¯èƒ½æ€§ï¼Œè€Œè€é¼ æœ‰ç”Ÿå­˜å’Œæ­»äº¡ä¸¤ç§çŠ¶æ€ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨0å’Œ1è¡¨ç¤ºè€é¼ çš„ç”Ÿå­˜ä¸æ­»äº¡ï¼Œé‚£ä¹ˆå››åªè€é¼ å°±èƒ½æ’åˆ—ç»„åˆå‡º16ç§å¯èƒ½æ€§ï¼Œæˆ‘ä»¬æ¥åˆ©ç”¨äºŒè¿›åˆ¶æ’åˆ—å‡ºè¿™16ç§æƒ…å†µã€‚ ï­è€é¼ 1 ï­è€é¼ 2 ï­è€é¼ 3 ï­è€é¼ 4 ïºæ°´ 0 0 0 1 ïº ç“¶å­1 0 0 1 ïº 0 ç“¶å­2 0 0 1 ïº 1 ïº ç“¶å­3 0 1 ïº 0 0 ç“¶å­4 0 1 ïº 0 1 ïº ç“¶å­5 0 1 ïº 1 ïº 0 ç“¶å­6 0 1 ïº 1 ïº 1 ïº ç“¶å­7 1 ïº 0 0 0 ç“¶å­8 1 ïº 0 0 1 ïº ç“¶å­9 1 ïº 0 1 ïº 0 ç“¶å­10 1 ïº 0 1 ïº 1 ïº ç“¶å­11 1 ïº 1 ïº 0 0 ç“¶å­12 1 ïº 1 ïº 0 1 ïº ç“¶å­13 1 ïº 1 ïº 1 ïº 0 ç“¶å­14 1 ïº 1 ïº 1 ïº 1 ïº ç“¶å­15 æ’åˆ—ä¸‹æ¥å³æ˜¯ ï­è€é¼ 1å–ïº 8ï¼Œ9ï¼Œ10ï¼Œ11ï¼Œ12ï¼Œ13ï¼Œ14ï¼Œ15 ï­è€é¼ 2å–ïº 4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ12ï¼Œ13ï¼Œ14ï¼Œ15 ï­è€é¼ 3å–ïº 2ï¼Œ3ï¼Œ6ï¼Œ7ï¼Œ10ï¼Œ11ï¼Œ14ï¼Œ15 ï­è€é¼ 4å–ïº 1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9ï¼Œ11ï¼Œ13ï¼Œ15 è¿™æ ·æ’åˆ—åï¼Œè€é¼ çš„ç”Ÿå­˜ä¸æ­»äº¡çŠ¶æ€éƒ½èƒ½å¾—åˆ°ä¸€ä¸²äºŒè¿›åˆ¶ç ï¼Œè¿™ä¸²äºŒè¿›åˆ¶ç å¯ä»¥è½¬æ¢æˆæœ‰æ¯’çš„ç“¶å­ä¿¡æ¯ï¼Œå¦‚ 0010ï¼šè¡¨ç¤ºï­è€é¼ 3æ­»äº¡ï¼Œå…¶ä½™ï­è€é¼ å­˜æ´»ï¼Œä»£è¡¨ïºç“¶å­2æ˜¯æ¯’è¯ 0000ï¼šè¡¨ç¤ºæ²¡æœ‰ï­è€é¼ æ­»äº¡ï¼Œä»£è¡¨ïºç“¶å­16æ˜¯æ¯’è¯ ç¼–ç å®ç°/** * ä½¿ç”¨äºŒè¿›åˆ¶çš„æ€è·¯è§£æ³• */ private static void binarySolution() { final int bottleCount = 16; List&lt;Mouse&gt; mouseList = new ArrayList&lt;&gt;(); mouseList.add(new Mouse(1, Arrays.asList(8, 9, 10, 11, 12, 13, 14, 15))); mouseList.add(new Mouse(2, Arrays.asList(4, 5, 6, 7, 12, 13, 14, 15))); mouseList.add(new Mouse(3, Arrays.asList(2, 3, 6, 7, 10, 11, 14, 15))); mouseList.add(new Mouse(4, Arrays.asList(1, 3, 5, 7, 9, 11, 13, 15))); findPoisonWater(bottleCount, mouseList, mouses -&gt; { int num = -1; for (Mouse m : mouses) { num += Math.pow(2, m.isDie() ? (m.getId() - 1) : 0); } return num &lt; 0 ? (bottleCount - 1) : num; }); } &emsp;&emsp;è¿è¡Œåç¨‹åºå°†æ‰“å°â€œæ­å–œä½ æ‰¾å‡ºäº†åŒ…å«æ¯’è¯çš„æ°´,å…±ä½¿ç”¨äº†4åªè€é¼ â€ï¼Œä»£ç è¿è¡ŒæˆåŠŸäº†æ²¡é”™ï¼Œä½†æ˜¯é€šç”¨æ€§ä¸è¶³ï¼Œåªèƒ½å¤Ÿé€‚ç”¨äº16åªè€é¼ çš„è§£æ³•ï¼Œèƒ½å¦ç¼–å†™ä¸€ä¸ªæ ¹æ®ç“¶å­æ•°é‡ä½œä¸ºå‚æ•°çš„é€šç”¨è§£æ³•å‡½æ•°ï¼Ÿåªè¦ç†è§£è§£é¢˜æ€è·¯ï¼Œè¿™ä¸ªä»£ç å¹¶ä¸éš¾ï¼Œåœ¨æ­¤å°±ä¸åšæ¼”ç¤ºäº†ã€‚ &emsp;&emsp;æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥åœ¨ä¸‹æ–¹ç•™è¨€ç»™å‡ºé€šç”¨è§£æ³•ï¶ é¢˜ç›®æ‹“å±•&emsp;&emsp;æœ‰16ç“¶æ°´ï¼Œå…¶ä¸­åªæœ‰ä¸€ç“¶æ°´æœ‰æ¯’ï¼Œå°ç™½é¼ å–ä¸€æ»´ä¹‹åä¸€å°æ—¶ä¼šæ­»ã€‚è¯·é—®æœ€å°‘ç”¨å¤šå°‘åªå°ç™½é¼ ï¼Œå¯ä»¥åœ¨1å°æ—¶å†…æ‰¾å‡ºè‡³å°‘14ç“¶æ— æ¯’çš„æ°´ã€‚ &emsp;&emsp;æ‰¾14ç“¶æ— æ¯’çš„æ°´æ˜¯å¯ä»¥è½¬åŒ–ä¸ºå’Œä¸Šé¢é‚£é“ä¸€æ ·çš„è§£é¢˜æ€è·¯ï¼Œæˆ‘ä»¬å°†16ç“¶æ°´åˆ†ä¸º8ç»„ä¸¤ä¸¤ä¸€ç“¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ç»„æ°´ä¸­åŒ…å«æ¯’è¯å³å¯å¾—åˆ°14ç“¶æ— æ¯’çš„æ°´ï¼Œä¸€ç»„æ°´åªå¯èƒ½æœ‰ä¸¤ç§çŠ¶æ€ï¼Œæœ‰æ¯’æˆ–è€…æ— æ¯’ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†8ç»„æ°´çœ‹ä½œ8ç“¶æ°´ï¼Œè‡³æ­¤é¢˜ç›®å°±å˜æˆäº†â€œ8ç“¶æ°´ç”¨æœ€å°‘å‡ åªè€é¼ æ‰¾é‚£ç“¶æœ‰æ¯’çš„æ°´â€ï¼Œç­”æ¡ˆæ˜¯3åªã€‚","link":"/2019-06-12-algorithm-topic/"},{"title":"ä½¿ç”¨Dockeræ­å»ºéš”ç¦»å¼€å‘ç¯å¢ƒ","text":"ä½¿ç”¨Dockeræ­å»ºéš”ç¦»å¼€å‘ç¯å¢ƒ å‰è¨€&emsp;&emsp; æœ€è¿‘æ¥è§¦åˆ°äº†Dockerç›¸å…³çš„çŸ¥è¯†ï¼Œäº†è§£äº†å®ƒçš„ç›¸å…³ç‰¹æ€§ï¼Œå¹¶åŸºäºå®ƒæ­å»ºäº†ä¸€äº›å¦‚mysql/redis/mqä½œä¸ºä¸€ä¸ªåç«¯å¼€å‘æ‰€å¿…é¡»çš„çš„ç¯å¢ƒï¼Œä¸ºä»€ä¹ˆä½¿ç”¨Dockeræ¥æ­å»ºï¼Œå¬æˆ‘å¨“å¨“é“æ¥ã€‚ &emsp;&emsp; æ¢¦å›åˆ°åˆšå­¦åç«¯çš„æ—¶å€™ï¼Œä½ éœ€è¦æ­å»ºä¸ªmysqlç¯å¢ƒï¼Œç„¶åä½ å»æœäº†ä¸‹windows mysql ç¯å¢ƒæ­å»ºï¼Œå¾—åˆ°äº†ä¸€ç§å«ç»¿è‰²ç‰ˆå®‰è£…ï¼Œä¸€ç§å«å‚»ç“œå¼ï¼ˆå®‰è£…åŒ…ï¼‰å¼å®‰è£…ï¼Œä¸€é¡¿æ“ä½œä¹‹åæˆ‘ä»¬çš„ç”µè„‘ç»ˆäºå¤šäº†ä¸€ä¸ªmysqlçš„æœåŠ¡ï¼Œç„¶åä½¿ç”¨NavicatæˆåŠŸè¿æ¥ä¸Šäº†ï¼Œå¼€å§‹æ²¾æ²¾è‡ªå–œã€‚ &emsp;&emsp;ä¸€ä¸ªæœˆåï¼Œç”±äºæŸç§åŸå› ï¼ˆå¯èƒ½ä½ åˆ äº†mysqlåŒ…çš„å“ªä¸ªæ–‡ä»¶ï¼‰ä½ éœ€è¦æŠŠmysqlé‡è£…ä¸€ä¸‹ï¼Œäºæ˜¯ä¹ä½ åˆå»æœäº†ä¸‹windows mysql å¸è½½ï¼Œä½ æƒŠå–œçš„å¾—åˆ°äº†è¿™ä¹ˆä¸€ä¸ªç»“æœ &emsp;&emsp;WTFï¼Ÿå½»åº•å¸è½½å¯è¿˜è¡Œï¼Œäºæ˜¯ä½ èŠ±äº†æ¯”å®‰è£…æ›´å¤šçš„åŠ›æ°”å»å¸è½½äº†ä¸€ä¸ªmysqlã€‚ &emsp;&emsp;å·¥ä½œä¸€å¹´ä¹‹åï¼Œä½ å›æƒ³èµ·ä½ çš„è¿™æ³¢æ“ä½œï¼Œä¸ç¦ç¬‘äº†èµ·æ¥ï¼Œä½ çœ‹ç€ç°åœ¨çš„vmware+centOSè™šæ‹Ÿæœºä¸­æŒ‚ç€çš„mysql+redisç¯å¢ƒä¸ç¦æ²¾æ²¾è‡ªå–œï¼Œè™šæ‹Ÿæœºä¸­çš„å¼€å‘ç¯å¢ƒä¸æœ¬æœºå®Œå…¨éš”ç¦»ï¼Œå“ªå¤©æˆ‘ä¸è¦ç¯å¢ƒäº†ç›´æ¥æŠŠè™šæ‹Ÿæœºå¸äº†å°±è¡Œï¼ŒçœŸæ˜¯ä¸€ä¸ªå¾ˆå®Œç¾çš„é…ç½®å‘¢~ &emsp;&emsp;ä½†æ˜¯ï¼Œä½ ä¼¼ä¹å¿˜è®°äº†ï¼Œä½ èŠ±è´¹äº†å¤šå¤§çš„åŠ›æ°”è¸©äº†å¤šå°‘çš„å‘æ‰æŠ˜è…¾å¥½ä½ è¿™å¥—ç¯å¢ƒï¼Œæƒ³åˆ°è¿™ä½ ä¸ç¦ä¸ºè‡ªå·±ç•™ä¸‹å¿ƒç–¼çš„çœ¼æ³ªã€‚ &emsp;&emsp;è¿™å¥—ç¯å¢ƒæ”¯æ’‘ä½ è·‘äº†å¾ˆä¹…ï¼Œåœ¨æ­¤ä¹‹é—´ä½ è¿˜å­¦ä¼šäº†å¾ˆå¤šlinuxçš„å¸¸è§„æŒ‡ä»¤ï¼Œæˆä¸ºäº†ä¸€ä¸ªè¿ç»´å°èƒ½æ‰‹ï¼Œæœ‰ä¸€å¤©ä½ åœ¨é€›ç¤¾åŒºçš„æ—¶å€™çœ‹åˆ°ä¸€ç¯‡æ–‡ç« å«åšä½¿ç”¨ Docker å¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒï¼Œèƒ½æœ‰å¤šâ€œå¿«â€ï¼Œæˆ‘å¾—å»ç…ç…ï¼Œè·Ÿç€å®ƒæ•²äº†ä¸€éä»£ç ï¼Œmysqlï¼Œå®ƒï¼Œèµ·æ¥äº†ã€‚ &emsp;&emsp;æˆ‘å‘Šè¯‰è‡ªå·±ï¼Œæˆ‘å¾—å»çœ‹çœ‹è¿™ä¸œè¥¿ï¼Œå®ƒæ˜¯ä¸ªä»€ä¹ˆå¦–é­”é¬¼æ€ªã€‚ Dockerä»‹ç»&emsp;&emsp;Dockeräº2013å¹´å‘å¸ƒï¼Œ å±äº Linux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ï¼Œå¯ä»¥è½»æ˜“çš„ä½¿ç”¨/åˆ¶ä½œä¸€ä¸ªé•œåƒï¼ˆå¸¦æœ‰ç¯å¢ƒçš„å®¹å™¨ï¼‰ã€‚å…·ä½“è¯¦ç»†çš„ä»‹ç»ç½‘ä¸Šæœ‰å¤ªå¤šäº†ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚ ç¯å¢ƒæ­å»ºWindows-Dockerç¯å¢ƒæ­å»º&emsp;&emsp;ç¯å¢ƒæ­å»ºçš„æ–‡ç« ä¹Ÿå¾ˆå¤šï¼Œæˆ‘è¿™é‡Œä¸»è¦è¯´ä¸€ä¸‹å¯èƒ½ä¼šè¸©åˆ°çš„å‘ï¼Œdockeré’ˆå¯¹windowsçš„ç”¨æˆ·ä¸»è¦æœ‰ä¸¤ä¸ªå®‰è£…åŒ…å¯ä»¥ä¸‹è½½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é˜¿é‡Œäº‘å¹³å°çœ‹åˆ°å…³äºå®‰è£…çš„Dockerçš„ä¸€äº›å»ºè®®ï¼Œå…·ä½“åŒºåˆ«å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢dockerToolboxå’Œdocker for windowsçš„åŒºåˆ«ï¼Œæœ¬æ–‡ä¸»è¦è®²ä¸€ä¸‹Docker for Windowsçš„å®‰è£…æµç¨‹ã€‚ Docker Toolboxï¼šDockerå·¥å…·é›†å®‰è£…å™¨ Docker for Windowsï¼šWindowså¹³å°çš„Dockerå®‰è£… è¿›å…¥https://www.docker.com/products/docker-desktop ä¸‹è½½Docker for Windowså®‰è£…åŒ…ï¼› æ‰§è¡ŒDocker for Windowså®‰è£…ç¨‹åºï¼Œä¸€è·¯nextï¼ŒDockerè¿è¡ŒæˆåŠŸåä¼šæœ‰é€šçŸ¥ä¸”å³ä¸‹è§’æœ‰logoå›¾æ ‡å­˜åœ¨ï¼› æ²¡äº†ï¼ŒDockerè¿™å°±ç®—å®‰è£…å¥½äº†ï¼Œä½¿ç”¨PowerShellæˆ–è€…cmdæ‰§è¡Œå‘½ä»¤è¯•è¯• Dockerå®‰è£…å®Œæˆåï¼Œç”±äºå®ƒéœ€è¦Hyper-Vçš„æ”¯æŒï¼Œè¿™ä¼šä¸VMwareçš„è™šæ‹Ÿæœºå¯åŠ¨äº§ç”Ÿå†²çªæŠ¥é”™å¦‚ä¸‹ï¼Œå…·ä½“åŸå› è¯·å‚è€ƒDocker å’Œ vmware å…±å­˜å·¥ä½œ ç†Ÿæ‚‰ä¸€ä¸‹åŸºæœ¬æµç¨‹&emsp;&emsp;åœ¨è¿™ä¸ªé˜¶æ®µæˆ‘ä»¬ä½¿ç”¨Dockeræ‹‰å–ä¸€ä¸ªé›†æˆäº†SSHæœåŠ¡çš„centOS7ç³»ç»Ÿé•œåƒï¼Œå°†å®ƒè¿è¡Œèµ·æ¥å¹¶ä½¿ç”¨Xshellè¿œç¨‹è¿æ¥åšä¸€äº›åŸºæœ¬çš„linuxæ“ä½œ # docker pull æ‹‰å–é•œåƒæŒ‡ä»¤ # jdeathe/centos-sshä»£è¡¨é•œåƒåç§° centos-7ä»£è¡¨é•œåƒæ ‡ç­¾ï¼ˆç‰ˆæœ¬ï¼‰ä¸å¡«å–æœ€æ–°latest # å…·ä½“é•œåƒä¿¡æ¯æŸ¥çœ‹ https://hub.docker.com/ docker pull jdeathe/centos-ssh:centos-7 # docker images æŸ¥çœ‹å·²ç»æ‹‰å–çš„é•œåƒåˆ—è¡¨ docker images # docker run å°†é•œåƒæ„å»ºæˆå®¹å™¨ # -d åˆ†ç¦»è¿è¡Œ ä¸ä¼šåœ¨å‘½ä»¤è¡Œæ‰“å°å®¹å™¨è¿è¡Œæ—¥å¿— # --name æŒ‡å®šå®¹å™¨åç§° # -p 2020:22 å°†æœ¬æœºçš„2020ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„22ç«¯å£ # --env è®¾ç½®å®¹å™¨æ”¯æŒçš„ç¯å¢ƒé…ç½® # jdeathe/centos-ssh:centos-7 é•œåƒåç§° docker run -d --name centos-ssh -p 2020:22 --env SSH_PASSWORD_AUTHENTICATION=true --env SSH_USER=admin --env SSH_USER_PASSWORD=123456 jdeathe/centos-ssh:centos-7 # docker inspect æŸ¥çœ‹æŒ‡å®šå®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ centos-sshæ˜¯åˆšåˆšæŒ‡å®šçš„å®¹å™¨åç§° docker inspect centos-ssh # docker ps æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ è¿è¡ŒæˆåŠŸåˆ™ä¼šæ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­ docker ps # ä½¿ç”¨XShellè¿›å…¥å®¹å™¨ locahost:2020 admin/123456 &emsp;&emsp;æˆåŠŸè¿æ¥ä¸Šå®¹å™¨å¹¶æ‰§è¡Œäº†ä¸€äº›åŸºç¡€æ“ä½œ &emsp;&emsp;é™¤å»ä¸å¿…è¦çš„æ‰“å°ä¿¡æ¯æŒ‡ä»¤ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸¤è¡Œä»£ç å³å¯åˆ›å»ºä¸€ä¸ªcentOSç³»ç»Ÿé•œåƒå®¹å™¨ å¯è§†åŒ–ç•Œé¢&emsp;&emsp;æŒ‡ä»¤æ“ä½œè™½ç„¶èƒ½è®©ä½ æ›´åŠ ç†Ÿç»ƒä¸”è£…é€¼ï¼Œä½†å®ƒæ€»æ˜¯ç¹ççš„ï¼ŒDockerå®˜æ–¹åŠå‘¨è¾¹æä¾›äº†å¾ˆå¤šåŸºäºDockeræŒ‡ä»¤çš„å‚»ç“œå¼UIç¨‹åºï¼Œåœ¨è¿™é‡Œæˆ‘ä¸»è¦ä»‹ç»ä¸¤æ¬¾ Kitematic-GUIç¨‹åº&emsp;&emsp;Kitematicæ˜¯ç”±Dockerå®˜æ–¹æä¾›çš„ä¸€æ¬¾æ¡Œé¢åº”ç”¨ï¼Œæä¾›äº†Windowså¹³å°ä¸‹çš„ç»¿è‰²ç‰ˆå‹ç¼©åŒ…ï¼Œä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ã€‚ å‰å¾€Kitematicçš„github releasesä»“åº“ä¸‹è½½Kitematic-XXX-Windows.zipï¼› è§£å‹ç›´æ¥è¿è¡Œ Kitematic.exeï¼Œç•Œé¢å¦‚ä¸‹ ç‚¹å‡»ä¸€ä¸ªå®¹å™¨å¯è¿›å…¥è¯¦æƒ…é¡µé¢ ç‚¹å‡»Settingsè¿›å…¥é…ç½®é¡µé¢ Portainer-Webç¨‹åº&emsp;&emsp;Portaineræ˜¯ä¸€ä¸ªè½»é‡çº§çš„ç®¡ç†ç•Œé¢ï¼Œå¯ä»¥è®©æ‚¨è½»æ¾åœ°ç®¡ç†ä¸åŒçš„Dockerç¯å¢ƒï¼ŒåŠŸèƒ½æ¯”Kitematicå¼ºå¤§è®¸å¤šã€‚ &emsp;&emsp;Portaineræ˜¯åŸºäºç½‘é¡µæ¥æ“ä½œçš„ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªB/Sæ¶æ„çš„ç¨‹åºï¼Œå®ƒæœ‰å•ç‹¬çš„é•œåƒå‘å¸ƒåœ¨Dockerä¸­ï¼Œæ‰€ä»¥å®ƒçš„ä½¿ç”¨ä¹Ÿéå¸¸ä¾¿æ·ï¼Œæˆ‘ä»¬åªéœ€è¦æ‹‰å–é•œåƒè¿è¡Œå³å¯ã€‚ # æ‹‰å–æœ€æ–°çš„portaineré•œåƒ docker pull portainer/portainer # --restart=always ä»£è¡¨å®¹å™¨æ€»æ˜¯éšç€Dockerå¯åŠ¨è€Œå¯åŠ¨ # -v é…ç½®æŒä¹…åŒ–è·¯å¾„ docker run -d -p 9000:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock --name portainer portainer/portainer # æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€ docker ps # æ­£å¸¸æƒ…å†µä¸‹æœåŠ¡å·²ç»è¿è¡Œåœ¨ http://localhost:9000 è¿›å…¥ http://localhost:9000/#/init/admin ï¼Œ è¿›è¡Œç®¡ç†å‘˜é…ç½®ï¼› åˆå§‹åŒ–Dockerç«¯ç‚¹é…ç½®http://localhost:9000/#/init/endpoint ï¼Œ éœ€è¦é…åˆåœ¨Dockeré…ç½®å¼€å¯Web ApiæœåŠ¡ï¼› è¿›å…¥Portainerä¸»é¡µï¼ŒæŸ¥çœ‹ç›¸å…³é…ç½® å¼€å‘é›†æˆç¯å¢ƒæ­å»º&emsp;&emsp;åœ¨æœ‰äº†å‰é¢ç¯å¢ƒçš„é“ºå«ä¹‹åï¼Œç°åœ¨å¯ä»¥å¾ˆè½»æ˜“å°±æ­å»ºå¥½æˆ‘ä»¬æ‰€éœ€è¦çš„å¼€å‘ç¯å¢ƒï¼Œå…·ä½“æ“ä½œæ— éæ˜¯ æ‰¾åˆ°æ‰€éœ€çš„é•œåƒåŠç‰ˆæœ¬ï¼Œæ‹‰å–é•œåƒ æ ¹æ®é•œåƒæè¿°åšå¥½é…ç½®å¹¶å¯åŠ¨ æµ‹è¯•ç¯å¢ƒæ˜¯å¦å¯ç”¨ mysql&emsp;&emsp;ä»»æ„æ‰¾ä¸€ä¸ªGUIç¨‹åºæœç´¢åˆ°æ‰€éœ€çš„é•œåƒï¼Œæ‹‰å–è¿è¡Œå³å¯ &emsp;&emsp;å…³äºmysqlè¿æ¥å¯†ç å¯åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®é‡å¯ &emsp;&emsp;ä½¿ç”¨Navicatæµ‹è¯•è¿æ¥æ˜¯å¦å¯ç”¨ï¼Œè¿™é‡Œä¸»è¦è¦çœ‹é•œåƒä¸å®¿ä¸»æœºå™¨çš„ç«¯å£æ˜ å°„è¡¨ï¼Œä½¿ç”¨ localhost:3306 root/123456 å³å¯è¿æ¥ä¸Šmysqlï¼Œç¯å¢ƒæ­å»ºæˆåŠŸ redis&emsp;&emsp;ä½¿ç”¨Kitematicæœç´¢redisç›¸å…³é•œåƒï¼Œç‚¹å‡»åˆ›å»ºï¼Œä½¿ç”¨RedisDesktopManagerè¿›è¡Œæµ‹è¯•ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç éªŒè¯çš„æ¨¡å¼ï¼Œå¦‚æœéœ€è¦æ›´æ”¹å¯ä»¥è¿›å…¥å®¹å™¨å†…éƒ¨ä¿®æ”¹ï¼Œè¿™éƒ¨åˆ†æ“ä½œæˆ‘ä¼šåœ¨åç»­çš„åšå®¢æ•´ç† rabbitmq&emsp;&emsp;å…¶ä»–çš„ç¯å¢ƒæ“ä½œéƒ½æ˜¯ç±»ä¼¼çš„ï¼Œå½“ç„¶å¦‚æœæ²¡æœ‰æœç´¢ä½ æƒ³è¦çš„é•œåƒï¼ˆæ¯”å¦‚ä½ æƒ³è¦ä¸€ä¸ªmysql+redisçš„é•œåƒï¼‰ï¼Œå¯ä»¥è‡ªå·±æ„å»ºå‘å¸ƒï¼Œåœ¨æ­¤ä¹‹å‰ä½ å¯èƒ½éœ€è¦æ³¨å†Œä¸€ä¸ªDockerè´¦å· å…¶ä»–é…ç½®Dockeré•œåƒåŠ é€Ÿ&emsp;&emsp;æ³¨å†Œä¸€ä¸ªé˜¿é‡Œäº‘è´¦å·ï¼Œè¿›å…¥æ§åˆ¶å°-&gt;å®¹å™¨é•œåƒæœåŠ¡-&gt;é•œåƒä¸­å¿ƒ-&gt;é•œåƒåŠ é€Ÿå™¨ï¼Œè·å–åˆ°åŠ é€Ÿå™¨çš„åœ°å€ï¼Œå¤åˆ¶åˆ°Dockerçš„Settings/Daemonä¸­ï¼Œé‡å¯Dockerå³å¯ã€‚ å‚è€ƒèµ„æ–™ Windows 10 å®‰è£…Docker for Windows - æ™“æ™¨Master - åšå®¢å›­ ä½¿ç”¨ Docker å¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒ dockerToolboxå’Œdocker for windowsçš„åŒºåˆ«- Nullçš„åšå®¢- CSDNåšå®¢ Docker å’Œ vmware å…±å­˜å·¥ä½œ - rodert - CSDNåšå®¢ Dockerå„ç§å¯è§†åŒ–ç•Œé¢çš„æ¯”è¾ƒ","link":"/2019-04-19-docker-env/"},{"title":"æˆ‘çš„åšå®¢å¯ä»¥è‡ªå·±éƒ¨ç½²å•¦","text":"åšå®¢ä½ å·²ç»é•¿å¤§äº†ï¼Œè¯¥å­¦ä¼šè‡ªå·±éƒ¨ç½²äº† æˆ‘çš„è‡ªåŠ¨åŒ–è¿ç»´å¹³å°å·²ç»æˆåŠŸä¸Šçº¿å•¦~ åšå®¢å¯ä»¥è‡ªå·±ç…§é¡¾è‡ªå·±å•¦~ æœ¬ç¯‡åšå®¢ç”¨äºæµ‹è¯•è‡ªåŠ¨åŒ–è¿ç»´å¹³å°æ˜¯å¦æ­£å¸¸è¿è¡Œ åœ¨æˆ‘å†™å®Œè¿™ç¯‡åšå®¢æ‰§è¡Œä»¥ä¸‹è„šæœ¬å git add . git commit -m&quot;è‡ªåŠ¨éƒ¨ç½²æµ‹è¯•&quot; git push origin master è¿™æ—¶å€™å¯¹è¯å¼€å§‹äº† githubï¼šjenkinså…„å¼Ÿï¼Œå¿«èµ·æ¥ï¼Œè¯¥å¹²æ´»äº† Jenkinsçœ‹çœ‹æ¥çš„ä»»åŠ¡ï¼Œblogsï¼Œokï¼Œi know jenkinsï¼šåŒ…åœ¨æˆ‘èº«ä¸Š # æ‹‰å–ä»£ç  git clone https://github.com/calebman/blog.git # æ‰“å°ç‰ˆæœ¬ node -v npm -v # å®‰è£…hexo-cliè„šæ‰‹æ¶ npm install -g hexo-cli hexo -v # å®‰è£…ä¾èµ– npm i # æ‰“åŒ…åšå®¢ hexo clean hexo g # å°†æ‰“åŒ…æ–‡ä»¶ç§»åŠ¨åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½• nginxé…ç½®ç›®å½• cp -rf public/* /home/app/application/blogs/ # éƒ¨ç½²åˆ° github.io hexo d jenkinsï¼šå‘å°é‚®ä»¶ç»™ä¸»äººå‘Šè¯‰ä»–æˆ‘å¹²å®Œäº† ç›¯ çœ‹çœ‹æ‰‹æœºï¼Œå¥½çš„çœ‹æ¥åšå®¢å·²ç»ä¸Šçº¿äº† è®¿é—®http://blog.chenjianhui.siteè¯•è¯• æœ‰äº†ï¼Œjenkinsè¾›è‹¦è¾£ï¼Œä¸‹æ¬¡ç»™ä½ æ¢ä¸ªæ›´å¥½çš„æœåŠ¡å™¨ç¯å¢ƒ æµ‹è¯•æˆåŠŸEnding~","link":"/2019-03-07-blog-with-jenkins/"},{"title":"å‰åç«¯åˆ†ç¦»æ¨¡å¼ä¸‹çš„DevOps","text":"Jenkins+Git+Maven+Nodejså®ç°å‰åç«¯åˆ†ç¦»é¡¹ç›®çš„è‡ªåŠ¨åŒ–è¿ç»´ èƒŒæ™¯æ¦‚è¿°ç†è§£Devops&emsp;&emsp; ç»´åŸºç™¾ç§‘å¯¹Devopsçš„å®šä¹‰æ˜¯ï¼šä¸€ç§é‡è§†â€œè½¯ä»¶å¼€å‘äººå‘˜ï¼ˆDevï¼‰â€å’Œâ€œITè¿ç»´æŠ€æœ¯äººå‘˜ï¼ˆOpsï¼‰â€ä¹‹é—´æ²Ÿé€šåˆä½œçš„æ–‡åŒ–ã€è¿åŠ¨æˆ–æƒ¯ä¾‹ã€‚é€è¿‡è‡ªåŠ¨åŒ–â€œè½¯ä»¶äº¤ä»˜â€å’Œâ€œæ¶æ„å˜æ›´â€çš„æµç¨‹ï¼Œæ¥ä½¿å¾—æ„å»ºã€æµ‹è¯•ã€å‘å¸ƒè½¯ä»¶èƒ½å¤Ÿæ›´åŠ åœ°å¿«æ·ã€é¢‘ç¹å’Œå¯é ã€‚ &emsp;&emsp;è‡ªåŠ¨åŒ–è¿ç»´ä»¥åŠæŒç»­é›†æˆéƒ¨ç½²æ˜¯Devopsçš„æ ¸å¿ƒæ€æƒ³ï¼Œå½“ä½ å‘ç°è‡ªå·±æ¯å¤©èŠ±è´¹äº†å¤§é‡çš„æ—¶é—´åœ¨ç­‰å¾…ç¨‹åºæ‰“åŒ…/ä¸Šä¼ è‡³æœåŠ¡å™¨ç­‰è¿‡ç¨‹ä¸­æ—¶ï¼Œä½ å°±åº”è¯¥æ€è€ƒï¼Œæ˜¯å¦éœ€è¦å°†è¿™äº›é‡å¤æ€§çš„è¡Œä¸ºäº¤ç»™æœºå™¨å»åšï¼Œæ¥è§£æ”¾è‡ªå·±èŠ±è´¹åœ¨è¿™éƒ¨åˆ†çš„æ—¶é—´ã€‚ æˆ‘ä¸ºä½•è¦å¼•å…¥DevopsèƒŒæ™¯ç®€ä»‹&emsp;&emsp;æ¥¼ä¸»æ˜¯ä¸€ä¸ªå¸¸å¹´åœ¨äºŒä¸‰çº¿åŸå¸‚å°å…¬å¸æ¼‚æ³Šçš„è‹¦é€¼ç¨‹åºå‘˜ï¼Œå°å…¬å¸çš„ç‰¹æ€§å°±æ˜¯ä¸€äººå½“ä¸‰äººä½¿ï¼Œä¸€ä¸ªäººå…¼åšå¼€å‘æµ‹è¯•åŠ è¿ç»´ï¼Œå…¬å¸é‡‡ç”¨æ•æ·å¼€å‘æ¨¡å¼ï¼Œç°æœ‰å¹³å°4å¥—ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å‰åç«¯åˆ†ç¦»çš„ç³»ç»Ÿï¼Œç”±äºåŠŸèƒ½è°ƒæ•´çš„æ¯”è¾ƒå¿«å¯¼è‡´éƒ¨ç½²æ¼”ç¤ºçš„é¢‘æ¬¡éå¸¸é«˜ï¼Œæœ€å¤šä¼šå‡ºç°ä¸€å¤©éƒ¨ç½²10æ¬¡å·¦å³ï¼Œå†åŠ ä¸Šsshæ–‡ä»¶ä¸Šä¼ ä¸webpackçš„æ‰“åŒ…ç¨‹åºçš„è¿è¡Œæ—¶é—´è¾ƒé•¿ï¼Œæœ€å¿«çš„æœ¬åœ°æ‰“åŒ…+sshä¸Šä¼ +å¯åŠ¨è¿œç¨‹è¿è¡Œè„šæœ¬çš„æµç¨‹èµ°ä¸‹æ¥ä¹Ÿå¾—5minå·¦å³ï¼Œæ‰€ä»¥å…‰éƒ¨ç½²è¿™ä¸€å—èŠ±è´¹çš„äººåŠ›æˆæœ¬å·²ç»ä¸å¯å¿½ç•¥äº†ã€‚ åº”ç”¨æ¶æ„ç®€ä»‹&emsp;&emsp;æ¥¼ä¸»å…¬å¸çš„webåº”ç”¨ä¸»è¦é‡‡ç”¨SpringBoot+Vuejså‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼ï¼Œæ‰“åŒ…åçš„åº”ç”¨ç”±Nginxæ¥åŠ¨é™å†…å®¹åˆ†å‘ï¼Œåº”ç”¨æ¶æ„çš„è¯¦æƒ…å¯è§æˆ‘çš„å¦ä¸€ç¯‡åšå®¢å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼çš„å®è·µæ€»ç»“ï¼Œæºä»£ç è·å–ç‚¹å‡»è¿™é‡Œï¼Œæœ¬æ–‡ä¹Ÿå°†å›´ç»•ç€è¿™ä¸ªç»“æ„çš„å·¥ç¨‹æ¥åšè‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚ å†²çªä¸é—®é¢˜ ç­‰å¾…ç¨‹åºæ‰“åŒ…æ—¶é—´è¿‡é•¿ï¼ˆç‰¹åˆ«æ˜¯webpackçš„æ‰“åŒ…ï¼‰ï¼Œå¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰å¾…ï¼Œè¿™ä»¶äº‹åœ¨è¿›è¡Œä¸­ä¹Ÿä¸å¥½åšåˆ«çš„äº‹æƒ… é‡å¤æ€§åŠ³åŠ¨è¿‡å¤šï¼Œæ¯æ¬¡æ‰“åŒ…éƒ½æ˜¯è¿è¡Œæ‰“åŒ…è„šæœ¬ï¼Œä¸Šä¼ æ‰“åŒ…åçš„æ–‡ä»¶å¤¹ï¼Œè¿è¡Œè¿œç¨‹å¯åŠ¨è„šæœ¬ å®¹æ˜“å‡ºé”™ï¼Œå‡è®¾ç°æœ‰çš„ç¯å¢ƒæ˜¯ä¸¤å¥—ï¼ˆæ¼”ç¤ºä¸ç”Ÿäº§ï¼‰ï¼Œé‚£ä¹ˆè¿œç«¯è¿è¡Œè„šæœ¬éœ€è¦æ ¹æ®ç¯å¢ƒçš„ä¸åŒæ¥ä¼ é€’ä¸åŒçš„ç¯å¢ƒå˜é‡ï¼Œäººä¸ºé”™è¯¯ææ˜“å‘ç”Ÿ ç†æƒ³ç¯å¢ƒ ç¨‹åºå‘˜æäº¤ä»£ç è‡³devåˆ†æ”¯ï¼Œæ­¤æ—¶è§¦å‘æ¼”ç¤ºç¯å¢ƒçš„æ‰“åŒ…éƒ¨ç½²ç¨‹åº æŠ€æœ¯è€å¤§æäº¤ä»£ç è‡³masteråˆ†æ”¯ï¼Œæ­¤æ—¶è§¦å‘ç”Ÿäº§ç¯å¢ƒçš„æ‰“åŒ…éƒ¨ç½²ç¨‹åº æ‰“åŒ…æˆåŠŸ/å¤±è´¥/ä¸­æ–­é€šçŸ¥åˆ°é’‰é’‰å·¥ä½œç¾¤ Devopså®è·µWindows10ç¯å¢ƒæ­å»º javaï¼šJDKå¼€å‘ç¯å¢ƒæ­å»ºåŠç¯å¢ƒå˜é‡é…ç½® tomcatï¼šWindowså®‰è£…å’Œé…ç½®Tomcat gitï¼šGitå®‰è£…æ•™ç¨‹ jenkins ç‚¹æ­¤ä¸‹è½½jenkinsçš„waråŒ… å°†jenkins.warå¤åˆ¶åˆ°tomcatæœåŠ¡å™¨çš„webappsç›®å½•ä¸‹ é…ç½®jenkinsçš„å·¥ä½œç›®å½•ï¼Œåœ¨æˆ‘çš„ç”µè„‘-å±æ€§-é«˜çº§ç³»ç»Ÿè®¾ç½®-ç¯å¢ƒå˜é‡-æ·»åŠ ç³»ç»Ÿå˜é‡JENKINS_HOMEï¼Œå†…å®¹æ˜¯ä¸€ä¸ªç©ºçš„æ–‡ä»¶å¤¹ï¼Œä½œä¸ºjenkinsçš„å·¥ä½œç›®å½•ã€‚å¦‚æœä¸æƒ³è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ä¹Ÿå¯ä»¥ä¿®æ”¹åŠ è½½æœ‰jenkins.warçš„tomcatç›®å½•ä¸‹çš„conf\\context.xmæ–‡ä»¶ï¼Œå¦‚ä¸‹è®¾ç½®JENKINS_HOME è®¿é—®jenkinsçš„ä¸»é¡µhttp://localhost:8080/jenkins &lt;!-- tomcat context.xml ç¯å¢ƒå˜é‡è®¾ç½® --&gt; &lt;Context&gt; &lt;!-- è®¾ç½®jenkinsçš„å·¥ä½œç›®å½• --&gt; &lt;Environment name=&quot;JENKINS_HOME&quot; value=&quot;C:/jenkins/&quot; type=&quot;java.lang.String&quot;/&gt; &lt;/Context&gt; CentOS7-3ç¯å¢ƒæ­å»º&emsp;&emsp;åœ¨CentOS7ä¸‹æ­å»ºjenkinså’ŒWindowsç¯å¢ƒå·®ä¸å¤šï¼Œjenkinsæ˜¯ä¸€ä¸ªä¾èµ–äºwebå®¹æ˜“çš„waråŒ…ï¼Œæ‰€ä»¥åªè¦æœ‰javaä¸tomcatç¯å¢ƒå³å¯ gitç¯å¢ƒ# åˆ¤æ–­gitæ˜¯å¦å·²å­˜åœ¨ æ‰“å°å†…å®¹åˆ™ä»£è¡¨å­˜åœ¨ git --version # ä¸å­˜åœ¨åˆ™å®‰è£… å‡ºç°completeè¯´æ˜å®‰è£…æˆåŠŸ yum install -y git jdkç¯å¢ƒ jdk1.8ä¸‹è½½ï¼šç‚¹æ­¤ä¸‹è½½ è§£å‹é…ç½® mkdir /usr/java # ä½¿ç”¨Xftpå°†ä¸‹è½½çš„jdkæ”¾åˆ°æ­¤ç›®å½• cd /usr/java # è§£å‹jdk tar -zxvf jdk-8u201-linux-x64.tar.gz # ä¿®æ”¹é…ç½®æ–‡ä»¶ vim /etc/profile # æ–‡ä»¶æœ«å°¾æ·»åŠ javaçš„ç¯å¢ƒå˜é‡ JAVA_HOME=/usr/java/jdk1.8.0_201 JRE_HOME=/usr/java/jdk1.8.0_201/jre PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib export JAVA_HOME JRE_HOME PATH CLASSPATH # ä½¿å¾—é…ç½®ç”Ÿæ•ˆ source /etc/profile # æµ‹è¯•é…ç½® java -version tomcatç¯å¢ƒ tomcat8ä¸‹è½½ï¼šç‚¹æ­¤ä¸‹è½½ è§£å‹é…ç½® # ä½¿ç”¨Xftpå°†ä¸‹è½½çš„tomcatæ”¾åˆ°æ­¤ç›®å½• mkdir /usr/tomcat cd /usr/tomcat # è§£å‹tomcat tar -zxvf apache-tomcat-8.5.38.tar.gz # æµ‹è¯•è¿è¡Œ cd apache-tomcat-8.5.38 sh bin/startup.sh # æ£€æµ‹æœåŠ¡æ˜¯å¦æˆåŠŸå¯åŠ¨ æ‰“å°äº†è¿›ç¨‹å³è¯´æ˜å¯åŠ¨æˆåŠŸ netstat -nlp|grep 8080 # ç¨å¾®æ¸…ç†ä¸€ä¸‹tomcat åˆ é™¤æ²¡æœ‰ç”¨çš„é¡¹ç›® rm -rf /usr/tomcat/apache-tomcat-8.5.38/webapps/* # é…ç½®è‡ªåŠ¨å¯åŠ¨ /etc/rc.d/init.d ä¸ºå¯åŠ¨è¿è¡Œè„šæœ¬çš„ç›®å½• cd /etc/rc.d/init.d # åˆ›å»ºè‡ªå¯åŠ¨è„šæœ¬ touch tomcat # å†™å…¥è„šæœ¬ä¿¡æ¯ vim tomcat # è„šæœ¬ä¿¡æ¯å¦‚ä¸‹ ä»¥ä¸‹æ³¨é‡Šä¿¡æ¯ä¹Ÿéœ€è¦å¤åˆ¶è¿›è„šæœ¬æ–‡ä»¶ # å¦‚æœç¼ºå°‘äº†chkconfig:234 20 80è¿™ä¸ªæ³¨é‡Šä¼šæŠ¥é”™æ— æ³•è¯†åˆ«ä¸ºè‡ªå¯è„šæœ¬ #!/bin/sh #chkconfig:234 20 80 #description:tomcat JAVA_HOME=/usr/java/jdk1.8.0_201 export JAVA_HOME PATH=$JAVA_HOME/bin:$PATH export PATH tomcat_path=/usr/tomcat/apache-tomcat-8.5.38/bin case &quot;$1&quot; in start) echo &quot;start tomcat service..&quot; sh ${tomcat_path}/startup.sh ;; *) exit 1 ;; esac # èµ‹äºˆæƒé™ chmod 755 tomcat # æ³¨å†ŒtomcatæœåŠ¡è‡ªå¯ chkconfig --add tomcat # æµ‹è¯•æœåŠ¡æ˜¯å¦èƒ½å¤Ÿè‡ªå¯ å…ˆåœæ­¢è¿è¡Œä¸­çš„tomcat sh /usr/tomcat/apache-tomcat-8.5.38/bin/shutdown.sh service tomcat start netstat -nlp|grep 8080 # æŸ¥çœ‹æ‰€æœ‰æ³¨å†Œè‡ªå¯çš„æœåŠ¡ chkconfig jenkinsç¯å¢ƒ jenkinsä¸‹è½½ï¼šç‚¹æ­¤ä¸‹è½½ é…ç½® mkdir /usr/jenkins # ä½¿ç”¨Xftpå°†ä¸‹è½½çš„tomcatæ”¾åˆ°æ­¤ç›®å½• cd /usr/jenkins # å¤åˆ¶jenkins.warè‡³tomcat/webappsç›®å½• cp jenkins.war /usr/tomcat/apache-tomcat-8.5.38/webapps # jenkins.warä¼šè‡ªåŠ¨è§£åŒ…å¯åŠ¨ è¿›å…¥tomcat/webappsç›®å½•æŸ¥çœ‹ jenkins.warå·²ç»è§£åŒ…æˆäº†æ–‡ä»¶å¤¹ cd /usr/tomcat/apache-tomcat-8.5.38/webapps ls # ä¿®æ”¹tomcatç¯å¢ƒé…ç½®å°†jenkinsçš„å·¥ä½œç›®å½•åˆ‡æ¢è‡³/home/app/jenkins vi /usr/tomcat/apache-tomcat-8.5.38/conf/context.xml # Contextæ ‡ç­¾ä¸‹æ·»åŠ ä»¥ä¸‹å†…å®¹ &lt;Environment name=&quot;JENKINS_HOME&quot; value=&quot;/home/app/jenkins&quot; type=&quot;java.lang.String&quot;/&gt; # é‡å¯tomcat cd /usr/tomcat/apache-tomcat-8.5.38 sh bin/shutdown.sh sh bin/startup.sh # æ£€æŸ¥å·¥ä½œç›®å½•åˆ‡æ¢æ˜¯å¦æˆåŠŸ æœ‰æ–‡ä»¶å³æˆåŠŸ cd /home/app/jenkins # æ¸…ç©ºåŸå…ˆçš„å·¥ä½œç©ºé—´ jenkinsé»˜è®¤å·¥ä½œç©ºé—´ä¸º /root/.jenkins rm -rf /root/.jenkins é…ç½®JenkinsJenkinsçš„åˆå§‹åŒ– ç¬¬ä¸€æ¬¡è¿›å…¥jenkinsæ—¶ä¼šè¦æ±‚ä½¿ç”¨åˆå§‹å¯†ç è§£é”ï¼ŒæŒ‰ç…§æç¤ºæ“ä½œå°±è¡Œäº† ä¹‹åä¼šæç¤ºä½ å®‰è£…æ’ä»¶ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨é»˜è®¤å®‰è£…å¿…è¦çš„æ’ä»¶å³å¯ï¼Œå…¶ä»–çš„æ’ä»¶æˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿå†…éƒ¨å†å»å®‰è£… è€å¿ƒç­‰å¾…æ’ä»¶å®‰è£…å®Œæ¯• åˆå§‹åŒ–å®Œæˆï¼Œé…ç½®ç®¡ç†å‘˜ç”¨æˆ· é…ç½®jenkinså®ä¾‹åœ°å€ï¼Œä¸¾ä¸ªä¾‹å­è§£é‡Šå®ä¾‹é…ç½®çš„åœ°å€ç”¨å¤„ å‡è®¾ä½ åšäº†é¡¹ç›®æ‰“åŒ…æˆåŠŸæˆ–è€…å¤±è´¥çš„é€šçŸ¥ï¼Œjenkinsæ„å»ºçš„é»˜è®¤é€šçŸ¥ä¿¡æ¯é‡Œä¼šå¸¦æœ‰ä¸€ä¸ªè¿›å…¥ç³»ç»Ÿçš„é“¾æ¥åœ°å€ï¼Œæ–¹ä¾¿ç”¨æˆ·ç›´æ¥ä»é‚®ä»¶/é’‰é’‰ç­‰åœ°æ–¹è¿›å…¥ç³»ç»ŸæŸ¥çœ‹æ„å»ºè¯¦æƒ…ï¼Œè¿™ä¸ªåœ°å€å³æ˜¯æ­¤å¤„é…ç½®çš„å®ä¾‹åœ°å€ æ‰€æœ‰é…ç½®å®Œæˆåï¼ŒæˆåŠŸè¿›å…¥ç³»ç»Ÿ Jenkinsçš„ç¯å¢ƒé…ç½®ç¯å¢ƒéœ€æ±‚åˆ†æ æ‹‰å–è¿œç«¯masteråˆ†æ”¯ä»£ç ï¼šGitæ’ä»¶ è¿è¡Œå‰ç«¯æ‰“åŒ…è„šæœ¬ï¼šNodejsç¯å¢ƒ è¿è¡Œåç«¯æ‰“åŒ…è„šæœ¬ï¼šJavaç¯å¢ƒ+Mavenæ’ä»¶ æ¨é€è£…æœ‰æ„å»ºä»£ç çš„æ–‡ä»¶å¤¹ï¼šSSHæ–‡ä»¶ä¼ è¾“æ’ä»¶ è¿è¡Œè¿œç¨‹å¯åŠ¨è„šæœ¬ï¼šSSHè„šæœ¬è¿è¡Œæ’ä»¶ é…ç½®æ’ä»¶&emsp;&emsp;å¯¹åº”jenkins/ç³»ç»Ÿç®¡ç†/æ’ä»¶ç®¡ç†ç›®å½•ï¼Œæ ¹æ®ä¸Šè¿°çš„æ‰“åŒ…æµç¨‹å¾—å‡ºæ’ä»¶éœ€æ±‚ï¼Œåœ¨baidu/googleæœç´¢å¾—åˆ°jenkinsä¸Šå¯¹åº”çš„æ’ä»¶åç§°ï¼Œé€‰æ‹©å¹¶å®‰è£…å®ƒä»¬ã€‚ æ’ä»¶çš„é€‰æ‹© Publish Over SSHï¼šåŸºäºSSHåè®®çš„æ–‡ä»¶ä¸Šä¼ æ’ä»¶ Nodejsï¼šnodejsè¿è¡Œç¯å¢ƒ Dingdingï¼šé’‰é’‰æ¨é€é€šçŸ¥ Maven Integrationï¼šMavenæ’ä»¶ æ’ä»¶çš„å®‰è£… è¿›å…¥jenkins-ç³»ç»Ÿç®¡ç†-æ’ä»¶ç®¡ç† é€‰æ‹©availableï¼ˆå¯é€‰æ’ä»¶ï¼‰æ ‡ç­¾ æœç´¢å‡ºä»¥ä¸Šé€‰æ‹©çš„æ’ä»¶ï¼Œå‹¾é€‰ä¹‹åç‚¹å‡»ç›´æ¥å®‰è£… é…ç½®å…¨å±€å·¥å…·&emsp;&emsp;å¯¹åº”jenkins/ç³»ç»Ÿç®¡ç†/å…¨å±€å·¥å…·é…ç½®ç›®å½•ï¼Œä¸»è¦æ˜¯é…ç½®æ‰“åŒ…æ‰€éœ€çš„ç¯å¢ƒï¼Œå¦‚Java/Git/Mavenç­‰ç­‰ï¼Œå¦‚æœç³»ç»Ÿè‡ªå¸¦ç¯å¢ƒå¯ä»¥å¡«å†™ç³»ç»Ÿç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥é‡‡ç”¨jenkinsè‡ªåŠ¨å®‰è£…çš„æ–¹å¼ã€‚ JDKé…ç½® tipsï¼šå¦‚æœæ‰¾ä¸åˆ°javaçš„å®‰è£…ç›®å½•å¯ä»¥ä½¿ç”¨ which java æŸ¥çœ‹ Gité…ç½® tipsï¼šå¦‚æœæ‰¾ä¸åˆ°gitçš„å®‰è£…ç›®å½•å¯ä»¥ä½¿ç”¨ which git æŸ¥çœ‹ Mavené…ç½® NodeJSé…ç½® é…ç½®æ–‡ä»¶ç®¡ç†&emsp;&emsp;å¯¹åº”jenkins/ç³»ç»Ÿç®¡ç†/Managed filesç›®å½•ï¼Œä¸»è¦æ˜¯ç®¡ç†è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚Mavençš„settings.xmlï¼ŒNpmçš„npmrc.configæ–‡ä»¶ç­‰ç­‰ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸»è¦é…ç½®ä¸€ä¸‹Mavenå’ŒNpmçš„ä»“åº“é•œåƒï¼Œä½¿å…¶åˆ‡æ¢åˆ°å›½å†…çš„é˜¿é‡Œäº‘çš„Mavené•œåƒå’Œæ·˜å®çš„Npmé•œåƒã€‚ Maven settings.xml &emsp;&emsp;æ–°å¢Maven settings.xmlé…ç½®æ–‡ä»¶ï¼Œåœ¨mirrorsæ ‡ç­¾ä¸‹æ·»åŠ ä»¥ä¸‹é…ç½® &lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; Npm config file &emsp;&emsp;æ–°å¢Npm config fileé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹registryçš„é…ç½® registry=https://registry.npm.taobao.org é…ç½®å…¨å±€å‡­æ®&emsp;&emsp;å¯¹åº”jenkins/å‡­æ®/ç³»ç»Ÿ/å…¨å±€å‡­æ®ç›®å½•ï¼Œä¸»è¦æ˜¯ç”¨äºæ·»åŠ å¦‚gitlab/sshç­‰å—é™è®¿é—®åº”ç”¨çš„ä¿¡ä»»å‡­æ®ã€‚ å…¶ä»–é…ç½® Publish over SSHæ’ä»¶ &emsp;&emsp;è¯¥æ’ä»¶çš„é…ç½®åœ¨jenkins/ç³»ç»Ÿç®¡ç†/ç³»ç»Ÿè®¾ç½®ç›®å½•ï¼Œä¸»è¦çš„é…ç½®å¦‚ä¸‹ï¼š &emsp;&emsp;é«˜çº§é…ç½®ä¸‹è¿˜å¯ä»¥é…ç½®SSHç«¯å£ï¼Œé‡ç½®é»˜è®¤è®¾ç½®ç­‰ç­‰ï¼Œè¿™é‡Œä¸åšè¿‡å¤šè®²è§£ Dingdingé€šçŸ¥ä½¿ç”¨ &emsp;&emsp;é’‰é’‰é€šçŸ¥çš„é…ç½®åœ¨ä»»åŠ¡çš„é…ç½®é¡¹ä¸­ï¼Œé…ç½®èµ·æ¥è¾ƒä¸ºç®€å•ï¼ˆæ¯”å¾®ä¿¡é€šçŸ¥ç®€å•å¤ªå¤šï¼‰åªéœ€è¦ä¸¤æ­¥æ“ä½œã€‚ ï¼ˆ1ï¼‰è·å–é’‰é’‰é€šçŸ¥è‡ªå®šä¹‰æœºå™¨äººwebhookçš„access_tokenï¼Œç‚¹æ­¤è¿›å…¥é’‰é’‰å¼€æ”¾å¹³å°è·å–é…ç½®å¸®åŠ© ï¼ˆ2ï¼‰åœ¨ä»»åŠ¡ä¸­é…ç½®é€šçŸ¥ &emsp;&emsp;é€šçŸ¥æ•ˆæœå¦‚å›¾ï¼Œç‚¹å‡»å³å¯è¿›å…¥jenkinsç®¡ç†å¹³å°æŸ¥çœ‹è¯¦æƒ… Jenkinsçš„ä»»åŠ¡é…ç½®&emsp;&emsp;è‡³æ­¤åŸºäºä¸€ä¸ªå‰åç«¯åˆ†ç¦»é¡¹ç›®çš„è‡ªåŠ¨æ‰“åŒ…é…ç½®å·²ç»åŸºæœ¬å®Œæˆï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨jenkinsæ„å»ºä¸€ä¸ªä»»åŠ¡æ¥æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸï¼Œæœ¬æ¬¡æ„å»ºä»»åŠ¡æ˜¯åŸºäºæˆ‘çš„ä¸€ä¸ªå¼€æºæ¨¡æ¿é¡¹ç›®server-front-separateæ¥è¿›è¡Œã€‚ æ–°å»ºä»»åŠ¡&emsp;&emsp;è¿›å…¥jenkinsæ ¹ç›®å½•ç‚¹å‡»æ–°å»ºä»»åŠ¡ &emsp;&emsp;ä»»åŠ¡æ–°å»ºæˆåŠŸ ä»»åŠ¡åŸºç¡€é…ç½®&emsp;&emsp;æœ¬æ¬¡çš„åŸºç¡€é…ç½®æˆ‘ä»¬éœ€è¦è¾¾åˆ°ä»»åŠ¡èƒ½å¤Ÿè‡ªåŠ¨åŒ–æ‰“åŒ…çš„æ•ˆæœï¼Œä¸ºè¾¾åˆ°æ­¤æ•ˆæœæˆ‘ä»¬è‡³å°‘éœ€è¦é…ç½®ä»¥ä¸‹å‡ é¡¹å†…å®¹ï¼š æºç ç®¡ç† æ„å»ºç¯å¢ƒ åç«¯æ„å»ºæ­¥éª¤ å‰ç«¯æ„å»ºæ­¥éª¤ æºç ç®¡ç† æ„å»ºç¯å¢ƒ åç«¯æ„å»ºæ­¥éª¤ å‰ç«¯æ„å»ºæ­¥éª¤ linuxç¯å¢ƒä¸‹é‡‡ç”¨Shellè„šæœ¬æ„å»ºï¼Œæ¢è¡Œåˆ†å‰²æŒ‡ä»¤ cd front/ node -v npm -v npm i npm run build Windowsç¯å¢ƒä¸‹é‡‡ç”¨æ‰¹å¤„ç†è„šæœ¬æ„å»ºï¼Œä½¿ç”¨&amp;ä¸&amp;&amp;æ¥è¿æ¥æŒ‡ä»¤ï¼Œ&amp;ä»£è¡¨ä¸‹ä¸€æ¡æŒ‡ä»¤å¿…å®šæ‰§è¡Œï¼Œ&amp;&amp;ä»£è¡¨å½“ä¸Šä¸€æ¡æŒ‡ä»¤å‡ºç°é”™è¯¯ä¸‹ä¸€æ¡æŒ‡ä»¤ä¸æ‰§è¡Œ cd front/ &amp; node -v &amp; npm -v &amp; npm i &amp;&amp; npm run build æ„å»ºè¿è¡Œ&emsp;&emsp;åŸºç¡€é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬è¿›å…¥é¡¹ç›®ä¸»é¡µè¿›è¡Œä¸€æ¬¡æ„å»ºæµ‹è¯• &emsp;&emsp;æ„å»ºæˆåŠŸåè¿›å…¥ä»»åŠ¡çš„å·¥ä½œç©ºé—´ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°é¡¹ç›®å·²ç»æ‰“åŒ…æˆåŠŸï¼Œé¡¹ç›®çš„ç›®å½•ç»“æ„æè¿°è¯¦è§æˆ‘çš„å¦ä¸€ç¯‡åšå®¢å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼çš„å®è·µæ€»ç»“ Jenkinsä»»åŠ¡è‡ªåŠ¨åŒ–&emsp;&emsp;è‡³æ­¤é¡¹ç›®å·²ç»èƒ½å¤Ÿé€šè¿‡jenkinså¹³å°æ¥è¿›è¡Œæ‰“åŒ…æ“ä½œäº†ï¼Œä½†æ˜¯è¿™è¿˜è¿œè¿œæ²¡è¾¾åˆ°è‡ªåŠ¨åŒ–çš„æ¦‚å¿µï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€šè¿‡gitä»£ç æäº¤æ“ä½œæ¥è§¦å‘æ„å»ºå¹¶ä¸”è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§/æ¼”ç¤ºæœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¿›è¡Œè‡ªåŠ¨åŒ–çš„é…ç½®å·¥ä½œ è‡ªåŠ¨æ„å»º&emsp;&emsp;è‡ªåŠ¨æ„å»ºæ˜¯æŒ‡é€šè¿‡GitæœåŠ¡å™¨çš„Webhooksæ¥è§¦å‘Jenkinsçš„æ‰“åŒ…æ„å»ºæµç¨‹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†å®ç°ä»¥ä¸‹æµç¨‹ï¼š æ›´æ–°ä»£ç è‡³githubé¡¹ç›®çš„masteråˆ†æ”¯ jenkinså¼€å§‹æ„å»ºä»£ç  &emsp;&emsp;jenkinsé»˜è®¤å¯¹githubçš„webhookæœ‰æ”¯æŒä½¿å¾—è¿™ä¸ªæµç¨‹çš„é…ç½®éå¸¸ç®€å•ï¼Œjenkinsçš„webhookè§¦å‘åœ°å€ä¸º${JENKINS_URL}/github-webhook/ï¼Œå…¶ä¸­JENKINS_URLä¸ºjenkinsæœåŠ¡åœ¨å…¬ç½‘çš„æ ¹ç›®å½•åœ°å€ï¼Œå¯ä»¥åœ¨jenkins/ç³»ç»Ÿç®¡ç†/ç³»ç»Ÿè®¾ç½®å¤„ä¿®æ”¹æ­¤é»˜è®¤åœ°å€ &emsp;&emsp;å¾—åˆ°Webhookåœ°å€åæˆ‘ä»¬åªéœ€è¦åœ¨githubçš„é¡¹ç›®Settingsé€‰é¡¹å¡ä¸Šæ·»åŠ æ­¤åœ°å€å³å¯ï¼Œgithubé»˜è®¤è§¦å‘Webhookçš„é€»è¾‘æ˜¯pushä»£ç æ—¶å³è§¦å‘ &emsp;&emsp;å½“ç„¶ï¼Œåˆ«å¿˜è®°äº†åœ¨jenkinsçš„ä»»åŠ¡ä¸­å‹¾é€‰Github hookè§¦å‘æ„å»º è‡ªåŠ¨éƒ¨ç½²&emsp;&emsp;è‡ªåŠ¨éƒ¨ç½²æ˜¯æŒ‡åœ¨ä»£ç æ„å»ºå®Œæˆåå°†ç”Ÿæˆçš„å‘å¸ƒä»£ç æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸­å¹¶å¯åŠ¨å®ƒä»¬ï¼Œæµç¨‹å¦‚ä¸‹ï¼š ä»£ç æ„å»ºæˆåŠŸåä¸Šä¼ æ‰“åŒ…ç›®å½• è¿è¡Œè¿œç¨‹è„šæœ¬é‡å¯æœåŠ¡ &emsp;&emsp;ä¸Šæ–‡æˆ‘ä»¬è®²åˆ°Publish Over SSHè¿™ä¸ªæ’ä»¶èƒ½å¤Ÿè¿œç¨‹æ¨é€ä»£ç å¹¶è¿è¡Œè„šæœ¬ï¼Œè‡ªåŠ¨éƒ¨ç½²çš„åŠŸèƒ½å³ä¾èµ–æ­¤æ’ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼š # å®šä¹‰è„šæœ¬æ‰§è¡Œåœ°å€ export COMMAND_PATH=/home/app/application/server-front-separate/bin # å°†æ‰€æœ‰è„šæœ¬æ–‡ä»¶è½¬æ¢ä¸ºUNIXæ ¼å¼ sed -i 's/\\r//' $COMMAND_PATH/*.sh # åœæ­¢æœåŠ¡ sh $COMMAND_PATH/stop.sh test # å¯åŠ¨æœåŠ¡ sh $COMMAND_PATH/start.sh test æ„å»ºé€šçŸ¥&emsp;&emsp;åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨é’‰é’‰æ¥åšé€šçŸ¥åŠŸèƒ½ï¼Œé’‰é’‰é€šçŸ¥çš„é…ç½®åœ¨ä¸Šæ–‡å·²ç»ä»‹ç»è¿‡äº†ï¼Œé€šçŸ¥çš„çš„ç±»å‹æœ‰å››ç§ï¼Œæˆ‘ä»¬éœ€è¦å“ªç§ç±»å‹çš„é€šçŸ¥ç›´æ¥å‹¾é€‰å³å¯ï¼Œå››ç§é€šçŸ¥ç±»å‹æ­£å¥½å¯¹åº”jenkinsä»»åŠ¡æ„å»ºçš„ä¸‰ç§çŠ¶æ€ï¼š æˆåŠŸï¼šæ„å»ºæ­¥éª¤ä¸æ„å»ºåçš„æ“ä½œå…¨éƒ¨æˆåŠŸï¼Œå¯¹åº”æ„å»ºæˆåŠŸæ—¶é€šçŸ¥ å¤±è´¥ï¼šæ„å»ºæ­¥éª¤å¤±è´¥ï¼Œå¯¹åº”æ„å»ºå¤±è´¥æ—¶é€šçŸ¥ ä¸ç¨³å®šï¼šæ„å»ºæ­¥éª¤æˆåŠŸä½†æ„å»ºåçš„æ“ä½œå­˜åœ¨å¤±è´¥çš„æƒ…å†µï¼Œå¯¹åº”æ„å»ºä¸­æ–­æ—¶é€šçŸ¥ å¸¸è§é—®é¢˜ä¸­æ–‡ä¹±ç &emsp;&emsp;åœ¨jenkins/ç³»ç»Ÿç®¡ç†/ç³»ç»Ÿè®¾ç½®ä¸­æ·»åŠ å…¨å±€å±æ€§ï¼š å‚è€ƒèµ„æ–™ Jenkinsâ€”â€”åº”ç”¨ç¯‡â€”â€”æ’ä»¶ä½¿ç”¨â€”â€”Publish over SSH Jenkins é›†æˆé’‰é’‰æœºå™¨äºº Jenkinsä¹‹è§£å†³ä¹±ç é—®é¢˜ Jenkinsä¸Githubé›†æˆ webhooké…ç½®","link":"/2019-03-01-devops-practice/"},{"title":"å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼çš„å®è·µæ€»ç»“","text":"SpringBoot+Vuejs+Nginxä»å¼€å‘è‡³éƒ¨ç½²æ„å»ºä¸€ä¸ªæˆç†Ÿçš„å‰åç«¯åˆ†ç¦»åº”ç”¨ å‰è¨€&emsp;&emsp; å®è·µå‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼å·²ç»æœ‰ä¸¤å¹´å·¦å³çš„æ—¶é—´äº†ï¼Œå¯¹äºå‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼çš„æ¦‚å¿µåœ¨è¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šï¼Œæœ¬æ–‡ä¸»è¦æ˜¯æ€»ç»“å¼€å‘æ¨¡å¼å¹¶æ„å»ºä¸€ä¸ªè¾ƒä¸ºæˆç†Ÿçš„å‰åç«¯åˆ†ç¦»åº”ç”¨ æŠ€æœ¯é€‰å‹&emsp;&emsp; å…³äºæŠ€æœ¯é€‰å‹æ–¹é¢çº¿ä¸‹å›½å†…æ¯”è¾ƒæµè¡Œçš„ä¸»è¦æ˜¯SpringBoot+Vuejsè¿™ä¸ªæŠ€æœ¯æ ˆï¼Œæ‰€ä»¥æœ¬æ–‡å°†åŸºäºè¿™ä¸ªæŠ€æœ¯æ ˆæ¥è®²è§£ï¼Œæ¶‰åŠåˆ°çš„æŠ€æœ¯ä¸»è¦æœ‰ ç¯å¢ƒ Java Maven Nodejs Nginx å‰ç«¯ vue-cli åç«¯ SpringBoot ç¯å¢ƒå‡†å¤‡&emsp;&emsp; è¿™é‡Œç®€è¦å¼•ç”¨Windowsä¸‹çš„ç¯å¢ƒæ­å»ºï¼Œå…³äºLinux(Centos7)çš„ç¯å¢ƒæ­å»ºä¼šå†éƒ¨ç½²æ¶æ„ä¸­è®²åˆ° Java : JDKå¼€å‘ç¯å¢ƒæ­å»ºåŠç¯å¢ƒå˜é‡é…ç½® Maven :Mavenå¼€å‘ç¯å¢ƒæ­å»º Nodejs :NodeJSã€NPMå®‰è£…é…ç½®ä¸æµ‹è¯•æ­¥éª¤(windowsç‰ˆæœ¬) Nginx :windowsä¸‹nginxçš„å®‰è£…åŠä½¿ç”¨ æ„å»ºå‰åç«¯åˆ†ç¦»å·¥ç¨‹ç›®å½•è§„åˆ’&emsp;&emsp;æ•´ä½“ç›®å½•ä¸»è¦åˆ†ä¸ºä¸‰å—ï¼Œå¦‚ä¸‹æ‰€ç¤º &emsp;&emsp;æ‰“åŒ…åçš„ç›®å½•ä¸»è¦åˆ†ä¸ºä¸‰å—ï¼Œå¦‚ä¸‹æ‰€ç¤º åç«¯å·¥ç¨‹&emsp;&emsp;åç«¯å·¥ç¨‹ä¸»è¦åŸºäºSpringBootè„šæ‰‹æ¶æ­å»ºï¼ŒSpringBootåŸºç¡€çš„é›†æˆç¯å¢ƒæ­å»ºå¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢SpringBooté›†æˆç¯å¢ƒæ­å»º &emsp;&emsp;é¦–å…ˆåˆ›å»ºä¸€ä¸ªåªæœ‰WebåŠŸèƒ½çš„SpringBooté¡¹ç›®ï¼Œä¿®æ”¹å…¶mavenæ‰“åŒ…çš„é…ç½®å®ç°ä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½ å°†æ‰“åŒ…çš„jaræ–‡ä»¶ç§»åŠ¨è‡³distç›®å½•ä¸‹ å°†å¤šç¯å¢ƒé…ç½®æ–‡ä»¶ä»jarå†…éƒ¨ç§»åŠ¨è‡³å¤–éƒ¨çš„dist/configç›®å½•ä¸‹ &emsp;&emsp;æ­¤é¡¹ä¿®æ”¹ä¸»è¦ä¾èµ–äºä»¥ä¸‹ä¸¤ä¸ªmavenæ’ä»¶ maven-resources-plugin maven-antrun-plugin &emsp;&emsp;è¯¦ç»†çš„æ’ä»¶é…ç½®å¦‚ä¸‹ï¼Œåœ¨server/pom.xmlçš„pluginsæ ‡ç­¾ä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç  &lt;!--å¤åˆ¶é…ç½®æ–‡ä»¶--&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;copy-resources&lt;/id&gt; &lt;phase&gt;validate&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;copy-resources&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;outputDirectory&gt;${project.basedir}/../dist/config&lt;/outputDirectory&gt; &lt;overwrite&gt;true&lt;/overwrite&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*&lt;/include&gt; &lt;/includes&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;!--ç§»åŠ¨å¹¶é‡å‘½åjaråŒ…--&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;run&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;target&gt; &lt;move file=&quot;${project.basedir}/target/${project.artifactId}-${project.version}.${project.packaging}&quot; tofile=&quot;${project.basedir}/../dist/${project.artifactId}-${project.version}.${project.packaging}&quot;/&gt; &lt;/target&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &emsp;&emsp;è¿›å…¥åˆ°server/pom.xmlåŒçº§ç›®å½•ï¼Œæ‰§è¡Œmvn clean packageæŒ‡ä»¤ï¼Œæ‰“åŒ…æˆåŠŸä¼šåœ¨distç›®å½•ä¸‹ç”Ÿæˆç¼–è¯‘åçš„jaræ–‡ä»¶ï¼Œdist/configç›®å½•ä¸‹ç”Ÿæˆé¡¹ç›®çš„é…ç½®æ–‡ä»¶ å‰ç«¯å·¥ç¨‹&emsp;&emsp;å‰ç«¯å·¥ç¨‹ä¸»è¦åŸºäºvue-cliè„šæ‰‹æ¶åˆ›å»ºï¼Œvueé¡¹ç›®çš„ç¯å¢ƒæ­å»ºå¯ä»¥å‚ç…§vue-ç”¨Vue-cliä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªVueé¡¹ç›®&emsp;&emsp;ç°åœ¨åˆ›å»ºä¸€ä¸ªåŸºç¡€çš„vueé¡¹ç›®ï¼Œä¿®æ”¹config/index.jsé…ç½®ä»¥å®ç°æ‰“åŒ…çš„é™æ€èµ„æºç”Ÿæˆè‡³dist/htmlç›®å½• &emsp;&emsp;è¿›å…¥åˆ°front/package.jsonåŒçº§ç›®å½•ï¼Œæ‰§è¡Œnpm run buildæŒ‡ä»¤ï¼Œæ‰“åŒ…æˆåŠŸä¼šåœ¨dist/htmlç›®å½•ç”Ÿæˆé™æ€æ–‡ä»¶ é›†æˆæµ‹è¯•æ¥ä¸ªæ¥å£&emsp;&emsp;ç¼–å†™ä¸€ä¸ªè·å–ç”¨æˆ·ä¿¡æ¯çš„æ¥å£ @SpringBootApplication @Controller public class ServerApplication { public static void main(String[] args) { SpringApplication.run(ServerApplication.class, args); } /** * è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ * * @return å½“å‰ç™»å½•ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ */ @RequestMapping(&quot;/user/me&quot;) @ResponseBody public Map&lt;String, Object&gt; me() { Map&lt;String, Object&gt; result = new HashMap&lt;&gt;(); result.put(&quot;username&quot;, &quot;admin&quot;); result.put(&quot;roles&quot;, Arrays.asList(&quot;admin&quot;, &quot;normal&quot;, &quot;none&quot;)); result.put(&quot;depts&quot;, Arrays.asList(&quot;åŠå…¬å®¤&quot;, &quot;ç»„ç»‡éƒ¨&quot;)); result.put(&quot;menus&quot;, Arrays.asList(&quot;å·¥ä½œå°&quot;, &quot;ç³»ç»Ÿç®¡ç†&quot;)); return result; } } é…ç½®ä»£ç†&emsp;&emsp;é…ç½®ä»¥ä¸‹å‰ç«¯å·¥ç¨‹çš„ä»£ç†è½¬å‘ï¼Œç”¨äºè§£å†³å¼€å‘ç¯å¢ƒæ¥å£è°ƒè¯•çš„è·¨åŸŸé—®é¢˜ å†™ä¸ªé¡µé¢&emsp;&emsp;å†™ä¸ªå‰ç«¯é¡µé¢æµ‹è¯•åç«¯æ¥å£ï¼Œè¿›å…¥front/package.jsonåŒçº§ç›®å½•æ‰§è¡Œnpm i axios -sï¼Œä¿®æ”¹HelloWord.vueç»„ä»¶ä¸ºå¦‚ä¸‹ä»£ç  &lt;template&gt; &lt;div class=&quot;hello&quot;&gt; &lt;h1 v-if=&quot;loading&quot;&gt;{{ 'æ­£åœ¨åŠ è½½ç”¨æˆ·ä¿¡æ¯' }}&lt;/h1&gt; &lt;h1 v-else-if=&quot;errMsg&quot;&gt;{{ errMsg }}&lt;/h1&gt; &lt;div v-else&gt; &lt;p&gt;username: {{userInfo.username}}&lt;/p&gt; &lt;p&gt;roles: {{userInfo.roles}}&lt;/p&gt; &lt;p&gt;depts: {{userInfo.depts}}&lt;/p&gt; &lt;p&gt;menus: {{userInfo.menus}}&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import axios from 'axios' export default { name: 'HelloWorld', data () { return { loading: false, userInfo: { username: '', roles: [], depts: [], menus: [] }, errMsg: null } }, created () { this.loading = true axios.get('/api/user/me').then(response =&gt; { this.userInfo = response.data }).catch(err =&gt; { console.error(err) this.errMsg = err }).finally(() =&gt; { this.loading = false }) } } &lt;/script&gt; &lt;!-- Add &quot;scoped&quot; attribute to limit CSS to this component only --&gt; &lt;style scoped&gt; h1, h2 { font-weight: normal; } &lt;/style&gt; è¿›å…¥æµ‹è¯•é“¾æ¥http://localost:8081 å•ç‚¹éƒ¨ç½²nginxé…ç½®&emsp;&emsp;åˆ†ç¦»éƒ¨ç½²ä¸»è¦ä¾èµ–äºnginxæ¥å®Œæˆï¼Œåˆ©ç”¨nginxæ¥åˆ†å‘å‰åç«¯çš„å†…å®¹ï¼Œnginxçš„é…ç½®å¦‚ä¸‹ #user root;# linuxä¸‹å¿…é¡»æœ‰æ­¤é…ç½® ä¸ç„¶ä¼šå¯¼è‡´403æƒé™ä¸è¶³ worker_processes 1; #error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; #pid logs/nginx.pid; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; log_format main '$remote_addr - $remote_user [$time_local] &quot;$request&quot; ' '$status $body_bytes_sent &quot;$http_referer&quot; ' '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'; access_log logs/access.log main; error_log logs/error.log error; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; server { listen 80; server_name localhost; set $application_path C:/workspace/java/server-front-separate;# è¿™é‡Œçš„çˆ¶çº§è·¯å¾„éœ€è¦æ ¹æ®é¡¹ç›®è·¯å¾„è®¾ç½® location /api { proxy_pass http://localhost:8080/; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location / { alias $application_path/dist/html/; try_files $uri $uri/ /index.html last;# è§£å†³é¡µé¢åˆ·æ–°404é—®é¢˜ index index.html index.htm; } } } æ‰“åŒ…å‰åç«¯åº”ç”¨ å‰ç«¯åº”ç”¨: è¿›å…¥front/package.jsonåŒçº§ç›®å½•ï¼Œæ‰§è¡Œnpm run buildæŒ‡ä»¤ åç«¯åº”ç”¨: è¿›å…¥server/pom.xmlåŒçº§ç›®å½•ï¼Œæ‰§è¡Œmvn clean packageæŒ‡ä»¤ ç¼–å†™å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆæ”¯æŒå¤šç¯å¢ƒï¼‰ linuxä¸‹å¯åŠ¨è„šæœ¬start.sh #!/bin/sh # å¸¸é‡å®šä¹‰ export BIN_PATH=$(cd `dirname $0`;pwd) echo BIN_PATH:[$BIN_PATH] cd $BIN_PATH cd .. export CONTEXT_PATH=`pwd` echo CONTEXT_PATH:[$CONTEXT_PATH] export LOG_PATH=/data/logs/sso echo LOG_PATH:[$LOG_PATH] # éœ€è¦æŒ‡å®šå¯åŠ¨çš„æ¨¡å¼æ˜¯testï¼Œè¿˜æ˜¯prodï¼Œé»˜è®¤æ˜¯testï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ ACTION_MODE=$1 if [ &quot;$ACTION_MODE&quot; = &quot;&quot; ] then ACTION_MODE=test fi echo STARTING APPLICATION ACTION_MODE:[$ACTION_MODE] # åˆ¤æ–­logæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ ä¸å­˜åœ¨åˆ™åˆ›å»º if [ ! -d $LOG_PATH ]; then mkdir $LOG_PATH fi # åˆ é™¤å†å²çš„server.logæ–‡ä»¶ rm -f $LOG_PATH/server.log # åå°å¯åŠ¨åº”ç”¨ å¹¶è¾“å‡ºæ§åˆ¶å°æ—¥å¿— nohup java -jar server-0.0.1-SNAPSHOT.jar --spring.profiles.active=$ACTION_MODE &gt;&gt; $LOG_PATH/server.log 2&gt;&amp;1 &amp; # æ˜¾ç¤ºè¾“å‡ºå‰äºŒåè¡Œçš„æ—¥å¿— head -n 20 $LOG_PATH/server.log windowsä¸‹å¯åŠ¨è„šæœ¬start.bat @echo off :: è®¾ç½®jaråç§° set JAR_NAME=server-0.0.1-SNAPSHOT :: å¸¸é‡å®šä¹‰ set BIN_PATH=%~dp0 echo BIN_PATH:[%BIN_PATH%] cd %BIN_PATH% cd .. set CONTEXT_PATH=%cd% echo CONTEXT_PATH:[%CONTEXT_PATH%] echo JAR_NAME:[%JAR_NAME%] :: éœ€è¦æŒ‡å®šå¯åŠ¨çš„æ¨¡å¼æ˜¯testï¼Œè¿˜æ˜¯prodï¼Œé»˜è®¤æ˜¯testï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ set /p ACTION_MODE_INPUT=è¯·è¾“å…¥å¯åŠ¨ç¯å¢ƒï¼Œä¸è¾“å…¥é‡‡ç”¨é»˜è®¤ç¯å¢ƒ[test]: if not &quot;%ACTION_MODE_INPUT%&quot; equ &quot;&quot; (set ACTION_MODE=%ACTION_MODE_INPUT%) else (set ACTION_MODE=test) echo STARTING APPLICATION ACTION_MODE:%ACTION_MODE% set PROCESS_NAME=JAVA_APP_%JAR_NAME%_%ACTION_MODE% title %PROCESS_NAME% echo PROCESS_NAME:[%PROCESS_NAME%] :: åå°å¯åŠ¨åº”ç”¨ å¹¶è¾“å‡ºæ§åˆ¶å°æ—¥å¿— java -jar %JAR_NAME%.jar --spring.profiles.active=%ACTION_MODE% linuxä¸‹å…³é—­è„šæœ¬stop.sh #!/bin/sh # éœ€è¦æŒ‡å®šåœæ­¢çš„æ¨¡å¼æ˜¯testï¼Œè¿˜æ˜¯prodï¼Œé»˜è®¤æ˜¯testï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯é»˜è®¤å–test ACTION_MODE=$1 if [ &quot;$ACTION_MODE&quot; = &quot;&quot; ] then ACTION_MODE=test fi echo STOPPING APPLICATION ACTION_MODE:[$ACTION_MODE] pid=`ps -ef | grep server-0.0.1-SNAPSHOT.jar | grep $ACTION_MODE | grep -v grep | awk '{print $2}'` # åˆ¤æ–­è¿›ç¨‹æ˜¯å¦å†è¿è¡Œ åœ¨è¿è¡Œåˆ™ç»ˆæ­¢ if [ -n &quot;$pid&quot; ] then kill -9 $pid echo application stop success else echo application already stop fi windowsä¸‹å…³é—­è„šæœ¬stop.bat @echo off :: è®¾ç½®jaråç§° set JAR_NAME=server-0.0.1-SNAPSHOT :: éœ€è¦æŒ‡å®šç»ˆæ­¢çš„æ¨¡å¼æ˜¯testï¼Œè¿˜æ˜¯prodï¼Œé»˜è®¤æ˜¯testï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ set /p ACTION_MODE_INPUT=è¯·è¾“å…¥å…³é—­åº”ç”¨çš„è¿è¡Œç¯å¢ƒï¼Œä¸è¾“å…¥é‡‡ç”¨é»˜è®¤ç¯å¢ƒ[test]: if not &quot;%ACTION_MODE_INPUT%&quot; equ &quot;&quot; (set ACTION_MODE=%ACTION_MODE_INPUT%) else (set ACTION_MODE=test) echo STARTING APPLICATION ACTION_MODE:%ACTION_MODE% echo JAR_NAME:[%JAR_NAME%] set PROCESS_NAME=JAVA_APP_%JAR_NAME%_%ACTION_MODE% echo PROCESS_NAME:[%PROCESS_NAME%] :: æ€æ­»å¯¹åº”è¿›ç¨‹ tasklist /nh /fi &quot;WINDOWTITLE eq %PROCESS_NAME%&quot;|find /i &quot;cmd.exe&quot; &gt;nul if ERRORLEVEL 1 (echo Application already stop) else (taskkill /fi &quot;WINDOWTITLE eq %PROCESS_NAME%&quot; &gt;nul &amp; echo Application stop success) echo This window will close in 10 seconds ping 127.1 -n 11 &gt;nul å¯åŠ¨nginxä»¥åŠåç«¯æœåŠ¡ windwos è¿è¡Œnginx.exe è¿è¡Œdist/bin/start.bat linux nginx -s start dist/bin/start.sh prod æºç è·å–https://github.com/calebman/server-front-separate","link":"/2019-02-23-server-front-separate/"},{"title":"Hello Hexo","text":"ä»æ˜é‡‘åˆ°Hexoï¼Œä»æœªåœæ­¢ ä»æ˜é‡‘åˆ‡æ¢åˆ°Hexoï¼Œå¤šè¯»å¤šçœ‹å¤šç§¯ç´¯ï¼Œå´­æ–°çš„å¼€å§‹ éšæ‰‹è®°ä¸€ä¸‹Markdownçš„ç›¸å…³è¯­æ³• å¸Œæœ›ä»¥åèƒ½å¤Ÿå…»æˆéšæ‰‹è®°çš„ä¹ æƒ¯ æ¯•ç«Ÿ å¥½è®°æ€§ ä¸å¦‚ çƒ‚ç¬”å¤´ æ ‡é¢˜# å†…å®¹ ï¼ˆä¸€çº§æ ‡é¢˜ï¼‰ ## å†…å®¹ ï¼ˆäºŒçº§æ ‡é¢˜ï¼‰ ### å†…å®¹ ï¼ˆä¸‰çº§æ ‡é¢˜ï¼‰ #### å†…å®¹ ï¼ˆå››çº§æ ‡é¢˜ï¼‰ ##### å†…å®¹ ï¼ˆäº”çº§æ ‡é¢˜ï¼‰ ###### å†…å®¹ ï¼ˆå…­çº§æ ‡é¢˜ï¼‰æ•ˆæœå¦‚ä¸‹ å†…å®¹-ï¼ˆä¸€çº§æ ‡é¢˜ï¼‰å†…å®¹-ï¼ˆäºŒçº§æ ‡é¢˜ï¼‰å†…å®¹-ï¼ˆä¸‰çº§æ ‡é¢˜ï¼‰å†…å®¹-ï¼ˆå››çº§æ ‡é¢˜ï¼‰å†…å®¹-ï¼ˆäº”çº§æ ‡é¢˜ï¼‰å†…å®¹-ï¼ˆå…­çº§æ ‡é¢˜ï¼‰åˆ—è¡¨+ å¥ˆæ–‡æ‘©å°” + ä¸Šå¤å·¨ç¥ * ææ€–åˆ©åˆƒ * æ··æ²Œéª‘å£« - ç‚¼é‡‘æœ¯å£« - ç—›è‹¦å¥³ç‹ 1. ä»£è¾¾ç½—æ–¯ä¹‹æ®‡ 2. é˜¿æ‰˜æ–¯ä¹‹æ£ 3. æ¢…è‚¯æ–¯å§† * Steam * Dota2 * ç»åœ°æ±‚ç”Ÿ * ä¸­å›½å¼å®¶é•¿ æ•ˆæœå¦‚ä¸‹ å¥ˆæ–‡æ‘©å°” ä¸Šå¤å·¨ç¥ ææ€–åˆ©åˆƒ æ··æ²Œéª‘å£« ç‚¼é‡‘æœ¯å£« ç—›è‹¦å¥³ç‹ ä»£è¾¾ç½—æ–¯ä¹‹æ®‡ é˜¿æ‰˜æ–¯ä¹‹æ£ æ¢…è‚¯æ–¯å§† Steam Dota2 ç»åœ°æ±‚ç”Ÿ ä¸­å›½å¼å®¶é•¿ å­—ä½“**åŠ ç²—çš„æ–‡å­—** *å€¾æ–œçš„æ–‡å­—*` ***æ–œä½“åŠ ç²—çš„æ–‡å­—*** ~~åŠ åˆ é™¤çº¿çš„æ–‡å­—~~æ•ˆæœå¦‚ä¸‹ åŠ ç²—çš„æ–‡å­—å€¾æ–œçš„æ–‡å­—`æ–œä½“åŠ ç²—çš„æ–‡å­—åŠ åˆ é™¤çº¿çš„æ–‡å­— å¼•ç”¨&gt;å¼•ç”¨å†…å®¹ &gt;&gt;æ•ˆæœå¦‚ä¸‹ &gt;&gt;&gt;&gt;&gt;&gt;å¯å åŠ çš„å¼•ç”¨æ•ˆæœå¦‚ä¸‹ å¼•ç”¨å†…å®¹ æ•ˆæœå¦‚ä¸‹ å¯å åŠ çš„å¼•ç”¨ é“¾æ¥[github](https://github.com/calebman) [æ˜é‡‘](https://juejin.im/user/59bc7c00f265da0644289a4b)æ•ˆæœå¦‚ä¸‹ githubæ˜é‡‘ åˆ†å‰²çº¿--- ---- *** *****æ•ˆæœå¦‚ä¸‹ å›¾ç‰‡![å›¾ç‰‡ä»‹ç»](https://chenjianhui.site/images/avatar.png)æ•ˆæœå¦‚ä¸‹ è¡¨æ ¼è‹±é›„|å±æ€§|å¤§æ‹› --|:--:|--: å¥ˆæ–‡æ‘©å°”|æ•æ·|é­‚ä¹‹æŒ½æ­Œ å—æŠ˜ç£¨çš„çµé­‚|æ™ºåŠ›|ç…¤æ°”ç½ æ··æ²Œéª‘å£«|åŠ›é‡|æ··æ²Œé•œåƒæ•ˆæœå¦‚ä¸‹ è‹±é›„ å±æ€§ å¤§æ‹› å¥ˆæ–‡æ‘©å°” æ•æ· é­‚ä¹‹æŒ½æ­Œ å—æŠ˜ç£¨çš„çµé­‚ æ™ºåŠ› ç…¤æ°”ç½ æ··æ²Œéª‘å£« åŠ›é‡ æ··æ²Œé•œåƒ ä»£ç å—(```) public static void main(String args[]) { System.out.println(&quot;Hello World&quot;); } (```)æ•ˆæœå¦‚ä¸‹ public static void main(String args[]) { System.out.println(&quot;Hello World&quot;); } ä»»åŠ¡åˆ—è¡¨ feature one feature two feature three feature four feature five feature six","link":"/2019-02-21-hello-hexo/"},{"title":"ä½¿ç”¨Nettyæ„å»ºHttpå®¹å™¨","text":"ä½¿ç”¨Nettyæ„å»ºä¸€ä¸ªSpringBooté£æ ¼çš„Webæ¡†æ¶ è¦å®ç°æ€æ ·çš„æ•ˆæœ ä¸€ä¸ªSpringBootæ¡†æ¶æ­å»ºèµ·æ¥çš„é¡¹ç›®å‘å¸ƒæ¥å£æœåŠ¡æ˜¯è¿™æ ·çš„ SpringBootæ­å»ºæ•™ç¨‹ç‚¹å‡»è¿™é‡Œ @Controller @RequestMapping(&quot;/v1/product&quot;) public class DocController { @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.GET) @ResponseBody public WebResult search(@PathVariable(&quot;id&quot;) Integer id) { logger.debug(&quot;è·å–æŒ‡å®šäº§å“æ¥æ”¶äº§å“id=&gt;%d&quot;, id); if (id == null || &quot;&quot;.equals(id)) { logger.debug(&quot;äº§å“idä¸èƒ½ä¸ºç©º&quot;); return WebResult.error(ERRORDetail.RC_0101001); } return WebResult.success(products.get(id)); } } æˆ‘å¸Œæœ›æˆ‘ä½¿ç”¨Nettyæ„å»ºçš„WebæœåŠ¡å™¨ä¹Ÿèƒ½ä½¿ç”¨è¿™æ ·ä¾¿æ·çš„æ³¨è§£æ–¹å¼å»å‘å¸ƒæˆ‘çš„æ¥å£æœåŠ¡ è¯¥æ€ä¹ˆåš ä½¿ç”¨Nettyè‡ªå¸¦çš„ç¼–è§£ç ã€èšåˆå™¨æ„å»ºä¸€ä¸ªå¸¦æœ‰Httpç¼–è§£ç åŠŸèƒ½çš„æœåŠ¡å™¨è¿™ä¸€ç‚¹å…¶å®éå¸¸ç®€å•ï¼ŒNettyæä¾›äº†å¯¹åº”çš„Httpåè®®çš„ç¼–è§£ç ä»¥åŠèšåˆå™¨ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç®¡é“åˆå§‹åŒ–çš„æ—¶å€™åŠ è½½å®ƒä»¬ã€‚ public class HttpPipelineInitializer extends ChannelInitializer&lt;Channel&gt; { //ç¼–è§£ç å¤„ç†å™¨åç§° public final static String CODEC = &quot;codec&quot;; //HTTPæ¶ˆæ¯èšåˆå¤„ç†å™¨åç§° public final static String AGGEGATOR = &quot;aggegator&quot;; //HTTPæ¶ˆæ¯å‹ç¼©å¤„ç†å™¨åç§° public final static String COMPRESSOR = &quot;compressor&quot;; @Override protected void initChannel(Channel channel) throws Exception { ChannelPipeline pipeline = channel.pipeline(); pipeline.addLast(CODEC, new HttpServerCodec()); pipeline.addLast(AGGEGATOR, new HttpObjectAggregator(512 * 1024)); pipeline.addLast(COMPRESSOR,new HttpContentCompressor()); pipeline.addLast(new AllocHandler()); } } å®ç°RequestMappingæ³¨è§£ï¼Œç”¨äºæ ‡è¯†å¤„ç†å™¨æˆ–è€…æ§åˆ¶å™¨å¯¹åº”åŒ¹é…çš„æ¥å£åœ°å€ã€‚ @Target({ElementType.TYPE, ElementType.METHOD}) @Retention(RetentionPolicy.RUNTIME) public @interface RequestMapping { String[] value() default {}; } æä¾›å¯åŠ¨å…¥å£ï¼Œç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºSpringå®¹å™¨ï¼Œå¹¶åŸºäºSpringåˆå§‹åŒ–å¿…è¦ç»„ä»¶ æä¾›ç¨‹åºå…¥å£ç±» public class CettyBootstrap { private static final Logger logger = LoggerFactory.getLogger(CettyBootstrap.class); private static final String DEFAULT_SPRING_XMLPATH = &quot;classpath:applicantContext.xml&quot;; private static final String DEFAULT_HTTP_SERVER_BEAN_NAME = &quot;defaultHttpServer&quot;; public static void create() { create(DEFAULT_SPRING_XMLPATH); } public static void create(String springXmlpath) { if (StringUtils.isEmpty(springXmlpath)) { springXmlpath = DEFAULT_SPRING_XMLPATH; } logger.debug(&quot;springæ¡†æ¶é…ç½®æ–‡ä»¶åœ°å€ä¸º{}&quot;, springXmlpath); try { ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(springXmlpath.split(&quot;[,\\\\s]+&quot;)); context.start(); logger.debug(&quot;springæ¡†æ¶å¯åŠ¨æˆåŠŸ&quot;); try { context.getBean(DEFAULT_HTTP_SERVER_BEAN_NAME, DefaultHttpServer.class); } catch (NoSuchBeanDefinitionException ex) { logger.warn(&quot;æœªé…ç½®HttpServerï¼Œé‡‡ç”¨é»˜è®¤é…ç½®å¯åŠ¨&quot;); context.getAutowireCapableBeanFactory().createBean(DefaultHttpServer.class); } } catch (BeansException e) { e.printStackTrace(); } } } å®šä¹‰é»˜è®¤å®ç°çš„HttpServerç»„ä»¶ï¼ŒéšSpringå®¹å™¨å¯åŠ¨æ—¶åŠ è½½åŸºäºNettyçš„Webå®¹å™¨ï¼Œå¹¶ä½¿ç”¨HandlerMappingç»„ä»¶åˆå§‹åŒ–HttpPipelineInitializerç®¡é“ï¼Œå…¶ä¸­HandlerMappingå¦‚æœæœªæœ‰ç”¨æˆ·å®šä¹‰åˆ™ä½¿ç”¨é»˜è®¤çš„DefaultHandlerMappingå®ç° public class DefaultHttpServer extends ApplicationObjectSupport { private static final Logger logger = LoggerFactory.getLogger(DefaultHttpServer.class); private static final String DEFAULT_HTTP_PORT = &quot;8080&quot;; private static final String HANDLER_MAPPING_BEAN_NAME = &quot;handlerMapping&quot;; private String port; private HandlerMapping handlerMapping; public void setPort(String port) { this.port = port; } @Override public void initApplicationContext(ApplicationContext applicationContext) { beforeInit(applicationContext); initHandlerMapping(applicationContext); initServer(); } void initHandlerMapping(ApplicationContext context) { try { this.handlerMapping = context.getBean(HANDLER_MAPPING_BEAN_NAME, HandlerMapping.class); } catch (NoSuchBeanDefinitionException ex) { this.handlerMapping = context.getAutowireCapableBeanFactory().createBean(DefaultHandlerMapping.class); } } void initServer() { logger.debug(&quot;åˆå§‹åŒ–æœåŠ¡å™¨&quot;); if (!HttpUtils.isPort(port)) { logger.warn(&quot;ç«¯å£å·ä¸åˆæ³•ï¼Œä½¿ç”¨é»˜è®¤ç«¯å£{}&quot;, DEFAULT_HTTP_PORT); port = DEFAULT_HTTP_PORT; } EventLoopGroup bossGroup = new NioEventLoopGroup(); EventLoopGroup workerGroup = new NioEventLoopGroup(); try { ServerBootstrap b = new ServerBootstrap(); b.group(bossGroup, workerGroup) .channel(NioServerSocketChannel.class) .localAddress(new InetSocketAddress(Integer.parseInt(port))) .childHandler(new HttpPipelineInitializer(handlerMapping)); ChannelFuture f = b.bind().sync(); logger.info(&quot;æœåŠ¡å¯åŠ¨æˆåŠŸï¼Œç›‘å¬{}ç«¯å£&quot;, port); f.channel().closeFuture().sync(); } catch (InterruptedException e) { e.printStackTrace(); } finally { try { workerGroup.shutdownGracefully().sync(); bossGroup.shutdownGracefully().sync(); } catch (InterruptedException e) { e.printStackTrace(); } } } protected void beforeInit(ApplicationContext applicationContext) { } } æä¾›é»˜è®¤çš„HandlerMappingå®ç°ç±»ï¼Œè´Ÿè´£åŒ¹é…@RequestMappingæ³¨è§£ä¸‹çš„å¤„ç†å‡½æ•° public class DefaultHandlerMapping extends ApplicationObjectSupport implements HandlerMapping { Logger logger = LoggerFactory.getLogger(DefaultHandlerMapping.class); private static Map&lt;String, HttpHandler&gt; httpHandlerMap = new HashMap&lt;String, HttpHandler&gt;(); @Override public void initApplicationContext(ApplicationContext context) throws BeansException { logger.debug(&quot;åˆå§‹åŒ–å¤„ç†åŒ¹é…å™¨&quot;); Map&lt;String, Object&gt; handles = context.getBeansWithAnnotation(Controller.class); try { for (Map.Entry&lt;String, Object&gt; entry : handles.entrySet()) { logger.debug(&quot;åŠ è½½æ§åˆ¶å™¨{}&quot;, entry.getKey()); loadHttpHandler(entry.getValue()); } } catch (IllegalAccessException e) { e.printStackTrace(); } catch (InstantiationException e) { e.printStackTrace(); } } void loadHttpHandler(Object value) throws IllegalAccessException, InstantiationException { Class clazz = value.getClass(); Object clazzFromInstance = clazz.newInstance(); Method[] method = clazz.getDeclaredMethods(); for (Method m : method) { if (m.isAnnotationPresent(RequestMapping.class)) { RequestMapping requestMapping = m.getAnnotation(RequestMapping.class); for (String url : requestMapping.value()) { HttpHandler httpHandler = httpHandlerMap.get(url); if (httpHandler == null) { logger.info(&quot;åŠ è½½urlä¸º{}çš„å¤„ç†å™¨{}&quot;, url, m.getName()); httpHandlerMap.put(url, new HttpHandler(clazzFromInstance, m)); } else { logger.warn(&quot;url{}å­˜åœ¨ç›¸åŒçš„å¤„ç†å™¨&quot;, url); } } } } } @Override public HttpHandler getHadnler(FullHttpRequest request) { return httpHandlerMap.get(request.uri()); } } å½“è¯·æ±‚è¿›å…¥æ—¶é€šè¿‡HandlerMappingç»„ä»¶åŒ¹é…å¤„ç†å™¨ï¼Œå¦‚æœåŒ¹é…å¤±è´¥åˆ™è¿”å›404 public class AllocHandler extends SimpleChannelInboundHandler&lt;FullHttpRequest&gt; { private HandlerMapping handlerMapping; public AllocHandler(HandlerMapping handlerMapping) { this.handlerMapping = handlerMapping; } /* å¼‚å¸¸å¤„ç† */ @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception { sendError(ctx, HttpResponseStatus.INTERNAL_SERVER_ERROR); super.exceptionCaught(ctx, cause); } @Override protected void channelRead0(ChannelHandlerContext ctx, FullHttpRequest fullHttpRequest) throws Exception { HttpHandler httpHandler = handlerMapping.getHadnler(fullHttpRequest); if (httpHandler != null) { Object obj = httpHandler.execute(fullHttpRequest); if (obj instanceof String) { sendMessage(ctx, obj.toString()); } else { sendMessage(ctx, JSONObject.toJSONString(obj)); } } else { sendError(ctx, HttpResponseStatus.NOT_FOUND); } } private void sendMessage(ChannelHandlerContext ctx, String msg) { FullHttpResponse response = new DefaultFullHttpResponse(HttpVersion.HTTP_1_1, HttpResponseStatus.OK, Unpooled.copiedBuffer(msg, CharsetUtil.UTF_8)); response.headers().set(&quot;Content-Type&quot;, &quot;text/plain&quot;); ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE); } private void sendError(ChannelHandlerContext ctx, HttpResponseStatus httpResponseStatus) { FullHttpResponse response = new DefaultFullHttpResponse(HttpVersion.HTTP_1_1, httpResponseStatus, Unpooled.copiedBuffer(httpResponseStatus.toString(), CharsetUtil.UTF_8)); response.headers().set(&quot;Content-Type&quot;, &quot;text/plain&quot;); ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE); } } æµ‹è¯•ä¸ä½¿ç”¨ å»ºç«‹ä¸€ä¸ªTestController @Controller public class TestController { @RequestMapping(&quot;/test&quot;) public String testHandler(FullHttpRequest fullHttpRequest) { return &quot;1234&quot;; } @RequestMapping(&quot;/zx&quot;) public String zx(FullHttpRequest fullHttpRequest) { return &quot;zhuxiong&quot;; } @RequestMapping(&quot;/obj&quot;) public Object obj(FullHttpRequest fullHttpRequest) { System.out.println(&quot;\\n\\n----------&quot;); HttpHeaders httpHeaders = fullHttpRequest.headers(); Set&lt;String&gt; names = httpHeaders.names(); for (String name : names) { System.out.println(name + &quot; : &quot; + httpHeaders.get(name)); } System.out.println(&quot;&quot;); ByteBuf byteBuf = fullHttpRequest.content(); byte[] byteArray = new byte[byteBuf.capacity()]; byteBuf.readBytes(byteArray); System.out.println(new String(byteArray)); System.out.println(&quot;----------\\n\\n&quot;); JSONObject json = new JSONObject(); json.put(&quot;errCode&quot;, &quot;00&quot;); json.put(&quot;errMsg&quot;, &quot;0000000(æˆåŠŸ)&quot;); json.put(&quot;data&quot;, null); return json; } } å¯åŠ¨Springå®¹å™¨ public class HttpServerTest { public static void main(String[] args) throws Exception { CettyBootstrap.create(); // CettyBootstrap.create(&quot;classpath:applicationContext.xml&quot;); } } æœªæ¥è¦åšçš„ ä¸Springæ¡†æ¶é›†æˆï¼Œå°†æ ¸å¿ƒç»„ä»¶æ‰˜ç®¡ç»™Springå®¹å™¨ç»Ÿä¸€ç®¡ç† æä¾›é™æ€èµ„æºæ˜ å°„ ä¿®æ”¹æ˜ å°„ç­–ç•¥å°†è¯·æ±‚æ˜ å°„è‡³ä¸€ä¸ªæµç¨‹ï¼ˆä¸€ä¸ªå¤„ç†å™¨å¤šä¸ªæ‹¦æˆªå™¨ï¼‰ æ”¯æŒä½¿ç”¨æ¨¡æ¿è¯­æ³•è¿›è¡Œè§†å›¾è§£æ","link":"/2018-05-23-build-http-server-with-netty/"},{"title":"çº¯æ­£åç«¯çš„vueè½®å­ç¬”è®°","text":"å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œå¤šé€ è½®å­å¤šåšç¬”è®° è¯´æ˜ç”±äºå…¬å¸éœ€è¦ï¼Œæˆ‘ä½œä¸ºä¸€ä¸ªçº¯æ­£çš„åç«¯å·¥ç¨‹å¸ˆï¼Œå·²ç»è‡ªå­¦äº†åŠå¹´å¤šçš„vueäº†ï¼Œæ„£æ˜¯è¢«é€¼æˆäº†ä¸€ä¸ªå°å…¨æ ˆï¼Œå½“ç„¶ï¼Œå°å…¨æ ˆè¿™æ˜¯å¾€å¥½å¬äº†è¯´ï¼Œäº‹å®ä¸Šå°±æ˜¯ä¸ªå‰åç«¯æ·±åº¦éƒ½ä¸è¶³çš„å°èœé¸¡ï¼Œåœ¨æ·±çŸ¥è‡ªå·±ä¼—å¤šä¸è¶³ä»¥åŠæ˜ç™½å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´çš„é“ç†ä¸‹ï¼Œå¤šé€ è½®å­å¤šåšç¬”è®°æ€»æ˜¯ä¸ä¼šé”™çš„ï¼šï¼‰ æ‰€ä»¥æœ€è¿‘å¾—ç©ºæˆ‘æŠŠæˆ‘åˆšå­¦vuejsçš„æ—¶å€™å†™çš„çƒ‚å·¥ç¨‹é‡æ„äº†ä¸€ä¸‹ï¼Œé‡æ„çš„æ—¶å€™é’ˆå¯¹æ€§çš„åˆ†æ¨¡å—åšäº†ä¸€äº›ç¬”è®°å¦‚ä¸‹ è·¯ç”± çŠ¶æ€ç®¡ç† æƒé™ç®¡ç† æ§ä»¶å°è£…ä¸ä½¿ç”¨ æ··å…¥ æ•°æ®æ¨¡æ‹Ÿ æ‰“åŒ…ä¼˜åŒ–ä¸ç”¨æˆ·ä½“éªŒ å¦‚æœä¸æƒ³æ‹‰è¿™ä¹ˆé•¿å¯ä»¥å» å…¨çƒæœ€å¤§çš„åŒæ€§äº¤å‹ç½‘ç«™ æŸ¥çœ‹ è¿›å…¥çƒ‚ç¬”å¤´æ¨¡å¼ è·¯ç”± 1-è·¯ç”±åŠ è½½// ç›´æ¥åŠ è½½é¡µé¢ import page from '@/views/page'; // æ‡’åŠ è½½é¡µé¢ () =&gt; import('@/views/page'); // æŒ‡å®šæ‰“åŒ…åç§°çš„æ‡’åŠ è½½ï¼Œå¯å°†å¤šä¸ªé¡µé¢æ‰“åŒ…æˆä¸€ä¸ªjsè¿›è¡ŒåŠ è½½ () =&gt; import(/* webpackChunkName: &quot;group-page&quot; */'@/views/page1'); () =&gt; import(/* webpackChunkName: &quot;group-page&quot; */'@/views/page2'); () =&gt; import(/* webpackChunkName: &quot;group-page&quot; */'@/views/page3'); 2-404è·¯ç”±// åŠ è½½ä¸€ä¸ª404é¡µé¢ import page404 from '@/views/page404'; // å°†ä»¥ä¸‹è·¯ç”±é…ç½®æ”¾ç½®åœ¨è·¯ç”±è¡¨çš„æœ€æœ«ç«¯ï¼Œå½“è·¯å¾„æ— æ³•åŒ¹é…å‰é¢çš„æ‰€æœ‰è·¯ç”±æ—¶å°†ä¼šè·³è½¬è‡³page404ç»„ä»¶é¡µé¢ { path: '*', component: page404} 3-è·¯ç”±æ‹¦æˆª// è·¯ç”±è·³è½¬å‰çš„æ‹¦æˆªå™¨ router.beforeEach((to, from, next) =&gt; { }); // è·¯ç”±è·³è½¬åçš„æ‹¦æˆªå™¨ router.afterEach(to =&gt; { }); // è·¯ç”±è·³è½¬æ—¶å‡ºç°é”™è¯¯æ—¶çš„æ‹¦æˆªå™¨ router.onError((err) =&gt; { }); 4-åŠ¨æ€è·¯ç”± åŠ¨æ€è·¯ç”±ä¸€èˆ¬é…åˆé¡µé¢çº§çš„æƒé™æ§åˆ¶ä½¿ç”¨ // é€šè¿‡router.addRoutesæ–¹æ³•åŠ¨æ€æ·»åŠ å¯è®¿é—®è·¯ç”± router.addRoutes(addRouters) // hackæ–¹æ³• ç¡®ä¿addRouteså·²å®Œæˆ next({ ...to, replace: true }) // set the replace: true so the navigation will not leave a history record 5-è·¯ç”±åŠ è½½æ—¶åŠ¨ç”» è·¯ç”±åŠ è½½æ—¶çš„loadingåŠ¨ç”»ä¸€èˆ¬é…åˆè·¯ç”±æ‡’åŠ è½½ä½¿ç”¨ // åœ¨çŠ¶æ€ç®¡ç†ä¸­å®šä¹‰ä¸€ä¸ªè·¯ç”±loadingæ ‡å¿— const app = { state: { routerLoading: false, //è·¯ç”±çš„loadingè¿‡æ¸¡ }, mutations: { //ä¿®æ”¹è·¯ç”±loadingçŠ¶æ€ UPDATE_ROUTER_LOADING(state, status) { state.routerLoading = status } } } // åœ¨è·¯ç”±æ‹¦æˆªå™¨ä¸­ä¿®æ”¹loadingçŠ¶æ€ router.beforeEach((to, from, next) =&gt; { store.commit('UPDATE_ROUTER_LOADING', true); // å±•ç¤ºè·¯ç”±åŠ è½½æ—¶åŠ¨ç”» }); router.afterEach(to =&gt; { store.commit('UPDATE_ROUTER_LOADING', false); }); router.onError(err =&gt; { console.error(err); // for bug store.commit('UPDATE_ROUTER_LOADING', false); }); // åœ¨router-viewå®šä¹‰loadingåŠ¨ç”» // element-uiæä¾›äº†v-loadingæŒ‡ä»¤å¯ä»¥ç›´æ¥ä½¿ç”¨ &lt;router-view v-loading=&quot;$store.getters.routerLoading&quot;&gt;&lt;/router-view&gt; çŠ¶æ€ç®¡ç† 1-å°çŸ¥è¯† stateä¸­çš„æ•°æ®ä¿®æ”¹éœ€è¦é€šè¿‡mutationæˆ–actionè§¦å‘ mutationä¸­çš„æ–¹æ³•å¿…é¡»æ˜¯åŒæ­¥å‡½æ•° actionå¯åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œï¼Œå¯è¿”å›ä¸€ä¸ªPromise mutationä»¥åŠactionå¯ä»¥é‡å¤ï¼Œè°ƒç”¨æ—¶å°†ä¼šä¾æ¬¡è°ƒç”¨ï¼Œgetterå¿…é¡»å”¯ä¸€ 2-å¤šæ¨¡å— ä¸šåŠ¡æ¯”è¾ƒå¤æ‚æ—¶å¯ä½¿ç”¨çŠ¶æ€ç®¡ç†ä¸­çš„å¤šæ¨¡å—ï¼Œæœ‰ä»¥ä¸‹æ³¨æ„äº‹é¡¹ é™¤stateä¼šæ ¹æ®ç»„åˆæ—¶æ¨¡å—çš„åˆ«åæ¥æ·»åŠ å±‚çº§ï¼Œå…¶ä»–çš„éƒ½æ˜¯åˆå¹¶åœ¨æ ¹çº§ä¸‹ï¼Œæ‰€ä»¥åœ¨å›è°ƒå‡½æ•°è·å–çš„gettersã€commitã€dispatchéƒ½æ˜¯å…¨å±€ä½œç”¨çš„ mutationçš„å›è°ƒå‚æ•°åªæœ‰stateï¼Œstateä¸ºå½“å‰æ¨¡å—çš„çŠ¶æ€æ ‘ï¼Œä¸‹åŒ actionçš„å›è°ƒå‚æ•°ä¸ºstateã€rootStateã€gettersã€commitã€dispatchï¼Œå¦‚æœéœ€è¦åœ¨actionä¸­è°ƒç”¨å…¶ä»–çš„actionå¯ä½¿ç”¨dispatchç›´æ¥è°ƒç”¨ getterçš„å›è°ƒå‚æ•°ä¸ºstateã€rootStateã€getters æ¨¡å—é—´å¯ä»¥é€šè¿‡å›è°ƒçš„rootStateè¿›è¡Œäº¤äº’ å‡ºç°é‡åçš„mutationã€actionå°†ä¾æ¬¡è§¦å‘// å¤šæ¨¡å—çš„å®ç° appä»¥åŠuserä¸ºå„ä¸ªå­æ¨¡å— export default new Vuex.Store({ modules: { app, user }, getters }) 3-è¾…åŠ©å‡½æ•° Vuexé™¤äº†æä¾›äº†Storeå¯¹è±¡ä»¥å¤–è¿˜å¯¹å¤–æä¾›äº†ä¸€äº›è¾…åŠ©å‡½æ•° mapStateã€mapGetterså°†storeä¸­çš„stateã€getterså±æ€§æ˜ å°„åˆ°vueç»„ä»¶å±€éƒ¨çš„è®¡ç®—å±æ€§ä¸­ import { mapState } from 'vuex' computed: mapState([ // æ˜ å°„ this.name åˆ° this.$store.state.name 'name' ]) import { mapGetters } from 'vuex' computed: { // æ˜ å°„ this.name åˆ° this.$store.getters.name ...mapGetters([ 'name' ]) } mapActionsã€mapMutationså°†storeä¸­çš„dispatchã€commitæ–¹æ³•æ˜ å°„åˆ°vueç»„ä»¶å±€éƒ¨çš„æ–¹æ³•ä¸­ import { mapActions } from 'vuex' methods: { // æ˜ å°„ this.LoginByUsername() åˆ° this.$store.dispatch('LoginByUsername') ...mapActions([ 'LoginByUsername' ]), // æ˜ å°„ this.login() to this.$store.dispatch('LoginByUsername') ...mapActions({ login: 'LoginByUsername'}) } import { mapMutations } from 'vuex' methods: { // æ˜ å°„ this.SET_NAME() åˆ° this.$store.commit('SET_NAME') ]) ...mapMutations([ 'SET_NAME' ]) , // æ˜ å°„ this.setName() åˆ° this.$store.commit('SET_NAME') }) ...mapMutations({ setName: 'SET_NAME' ]) } 4-æ•°æ®æŒä¹…åŒ–æ’ä»¶ åˆ·æ–°é¡µé¢æ—¶å¸Œæœ›çŠ¶æ€ä¸è¢«ä¸¢å¤±æ—¶å¯ç”¨æ­¤æ’ä»¶ // æ‘˜æŠ„äº https://github.com/robinvdvleuten/vuex-persistedstate import createPersistedState from 'vuex-persistedstate' import * as Cookies from 'js-cookie' const store = new Store({ // ... plugins: [ createPersistedState({ storage: { getItem: key =* Cookies.get(key), // Please see https://github.com/js-cookie/js-cookie#json, on how to handle JSON. setItem: (key, value) =* Cookies.set(key, value, { expires: 3, secure: true }), removeItem: key =* Cookies.remove(key) } }) ] }) 5-æ—¥å¿—æ’ä»¶ å¼€å‘ç¯å¢ƒä¸­å¸Œæœ›èƒ½å¤Ÿè·Ÿè¸ªçŠ¶æ€å˜åŒ–å¹¶è¾“å‡ºæ—¶å¯ç”¨æ­¤æ’ä»¶ // createLoggeræ˜¯vuexä¸­çš„å†…ç½®æ’ä»¶ import createLogger from 'vuex/dist/logger' let vuexPlugins = []; if(process.env.NODE_ENV !== 'production'){ // å¼€å‘ç¯å¢ƒåŠ è½½è¯¥æ’ä»¶ vuexPlugins.push(createLogger); } const store = new Store({ // ... plugins: vuexPlugins }) æƒé™ç®¡ç† 1-éœ€è¦å®ç°çš„åŠŸèƒ½ æ ¹æ®ç”¨æˆ·ç™»å½•åçš„æƒé™è¡¨ç”Ÿæˆè·¯ç”± é¡µé¢çº§çš„æƒé™æ§åˆ¶ domå…ƒç´ çº§çš„æƒé™æ§åˆ¶ ç™»å½•çŠ¶æ€å¤±æ•ˆçš„å¤„ç† 2-è·¯ç”±è®¾è®¡ é¦–å…ˆæˆ‘ä»¬éœ€è¦è®¾è®¡è·¯ç”±å¯¹è±¡éœ€è¦æœ‰å“ªäº›å¿…è¦å‚æ•°ä¿¡æ¯ ä¸ºäº†å®ç°æƒé™ç®¡ç†æˆ‘ä»¬å¿…é¡»è¦æœ‰roleså‚æ•°ä»£è¡¨è¯¥è·¯ç”±å¿…é¡»æ‹¥æœ‰å“ªäº›æƒé™æ‰èƒ½è®¿é—® ä¸ºäº†æ›´å¥½çš„å±•ç¤ºè·¯ç”±åœ¨è¿™é‡Œè®¾è®¡äº†titleã€iconä¸¤ä¸ªå‚æ•°ç”¨äºä¾§è¾¹æ çš„èœå•å±•ç¤º è€Œæœ‰äº›è·¯ç”±ä¸éœ€è¦åœ¨ä¾§è¾¹æ å±•ç¤ºï¼Œè¿™é‡Œä½¿ç”¨hiddenå‚æ•°æ¥å‘Šè¯‰ç¨‹åºå“ªäº›è·¯ç”±æ˜¯ä¸éœ€è¦å±•ç¤ºçš„ // é¦–å…ˆè®¾è®¡è·¯ç”±å¯¹è±¡å‚æ•° /** * hidden: true å¦‚æœhiddenä¸ºtrueåˆ™åœ¨å·¦ä¾§èœå•æ å±•ç¤ºï¼Œé»˜è®¤ä¸ºfalse * name:'router-name' è·¯ç”±åç§°ï¼Œè·¯ç”±å”¯ä¸€æ ‡è¯† * meta : { roles: ['admin','editor'] æƒé™åˆ—è¡¨ï¼Œç”¨äºé¡µé¢çº§çš„æƒé™æ§åˆ¶ï¼Œé»˜è®¤ä¸è®¾ç½®ä»£è¡¨ä»»ä½•æƒé™å‡å¯è®¿é—® title: 'title' å¯¹åº”è·¯ç”±åœ¨å·¦ä¾§èœå•æ çš„æ ‡é¢˜åç§° icon: 'icon-class' å¯¹åº”è·¯ç”±åœ¨å·¦ä¾§èœå•æ çš„å›¾æ ‡æ ·å¼ } **/ æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®ç°è·¯ç”±çš„åŠ¨æ€åŠ è½½ ç³»ç»Ÿåˆå§‹åŒ–æ—¶åŠ è½½å¿…è¦è·¯ç”±ï¼Œä¹‹åæ ¹æ®ç™»å½•ç”¨æˆ·çš„æƒé™åŠ è½½ç¬¦åˆæ¡ä»¶çš„è·¯ç”± // å®šä¹‰ç³»ç»Ÿåˆå§‹åŒ–æ—¶åŠ è½½çš„å¿…è¦è·¯ç”±ä¿¡æ¯ export const constantRouterMap = [ { path: '/login', name: 'login', meta: { title: &quot;ç³»ç»Ÿç™»å½•&quot;, hidden: true }, component: login }, { path: &quot;/404&quot;, name: &quot;page404&quot;, meta: { title: &quot;é¡µé¢èµ°ä¸¢äº†&quot;, hidden: true }, component: page404 }, { path: &quot;/401&quot;, name: &quot;page401&quot;, meta: { title: &quot;æƒé™ä¸è¶³&quot;, hidden: true }, component: page401 } ] // å®šä¹‰å¸ƒå±€é¡µé¢ const layout = () =&gt; import(/* webpackChunkName: &quot;group-index&quot; */ '@/views/layout'); // å®šä¹‰å¼‚æ­¥åŠ è½½çš„è·¯ç”±ä¿¡æ¯ export const asyncRouterMap = [ { path: '/', name: 'main', redirect: '/dashboard', hidden: true, component: layout, children: [ { path: 'dashboard', name: 'dashboard', meta: { title: &quot;ä»ªè¡¨ç›˜&quot; }, component: () =&gt; import(/* webpackChunkName: &quot;group-index&quot; */'@/views/dashboard') } ] }, { path: '/permission', name: 'permission', meta: { title: &quot;æƒé™é¡µ&quot;, icon: &quot;dbm d-icon-quanxian&quot; }, redirect: '/permission/adminpermission', component: layout, children: [ { path: &quot;adminpermission&quot;, name: &quot;adminPermission&quot;, meta: { title: &quot;ç®¡ç†å‘˜æƒé™é¡µ&quot;, roles: [&quot;admin&quot;] }, component: () =&gt; import('@/views/permission/admin') }, { path: &quot;watcherpermission&quot;, name: &quot;watcherPermission&quot;, meta: { title: &quot;æ¸¸å®¢æƒé™é¡µ&quot;, roles: [&quot;admin&quot;, &quot;watcher&quot;] }, component: () =&gt; import('@/views/permission/watcher') }, { path: &quot;elementpermission&quot;, name: &quot;elementPermission&quot;, meta: { title: &quot;å…ƒç´ çº§åˆ«æƒé™&quot; }, component: () =&gt; import('@/views/permission/element') } ] }, { path: '*', redirect: '/404', hidden: true } ] 3-é¡µé¢çº§çš„æƒé™æ§åˆ¶ ä½¿ç”¨è·¯ç”±æ‹¦æˆªæ¥å®ç°é¡µé¢çº§çš„æƒé™æ§åˆ¶ æ‹¦æˆªè·¯ç”±è·³è½¬åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½• ä»æ‹‰å–çš„ç”¨æˆ·ä¿¡æ¯ä¸­æå–æƒé™è¡¨é€šè¿‡addRoutesæ–¹æ³•åŠ¨æ€åŠ è½½å¼‚æ­¥è·¯ç”±è¡¨ æ¯æ¬¡è·¯ç”±è·³è½¬æ—¶åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰è¯¥è·¯ç”±çš„è®¿é—®æƒé™å®ç°åŠ¨æ€æƒé™åŒ¹é… // å®šä¹‰å…ç™»ç™½åå• const whiteList = ['/login', '/404', '/401']; // æ‹¦æˆªè·¯ç”±è·³è½¬ router.beforeEach((to, from, next) =&gt; { store.commit('UPDATE_ROUTER_LOADING', true); // å±•ç¤ºè·¯ç”±åŠ è½½æ—¶åŠ¨ç”» if (getToken()) { // å­˜åœ¨token if (to.path === '/login') { next({ path: '/' }) } else { if (store.getters.roles.length === 0) { // åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦å·²æ‹‰å–å®Œç”¨æˆ·ä¿¡æ¯ store.dispatch('GetUserInfo').then(data =&gt; { // æ‹‰å–ç”¨æˆ·ä¿¡æ¯ const roles = data.roles // æƒé™è¡¨å¿…é¡»ä¸ºæ•°ç»„,ä¾‹å¦‚: ['admin','editer'] store.dispatch('GenerateRoutes', { roles }).then(() =&gt; { // æ ¹æ®rolesæƒé™ç”Ÿæˆå¯è®¿é—®çš„è·¯ç”±è¡¨ router.addRoutes(store.getters.addRouters) // åŠ¨æ€æ·»åŠ å¯è®¿é—®è·¯ç”±è¡¨ next({ ...to, replace: true }) // hackæ–¹æ³• ç¡®ä¿addRouteså·²å®Œæˆ ,set the replace: true so the navigation will not leave a history record }) }).catch(err =&gt; { // æ‹‰å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œæç¤ºç™»å½•çŠ¶æ€å¤±æ•ˆ store.dispatch('FedLogOut').then(() =&gt; { Message.error('ç™»å½•çŠ¶æ€å¤±æ•ˆ, è¯·é‡æ–°ç™»å½•'); next({ path: '/login' }); }) }) } else { if (hasPermission(store.getters.roles, to.meta.roles)) { // åŠ¨æ€æƒé™åŒ¹é… next(); } else { next({ path: '/401', replace: true, query: { noGoBack: true } }); } } } } else { // æ²¡æœ‰token if (whiteList.indexOf(to.path) !== -1) { // åœ¨å…ç™»å½•ç™½åå•ï¼Œç›´æ¥è¿›å…¥ next(); } else { next('/login'); // å¦åˆ™å…¨éƒ¨é‡å®šå‘åˆ°ç™»å½•é¡µ } } }); 4-å…ƒç´ çº§çš„æƒé™æ§åˆ¶ ä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤æ¥å®ç°å…ƒç´ çº§çš„æƒé™æ§åˆ¶ åœ¨è¢«ç»‘å®šå…ƒç´ æ’å…¥çˆ¶èŠ‚ç‚¹æ—¶éªŒè¯ç”¨æˆ·æ˜¯å¦åŒ…å«è¯¥å…ƒç´ çš„æ‰€éœ€æƒé™ æ ¹æ®é‰´æƒç»“æœæ¥å†³å®šæ˜¯å¦ç§»é™¤è¯¥å…ƒç´  import store from '@/store' export default { inserted(el, binding, vnode) { const { value } = binding; // è·å–è‡ªå®šä¹‰æŒ‡ä»¤ä¼ å…¥çš„é‰´æƒä¿¡æ¯ const roles = store.getters &amp;&amp; store.getters.roles; // ä»çŠ¶æ€ç®¡ç†ä¸­è·å–å½“å‰ç”¨æˆ·çš„è·¯ç”±ä¿¡æ¯ if (value &amp;&amp; value instanceof Array &amp;&amp; value.length &gt; 0) { const permissionRoles = value; const hasPermission = roles.some(role =&gt; { // åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åŒ…å«è¯¥å…ƒç´ æ‰€éœ€æƒé™ return permissionRoles.includes(role); }) if (!hasPermission) { // æƒé™ä¸è¶³ el.parentNode &amp;&amp; el.parentNode.removeChild(el); // ç§»é™¤è¯¥domå…ƒç´  } } else { throw new Error(`å¿…é¡»è¦æœ‰æƒé™å†™å…¥ï¼Œä¾‹å¦‚['admin']`) } } } // åœ¨vueç»„ä»¶ä¸Šä½¿ç”¨å®ƒ // å¼•å…¥å¹¶æ³¨å†ŒpermissionæŒ‡ä»¤ import permission from &quot;@/directive/permission/index.js&quot;; export default { directives: { permission } } // ä½¿ç”¨permissionæŒ‡ä»¤ &lt;el-button v-permission=&quot;['admin']&quot;&gt;admin å¯è§&lt;/el-button&gt; &lt;el-button v-permission=&quot;['admin','watcher']&quot;&gt;watcher å¯è§&lt;/el-button&gt; renderå‡½æ•° 1-å¦‚ä½•å°è£…ä¸€ä¸ªæ”¯æŒrenderæ¸²æŸ“çš„ç»„ä»¶ é¦–å…ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ // è¡¨æ ¼æ‹“å±•å‡½æ•°å¼ç»„ä»¶çš„å®ç° // see https://github.com/calebman/vue-DBM/blob/master/src/components/table/expand.js export default { name: 'TableExpand', functional: true, // æ ‡è®°ç»„ä»¶ä¸º functionalï¼Œè¿™æ„å‘³å®ƒæ˜¯æ— çŠ¶æ€ (æ²¡æœ‰å“åº”å¼æ•°æ®)ï¼Œæ— å®ä¾‹ (æ²¡æœ‰ this ä¸Šä¸‹æ–‡)ã€‚ props: { row: Object, // å½“å‰è¡Œå¯¹è±¡ field: String, // åˆ—åç§° index: Number, // è¡Œå· render: Function // æ¸²æŸ“å‡½æ•° }, render: (h, ctx) =&gt; { // æä¾›ctxä½œä¸ºä¸Šä¸‹æ–‡ const params = { row: ctx.props.row, field: ctx.props.field, index: ctx.props.index }; return ctx.props.render(h, params); } }; åœ¨çˆ¶ç»„ä»¶ä¸­å¼•å…¥ // see https://github.com/calebman/vue-DBM/blob/master/src/components/table/table.vue import expand from &quot;./expand.js&quot;; &lt;span v-if=&quot;typeof col.render ==='function'&quot;&gt; &lt;expand :field=&quot;col.field&quot; :row=&quot;item&quot; :render=&quot;col.render&quot; :index=&quot;rowIndex&quot;&gt;&lt;/expand&gt; &lt;/span&gt; ä½¿ç”¨renderå‡½æ•°æ¸²æŸ“ // see https://github.com/calebman/vue-DBM/blob/master/src/views/demo/datatable/data-table.vue // å¼•å…¥è‡ªå®šä¹‰ç»„ä»¶ import IndexColumn from &quot;@/components/business/index-column.vue&quot;; // æ³¨å†Œ components: { // ... IndexColumn } // ä½¿ç”¨ // è·å–å½“å‰ç»„ä»¶çš„ä¸Šä¸‹æ–‡ let self = this; // å®šä¹‰æ¸²æŸ“å‡½æ•° render: (h, params) =&gt; h(&quot;div&quot;, [ h(IndexColumn, { props: { field: params.field, index: params.index, pagingIndex: (self.pagination.pageCurrent - 1) * self.pagination.pageSize }, on: { &quot;on-value-delete&quot;: self.deleteRow } }) ]) æ··å…¥ 1-å°çŸ¥è¯†-1 æ··å…¥å¯¹è±¡å°†äº«æœ‰è¢«æ··å…¥ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ æ•°æ®å¯¹è±¡æ··å…¥å†²çªæ—¶å°†ä»¥ç»„ä»¶æ•°æ®ä¼˜å…ˆ å¯¹è±¡é€‰é¡¹ï¼ˆå¦‚methodsã€componentsã€directivesï¼‰æ··å…¥å†²çªæ—¶å–ç»„ä»¶å¯¹è±¡çš„é”®å€¼å¯¹ åŒåé’©å­æ··åˆä¸ºæ•°ç»„ï¼Œæ··å…¥å¯¹è±¡çš„é’©å­å°†åœ¨ç»„ä»¶è‡ªèº«é’©å­ä¹‹å‰è°ƒç”¨ 2-åº”ç”¨åœºæ™¯ å¸Œæœ›éƒ¨åˆ†è·¯ç”±é¡µé¢åœ¨ç¦»å¼€æ—¶é”€æ¯ä½†æ˜¯ä¸å¸Œæœ›æ¯ä¸ªè·¯ç”±é¡µé¢éƒ½å®šä¹‰å±€éƒ¨è·¯ç”±æ—¶ // å®šä¹‰æ··å…¥å¯¹è±¡ export default { beforeRouteLeave(to, from, next) { if (to.meta &amp;&amp; to.meta.destroy) { this.$destroy(); } next(); } } // æ··å…¥éœ€è¦æ­¤åŠŸèƒ½çš„ç»„ä»¶é¡µé¢ import routeLeaveDestoryMixin from &quot;routeleave-destory-mixin&quot;; export default { // ... mixins: [routeLeaveDestoryMixin] } æ•°æ®è¡¨æ ¼è‡ªå®šä¹‰äº†æ–‡æœ¬ã€æ•°å­—ã€æ—¶é—´ä»¥åŠæ–‡ä»¶å•å…ƒæ ¼ç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰åŒæ ·çš„æ•°æ®ä¿®æ”¹ã€ç„¦ç‚¹é€‰ä¸­ç­‰æ–¹æ³•æ—¶ï¼Œå¯æå–ä¸ºæ··å…¥å¯¹è±¡ï¼Œæé«˜ç»„ä»¶å¤ç”¨æ€§ // see https://github.com/calebman/vue-DBM/blob/master/src/components/business/render-column-mixin.js // å®šä¹‰æ··å…¥å¯¹è±¡ export default { // ... computed: { // æ˜¯å¦é€‰ä¸­æ­¤å•å…ƒæ ¼ inSelect() { if (this.cellClickData.index == this.index &amp;&amp; this.cellClickData.field == this.field) { this.focus(); return true; } } }, methods: { // è·å–ç„¦ç‚¹ focus() { let self = this; setTimeout(function () { if (self.$refs[&quot;rendercolumn&quot;]) { self.$refs[&quot;rendercolumn&quot;].focus(); } }, 100); }, // å¤±å»ç„¦ç‚¹ blur() { if (this.v != this.value) { this.$emit(&quot;on-value-change&quot;, this.field, this.index, this.v); } this.$emit(&quot;on-value-cancel&quot;, this.field, this.index); }, // æ•°æ®ä¿®æ”¹ changeValue(val) { this.$emit(&quot;on-value-change&quot;, this.field, this.index, val); this.$emit(&quot;on-value-cancel&quot;, this.field, this.index); } }, watch: { // ç›‘å¬çˆ¶ç»„ä»¶æ•°æ®å˜åŒ– value(val) { this.v = val; } } } // æ–‡æœ¬åˆ— // see https://github.com/calebman/vue-DBM/blob/master/src/components/business/text-column.vue &lt;template&gt; &lt;div&gt; &lt;input v-show=&quot;inSelect&quot; ref=&quot;rendercolumn&quot; @blur=&quot;blur&quot; @keyup=&quot;enter($event)&quot; v-model=&quot;v&quot; /&gt; &lt;span v-show=&quot;!inSelect&quot; class=&quot;cell-text&quot;&gt;{{v}}&lt;/span&gt; &lt;/div&gt; &lt;/template&gt; // æ—¶é—´åˆ— // see https://github.com/calebman/vue-DBM/blob/master/src/components/business/datetime-column.vue &lt;template&gt; &lt;div&gt; &lt;el-date-picker v-show=&quot;inSelect&quot; ref=&quot;rendercolumn&quot; v-model=&quot;v&quot; type=&quot;datetime&quot; @change=&quot;changeValue&quot; @blur=&quot;blur&quot;&gt;&lt;/el-date-picker&gt; &lt;span v-show=&quot;!inSelect&quot;&gt;{{coverValue}}&lt;/span&gt; &lt;/div&gt; &lt;/template&gt; å¸Œæœ›é™ä½ç»„ä»¶çš„å¤æ‚åº¦çš„æ—¶å€™å¯ä½¿ç”¨å¤šä¸ªæ··å…¥ç»„ä»¶æ¥åˆ†å‰²æ ¸å¿ƒç»„ä»¶çš„åŠŸèƒ½ # see https://github.com/calebman/vue-DBM/tree/master/src/components/table â”œâ”€table â”‚ cell-edit-mixin.js # å•å…ƒæ ¼ç¼–è¾‘ â”‚ classes-mixin.js # è¡¨æ ¼æ ·å¼ â”‚ scroll-bar-control-mixin.js # è¡¨æ ¼æ»šåŠ¨ â”‚ table-empty-mixin.js # æ— æ•°æ®æ—¶çš„å¤„ç† â”‚ table-resize-mixin.js # è¡¨æ ¼çš„è‡ªé€‚åº” â”‚ table-row-mouse-events-mixin.js # é¼ æ ‡ç§»åŠ¨æ—¶çš„æ ·å¼æ”¹å˜ æ•°æ®æ¨¡æ‹Ÿ 1-éœ€è¦å®ç°çš„åŠŸèƒ½-1 æ‹¦æˆªAjaxè¯·æ±‚å¹¶å»¶æ—¶å“åº” è¿”å›çš„ç»Ÿä¸€çš„æ•°æ®æ ¼å¼ å“åº”ä¸åŒçš„æ¨¡æ‹Ÿæ•°æ® 2-é…ç½®Mockjsæ‹¦æˆªAjaxè¯·æ±‚// see https://github.com/calebman/vue-DBM/blob/master/src/mock/index.js // å¼•å…¥Mockjs import Mock from 'mockjs'; // é…ç½®å»¶æ—¶ Mock.setup({ timeout: '300-1000' }); // é…ç½®æ‹¦æˆª Mock.mock(/\\/user\\/login/, 'post', loginAPI.loginByUsername); Mock.mock(/\\/user\\/logout/, 'post', loginAPI.logout); Mock.mock(/\\/user\\/info\\.*/, 'get', loginAPI.getUserInfo); 3-å“åº”çš„ç»Ÿä¸€æ•°æ®æ ¼å¼// see https://github.com/calebman/vue-DBM/blob/master/src/mock/response.js /** * ç»Ÿä¸€å“åº”å·¥å…·ç±» * å“åº”ç»Ÿä¸€æ ¼å¼çš„æ•°æ® * response : { * errCode: 00 å“åº”ç»“æœç  * errMsg: 0000000ï¼ˆæˆåŠŸï¼‰ å“åº”è¯¦ç»†ç»“æœç  * data: null å…·ä½“æ•°æ® * } */ export default { // æˆåŠŸ success: data =&gt; { return { errCode: '00', errMsg: '0000000ï¼ˆæˆåŠŸï¼‰', data: data ? data : null } }, // å¤±è´¥ fail: (errCode, errMsg) =&gt; { return { errCode: errCode ? errCode : '04', errMsg: errMsg ? errMsg : '0401001ï¼ˆæœªçŸ¥é”™è¯¯ï¼‰', data: null } }, // æƒé™ä¸è¶³ unauthorized: () =&gt; { return { errCode: '43', errMsg: '4300001ï¼ˆæ— æƒè®¿é—®ï¼‰', data: null } } } 4-é…ç½®å“åº”é€»è¾‘// see https://github.com/calebman/vue-DBM/blob/master/src/mock/login.js import { param2Obj } from '@/utils'; import Response from './response'; const userMap = { admin: { password: 'admin', roles: ['admin'], token: 'admin', introduction: 'æˆ‘æ˜¯è¶…çº§ç®¡ç†å‘˜', avatar: 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif', name: 'Super Admin' }, watcher: { password: 'watcher', roles: ['watcher'], token: 'watcher', introduction: 'æˆ‘æ˜¯æ¸¸å®¢', avatar: 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif', name: 'Normal Watcher' } } export default { // ä½¿ç”¨ç”¨æˆ·åç™»å½• loginByUsername: config =&gt; { const { username, password } = JSON.parse(config.body); if (userMap[username] &amp;&amp; userMap[username].password === password) { return Response.success(userMap[username]); } else { return Response.fail(&quot;01&quot;, &quot;0101001ï¼ˆç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼‰&quot;) } }, // æ‹‰å–ç”¨æˆ·ä¿¡æ¯ getUserInfo: config =&gt; { const { token } = param2Obj(config.url); if (userMap[token]) { return Response.success(userMap[token]); } else { return Response.fail(); } }, // æ³¨é”€ logout: () =&gt; Response.success() } 5-æ¨¡æ‹Ÿéšæœºæ•°æ®// see https://github.com/nuysoft/Mock/wiki import Mock from 'mockjs'; // éšæœºå­—ç¬¦ä¸² function mockStr() { let result = Mock.mock({ 'str': '@name' }); return result.str; } // éšæœºæ•°å­— function mockNumber(min, max) { let key = 'num|' + min + '-' + max; let param = {} param[key] = 100; return Mock.mock(param).num; } // éšæœºå°æ•°ï¼Œæœ€é«˜å°æ•°ç‚¹åä¸‰ä½ function mockDecimal() { return Mock.Random.float(1, 100, 1, 3) } // éšæœºæ•°ç»„ä¸€é¡¹ const arr = [&quot;image2.jpeg&quot;, &quot;image3.jpeg&quot;, &quot;image4.jpeg&quot;, &quot;image5.jpeg&quot;, &quot;image6.jpeg&quot;]; function mockOneFileAddress() { return Mock.mock({ 'oneFile|1': arr }).oneFile; } // éšæœºæ—¥æœŸ function mockDate() { let mockDateStr = Mock.Random.datetime('yyyy-MM-dd HH:mm:ss'); // åœ¨è¿™é‡Œä½¿ç”¨äº†momentjså°†å…¶è§£æä¸ºDateç±»å‹ let mockDate = moment(mockDateStr, 'YYYY-MM-DD HH:mm:ss').toDate(); return mockDate; } æ‰“åŒ…ä¼˜åŒ– 1-åšå“ªéƒ¨åˆ†çš„ä¼˜åŒ– cdnä¼˜åŒ– è·¯ç”±æ‡’åŠ è½½ å…¶ä»–ä¼˜åŒ– ç”¨æˆ·ä½“éªŒ 2-cdnä¼˜åŒ– ç±»ä¼¼äºvueã€vue-routerã€momentã€element-uiç­‰æä¾›äº†cdnçš„æ¶æˆ–è€…å·¥å…·ç±»å¯åœ¨index.htmlä¸­ç›´æ¥å¼•å…¥ï¼Œç„¶åé…ç½®webpackçš„externalsä½¿å…¶ä¸åŠ å…¥æ‰“åŒ…é…ç½®ï¼Œä»è€Œå‡å°app.jsã€vendor.jsçš„ä½“ç§¯ åœ¨index.htmlä½¿ç”¨cdnå¼•å…¥ä¾èµ–åº“ &lt;!-- ç½‘ç»œè¯·æ±‚å·¥å…·ç±» --&gt; &lt;script src=&quot;https://cdn.bootcss.com/axios/0.18.0/axios.min.js&quot;&gt;&lt;/script&gt; &lt;!-- vue --&gt; &lt;script src=&quot;https://cdn.bootcss.com/vue/2.5.16/vue.min.js&quot;&gt;&lt;/script&gt; &lt;!-- vue-router --&gt; &lt;script src=&quot;https://cdn.bootcss.com/vue-router/3.0.1/vue-router.min.js&quot;&gt;&lt;/script&gt; &lt;!-- vuex --&gt; &lt;script src=&quot;https://cdn.bootcss.com/vuex/3.0.1/vuex.min.js&quot;&gt;&lt;/script&gt; &lt;!-- momentjsçš„ä¸­æ–‡åŒ… --&gt; &lt;script src=&quot;https://cdn.bootcss.com/moment.js/2.22.1/moment-with-locales.min.js&quot;&gt;&lt;/script&gt; &lt;!-- momentjs --&gt; &lt;script src=&quot;https://cdn.bootcss.com/moment.js/2.22.1/locale/zh-cn.js&quot;&gt;&lt;/script&gt; &lt;!-- element-uiæ ·å¼ --&gt; &lt;script src=&quot;https://cdn.bootcss.com/element-ui/2.3.6/theme-default/index.css&quot;&gt;&lt;/script&gt; &lt;!-- element-ui --&gt; &lt;script src=&quot;https://cdn.bootcss.com/element-ui/2.3.6/index.js&quot;&gt;&lt;/script&gt; é…ç½®buildæ–‡ä»¶å¤¹ä¸‹webpack.base.conf.jsæ–‡ä»¶ module.exports = { // ... externals: { 'axios': 'axios', 'vue': 'Vue', 'vue-router': 'VueRouter', 'vuex': 'Vuex', 'moment': 'moment', 'element-ui': 'ELEMENT' } } 3-è·¯ç”±æ‡’åŠ è½½ è·¯ç”±æ‡’åŠ è½½èƒ½å¤Ÿå°†ä»£ç æ ¹æ®è·¯ç”±é…ç½®è¿›è¡Œåˆ†å‰²ï¼ŒåŠ å¿«é¦–å±æ¸²æŸ“çš„é€Ÿåº¦ï¼Œåœ¨å¤§å‹çš„å•é¡µåº”ç”¨ä¸­æ˜¯å¿…ä¸å¯å°‘çš„ å‚è§è·¯ç”±ç®¡ç†çš„å®ç° 5-å…¶ä»–ä¼˜åŒ– å°½é‡å°‘çš„æ³¨å†Œå…¨å±€ç»„ä»¶ï¼Œä½¿ç”¨UIæ¡†æ¶å¯ä»¥å‚è€ƒæ–‡æ¡£åšæŒ‰éœ€åŠ è½½ å¯ä»¥å’ŒæœåŠ¡ç«¯é…åˆé‡‡ç”¨gzipå‹ç¼©ï¼Œå‡å°‘ä¼ è¾“è€—æ—¶ åœ¨æ›´æ–°ä¸æ˜¯å¾ˆé¢‘ç¹çš„åº”ç”¨å¯è€ƒè™‘æé«˜ç¼“å­˜æ—¶é—´ ä¾‹å¦‚momentã€lodashè¿™ç§åºå¤§çš„å·¥å…·åº“åœ¨ä½¿ç”¨çš„åŠŸèƒ½ä¸å¤šçš„æƒ…å†µä¸‹å¯è€ƒè™‘å¯»æ‰¾æ›¿ä»£å“ 6-ç”¨æˆ·ä½“éªŒ ä¸€ä¸ªå•é¡µåº”ç”¨åˆ°äº†ä¸€å®šè§„æ¨¡ä¸ç®¡æ€ä¹ˆä¼˜åŒ–é¦–å±æ¸²æŸ“è¿˜æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ…¢çš„è¿‡ç¨‹ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘åœ¨é¦–å±æ¸²æŸ“æ—¶ä½¿ç”¨ä¸€ä¸ªåŠ è½½åŠ¨ç”»å‘Šè¯‰ç”¨æˆ·ç³»ç»Ÿæ­£åœ¨åˆå§‹åŒ– é¦–å…ˆåœ¨index.htmlä¸­å®šä¹‰ä¸€ä¸ªæ¸²æŸ“åŠ¨ç”» &lt;body&gt; &lt;div id=&quot;app&quot;&gt;&lt;/div&gt; &lt;!-- é¦–å±æ¸²æŸ“æ—¶çš„åŠ è½½åŠ¨ç”» --&gt; &lt;div id=&quot;system-loading&quot; class=&quot;showbox&quot;&gt; &lt;div class=&quot;loader&quot;&gt; &lt;svg class=&quot;circular&quot; viewBox=&quot;25 25 50 50&quot;&gt; &lt;circle class=&quot;path&quot; cx=&quot;50&quot; cy=&quot;50&quot; r=&quot;20&quot; fill=&quot;none&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; /&gt; &lt;/svg&gt; &lt;/div&gt; &lt;div class=&quot;text&quot;&gt; &lt;span&gt;ç³»ç»Ÿåˆå§‹åŒ–ä¸­...&lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- built files will be auto injected --&gt; &lt;/body&gt; ç„¶ååœ¨App.vueç»„ä»¶çš„mountedé’©å­ä¸­ç§»é™¤è¿™ä¸ªloading export default { // ... mounted() { document.body.removeChild(document.getElementById(&quot;system-loading&quot;)); } };","link":"/2018-05-18-vue-notes/"},{"title":"SpringBooté›†æˆç¯å¢ƒæ­å»º","text":"ä¸€ä¸ªé«˜å¯å¤ç”¨çš„SpringBootåŸºç¡€æ¡†æ¶ æœ¬æ–‡ç®€ä»‹ ä¸ºä»€ä¹ˆä½¿ç”¨SpringBoot æ­å»ºæ€æ ·ä¸€ä¸ªç¯å¢ƒ å¼€å‘ç¯å¢ƒ å¯¼å…¥å¿«é€Ÿå¯åŠ¨é¡¹ç›® é›†æˆå‰å‡†å¤‡ é›†æˆMybatis é›†æˆSwagger2 å¤šç¯å¢ƒé…ç½® å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½® å¸¸ç”¨é…ç½® ä¸ºä»€ä¹ˆä½¿ç”¨SpringBoot&emsp;&emsp; SpringBootç›¸å¯¹äºä¼ ç»Ÿçš„SSMæ¡†æ¶çš„ä¼˜ç‚¹æ˜¯æä¾›äº†é»˜è®¤çš„æ ·æ¿åŒ–é…ç½®ï¼Œç®€åŒ–äº†Springåº”ç”¨çš„åˆå§‹æ­å»ºè¿‡ç¨‹ï¼Œå¦‚æœä½ ä¸æƒ³è¢«ä¼—å¤šçš„xmlé…ç½®æ–‡ä»¶å›°æ‰°ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨SpringBootæ›¿ä»£ æ­å»ºæ€æ ·ä¸€ä¸ªç¯å¢ƒ&emsp;&emsp; æœ¬æ–‡å°†åŸºäºSpringå®˜æ–¹æä¾›çš„å¿«é€Ÿå¯åŠ¨é¡¹ç›®æ¨¡æ¿é›†æˆMybatisã€Swagger2æ¡†æ¶ï¼Œå¹¶è®²è§£mybatis generatorä¸€é”®ç”Ÿæˆä»£ç æ’ä»¶ã€logbackã€ä¸€é”®ç”Ÿæˆæ–‡æ¡£ä»¥åŠå¤šç¯å¢ƒçš„é…ç½®æ–¹æ³•ï¼Œæœ€åå†ä»‹ç»ä¸€ä¸‹è‡ªå®šä¹‰é…ç½®çš„æ³¨è§£è·å–ã€å…¨å±€å¼‚å¸¸å¤„ç†ç­‰ç»å¸¸ç”¨åˆ°çš„ä¸œè¥¿ã€‚ å¼€å‘ç¯å¢ƒ&emsp;&emsp; æœ¬äººä½¿ç”¨IDEAä½œä¸ºå¼€å‘å·¥å…·ï¼ŒIDEAä¸‹è½½æ—¶é»˜è®¤é›†æˆäº†SpringBootçš„å¿«é€Ÿå¯åŠ¨é¡¹ç›®å¯ä»¥ç›´æ¥åˆ›å»ºï¼Œå¦‚æœä½¿ç”¨Eclipseçš„åŒå­¦å¯ä»¥è€ƒè™‘å®‰è£…SpringBootæ’ä»¶æˆ–è€…ç›´æ¥ä»è¿™é‡Œé…ç½®å¹¶ä¸‹è½½SpringBootå¿«é€Ÿå¯åŠ¨é¡¹ç›®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æœ¬æ¬¡ç¯å¢ƒæ­å»ºé€‰æ‹©çš„æ˜¯SpringBoot2.0çš„å¿«é€Ÿå¯åŠ¨æ¡†æ¶ï¼ŒSpringBoot2.0è¦æ±‚jdkç‰ˆæœ¬å¿…é¡»è¦åœ¨1.8åŠä»¥ä¸Šã€‚ å¯¼å…¥å¿«é€Ÿå¯åŠ¨é¡¹ç›®&emsp;&emsp; ä¸ç®¡æ˜¯ç”±IDEAå¯¼å…¥è¿˜æ˜¯ç°å®ä¸‹è½½æ¨¡æ¿å·¥ç¨‹éƒ½éœ€è¦åˆå§‹åŒ–å¿«é€Ÿå¯åŠ¨å·¥ç¨‹çš„é…ç½®ï¼Œå¦‚æœä½¿ç”¨IDEAï¼Œåœ¨æ–°å»ºé¡¹ç›®æ—¶é€‰æ‹©Spring Initializrï¼Œä¸»è¦é…ç½®å¦‚ä¸‹å›¾&emsp;&emsp; ç‚¹å‡»nextä¹‹åfinishä¹‹åIDEAæ˜¾ç¤ºæ­£åœ¨ä¸‹è½½æ¨¡æ¿å·¥ç¨‹ï¼Œä¸‹è½½å®Œæˆåä¼šæ ¹æ®pom.xmlä¸‹è½½åŒ…ä¾èµ–ï¼Œä¾èµ–ä¸‹è½½å®Œæ¯•åæ¨¡æ¿é¡¹ç›®å°±ç®—åˆ›å»ºæˆåŠŸäº†ï¼Œå¦‚æœæ˜¯ç›´æ¥ä»å®˜æ–¹ç½‘ç«™é…ç½®ä¸‹è½½å¿«é€Ÿå¯åŠ¨é¡¹ç›®å¯å‚è€ƒä¸‹å›¾é…ç½®&emsp;&emsp; ä»Search for dependencies æ¡†ä¸­è¾“å…¥å¹¶é€‰æ‹©Webã€Mysqlã€MybatisåŠ å…¥ä¾èµ–ï¼Œç‚¹å‡»Generate Projectä¸‹è½½å¿«é€Ÿå¯åŠ¨é¡¹ç›®ï¼Œç„¶ååœ¨IDEä¸­é€‰æ‹©å¯¼å…¥Mavené¡¹ç›®ï¼Œé¡¹ç›®å¯¼å…¥å®Œæˆåå¯è§å…¶ç›®å½•ç»“æ„å¦‚ä¸‹å›¾&emsp;&emsp; éœ€è¦å…³æ³¨çº¢è‰²æ–¹æ¡†åœˆèµ·æ¥çš„éƒ¨åˆ†ï¼Œç”±ä¸Šå¾€ä¸‹ç¬¬ä¸€ä¸ªjavaç±»æ˜¯ç”¨æ¥å¯åŠ¨é¡¹ç›®çš„å…¥å£å‡½æ•°ï¼Œç¬¬äºŒä¸ªpropertiesåç¼€çš„æ–‡ä»¶æ˜¯é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œç¬¬ä¸‰ä¸ªæ˜¯é¡¹ç›®çš„ä¾èµ–åŒ…ä»¥åŠæ‰§è¡Œæ’ä»¶çš„é…ç½® é›†æˆå‰å‡†å¤‡ä¿®æ”¹-propertiesä¸º-yml&emsp;&emsp; ymlç›¸å¯¹äºpropertiesæ›´åŠ ç²¾ç®€è€Œä¸”å¾ˆå¤šå®˜æ–¹ç»™å‡ºçš„Demoéƒ½æ˜¯ymlçš„é…ç½®å½¢å¼ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ymlçš„å½¢å¼ä»£æ›¿propertiesï¼Œç›¸å¯¹äºpropertieså½¢å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒ å¯¹äºé”®çš„æè¿°ç”±åŸæœ‰çš„ â€œ.â€ åˆ†å‰²å˜æˆäº†æ ‘çš„å½¢çŠ¶ å¯¹äºæ‰€æœ‰çš„é”®çš„åé¢ä¸€ä¸ªè¦è·Ÿä¸€ä¸ªç©ºæ ¼ï¼Œä¸ç„¶å¯åŠ¨é¡¹ç›®ä¼šæŠ¥é…ç½®è§£æé”™è¯¯ # propertieså¼è¯­æ³•æè¿° spring.datasource.name = mysql spring.datasource.url = jdbc:mysql://localhost:3306/db?characterEncoding=utf-8 spring.datasource.username = root spring.datasource.password = 123 # ymlå¼è¯­æ³•æè¿° spring: datasource: name: mysql url: jdbc:mysql://localhost:3306/db?characterEncoding=utf-8 username: root password: 123 é…ç½®æ‰€éœ€ä¾èµ–&emsp;&emsp; å¿«é€Ÿå¯åŠ¨é¡¹ç›®åˆ›å»ºæˆåŠŸåæˆ‘ä»¬è§‚å¯Ÿå…¶pom.xmlæ–‡ä»¶ä¸­çš„ä¾èµ–å¦‚ä¸‹å›¾ï¼ŒåŒ…å«äº†æˆ‘ä»¬é€‰æ‹©çš„Webã€Mybatisä»¥åŠMysql &lt;!-- spring web mvc --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- mybatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- mysql --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- test --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &emsp;&emsp; ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨ORMæ¡†æ¶ä¸€èˆ¬è¿˜ä¼šé…åˆæ•°æ®åº“è¿æ¥æ± ä»¥åŠåˆ†é¡µæ’ä»¶æ¥ä½¿ç”¨ï¼Œåœ¨è¿™é‡Œæˆ‘é€‰æ‹©äº†é˜¿é‡Œçš„druidä»¥åŠpagehelperè¿™ä¸ªåˆ†é¡µæ’ä»¶ï¼Œå†åŠ ä¸Šæˆ‘ä»¬è¿˜éœ€è¦æ•´åˆswagger2æ–‡æ¡£è‡ªåŠ¨åŒ–æ„å»ºæ¡†æ¶ï¼Œæ‰€ä»¥å¢åŠ äº†ä»¥ä¸‹å››ä¸ªä¾èµ–é¡¹ &lt;!-- åˆ†é¡µæ’ä»¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.3&lt;/version&gt; &lt;/dependency&gt; &lt;!-- alibabaçš„druidæ•°æ®åº“è¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- alibabaçš„jsonæ ¼å¼åŒ–å¯¹è±¡ --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.31&lt;/version&gt; &lt;/dependency&gt; &lt;!-- è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ --&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.5.0&lt;/version&gt; &lt;/dependency&gt; é›†æˆMybatis&emsp;&emsp; Mybatisçš„é…ç½®ä¸»è¦åŒ…æ‹¬äº†druidæ•°æ®åº“è¿æ¥æ± ã€pagehelperåˆ†é¡µæ’ä»¶ã€mybatis-generatorä»£ç é€†å‘ç”Ÿæˆæ’ä»¶ä»¥åŠmapperã€pojoæ‰«æé…ç½® é…ç½®druidæ•°æ®åº“è¿æ¥æ± &emsp;&emsp; æ·»åŠ ä»¥ä¸‹é…ç½®è‡³application.ymlæ–‡ä»¶ä¸­ spring: datasource: # å¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ name: mysql # è¿æ¥æ•°æ®åº“çš„url url: jdbc:mysql://localhost:3306/db?characterEncoding=utf-8 # è¿æ¥æ•°æ®åº“çš„è´¦å· username: root # è¿æ¥æ•°æ®åº“çš„å¯†ç  password: 123 # ä½¿ç”¨druidæ•°æ®æº type: com.alibaba.druid.pool.DruidDataSource # æ‰©å±•æ’ä»¶ # ç›‘æ§ç»Ÿè®¡ç”¨çš„filter:stat æ—¥å¿—ç”¨çš„filter:log4j é˜²å¾¡sqlæ³¨å…¥çš„filter:wall filters: stat # æœ€å¤§è¿æ¥æ± æ•°é‡ maxActive: 20 # åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶ initialSize: 1 # è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ maxWait: 60000 # æœ€å°è¿æ¥æ± æ•°é‡ minIdle: 1 timeBetweenEvictionRunsMillis: 60000 # è¿æ¥ä¿æŒç©ºé—²è€Œä¸è¢«é©±é€çš„æœ€é•¿æ—¶é—´ minEvictableIdleTimeMillis: 300000 # ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ # å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ validationQuery: select count(1) from 'table' # ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆ testWhileIdle: true # ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ testOnBorrow: false # å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ testOnReturn: false # æ˜¯å¦ç¼“å­˜preparedStatementï¼Œå³PSCache poolPreparedStatements: false # è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrue maxOpenPreparedStatements: -1 é…ç½®pagehelperåˆ†é¡µæ’ä»¶# pagehelperåˆ†é¡µæ’ä»¶ pagehelper: # æ•°æ®åº“çš„æ–¹è¨€ helperDialect: mysql # å¯ç”¨åˆç†åŒ–ï¼Œå¦‚æœpageNum &lt; 1ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œå¦‚æœpageNum &gt; pagesä¼šæŸ¥è¯¢æœ€åä¸€é¡µ reasonable: true ä»£ç é€†å‘ç”Ÿæˆæ’ä»¶mybatis-generatorçš„é…ç½®åŠè¿è¡Œ&emsp;&emsp; mybatis-generatoræ’ä»¶çš„ä½¿ç”¨ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ pom.xmlä¸­æ·»åŠ mybatis-generatoræ’ä»¶ &lt;build&gt; &lt;plugins&gt; &lt;!-- å°†Spring Bootåº”ç”¨æ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„jaræˆ–waræ–‡ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;!-- mybatis generator è‡ªåŠ¨ç”Ÿæˆä»£ç æ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.3.2&lt;/version&gt; &lt;configuration&gt; &lt;!-- æ‰«æresources/generatorç›®å½•ä¸‹çš„generatorConfig.xmlé…ç½® --&gt; &lt;configurationFile&gt; ${basedir}/src/main/resources/generator/generatorConfig.xml &lt;/configurationFile&gt; &lt;overwrite&gt;true&lt;/overwrite&gt; &lt;verbose&gt;true&lt;/verbose&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; 2.åˆ›å»ºé€†å‘ä»£ç ç”Ÿæˆé…ç½®æ–‡ä»¶generatorConfig.xml &emsp;&emsp; å‚ç…§pom.xmlæ’ä»¶é…ç½®ä¸­çš„æ‰«æä½ç½®ï¼Œåœ¨resourcesç›®å½•ä¸‹åˆ›å»ºgeneratoræ–‡ä»¶å¤¹ï¼Œåœ¨æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸­åˆ›å»ºgeneratorConfig.xmlé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶çš„è¯¦ç»†é…ç½®ä¿¡æ¯å¦‚ä¸‹ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE generatorConfiguration PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt; &lt;generatorConfiguration&gt; &lt;!-- è¿è¡Œæ–¹å¼:mvaenè¿è¡Œå‘½ä»¤ mybatis-generator:generate -e --&gt; &lt;!-- æ•°æ®åº“é©±åŠ¨:é€‰æ‹©ä½ çš„æœ¬åœ°ç¡¬ç›˜ä¸Šé¢çš„æ•°æ®åº“é©±åŠ¨åŒ…--&gt; &lt;properties resource=&quot;generator/generator.properties&quot;/&gt; &lt;classPathEntry location=&quot;${classPathEntry}&quot;/&gt; &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3&quot;&gt; &lt;!--æ•°æ®åº“é“¾æ¥URLï¼Œç”¨æˆ·åã€å¯†ç  --&gt; &lt;jdbcConnection driverClass=&quot;com.mysql.jdbc.Driver&quot; connectionURL=&quot;jdbc:mysql://localhost:3306/${db}?characterEncoding=utf-8&quot; userId=&quot;${userId}&quot; password=&quot;${password}&quot;&gt; &lt;/jdbcConnection&gt; &lt;javaTypeResolver&gt; &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot;/&gt; &lt;/javaTypeResolver&gt; &lt;javaModelGenerator targetPackage=&quot;${pojoTargetPackage}&quot; targetProject=&quot;src/main/java&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt; &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot;/&gt; &lt;/javaModelGenerator&gt; &lt;!-- ç”Ÿæˆæ˜ å°„æ–‡ä»¶çš„åŒ…åå’Œä½ç½®--&gt; &lt;sqlMapGenerator targetPackage=&quot;${mapperTargetPackage}&quot; targetProject=&quot;src/main/resources&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt; &lt;/sqlMapGenerator&gt; &lt;!-- ç”ŸæˆDAOçš„åŒ…åå’Œä½ç½®--&gt; &lt;javaClientGenerator type=&quot;XMLMAPPER&quot; targetPackage=&quot;${daoTargetPackage}&quot; targetProject=&quot;src/main/java&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt; &lt;/javaClientGenerator&gt; &lt;!-- è¦ç”Ÿæˆçš„è¡¨ tableNameæ˜¯æ•°æ®åº“ä¸­çš„è¡¨åæˆ–è§†å›¾å schemaæ˜¯æ•°æ®åº“åç§°--&gt; &lt;table tableName=&quot;%&quot; schema=&quot;${db}&quot;/&gt; &lt;/context&gt; &lt;/generatorConfiguration&gt; &emsp;&emsp; ä¸ºäº†å°†generatorConfig.xmlé…ç½®æ¨¡æ¿åŒ–ï¼Œåœ¨è¿™é‡Œå°†å˜åŠ¨æ€§è¾ƒå¤§çš„é…ç½®é¡¹å•ç‹¬æå–å‡ºæ¥ä½œä¸ºä¸€ä¸ªgeneratorConfig.xmlçš„é…ç½®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡propertiesæ ‡ç­¾è¯»å–æ­¤æ–‡ä»¶çš„é…ç½®ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å½“éœ€è¦å¤šå¤„å¤ç”¨æ­¤xmlæ—¶åªéœ€è¦å…³æ³¨å°‘é‡çš„é…ç½®é¡¹ã€‚&emsp;&emsp; åœ¨generatorConfig.xmlåŒçº§åˆ›å»ºgenerator.propertiesæ–‡ä»¶ï¼Œç°åªéœ€è¦é…ç½®generator.propertiesæ–‡ä»¶å³å¯ï¼Œé…ç½®å†…å®¹å¦‚ä¸‹ # è¯·æ‰‹åŠ¨é…ç½®ä»¥ä¸‹é€‰é¡¹ # æ•°æ®åº“é©±åŠ¨:é€‰æ‹©ä½ çš„æœ¬åœ°ç¡¬ç›˜ä¸Šé¢çš„æ•°æ®åº“é©±åŠ¨åŒ… classPathEntry = D:/CJH/maven-repository/mysql/mysql-connector-java/5.1.30/mysql-connector-java-5.1.30.jar # æ•°æ®åº“åç§°ã€ç”¨æˆ·åã€å¯†ç  db = db userId = root password = 123 # ç”Ÿæˆpojoçš„åŒ…åä½ç½® åœ¨src/main/javaç›®å½•ä¸‹ pojoTargetPackage = com.spring.demo.springbootexample.mybatis.po # ç”ŸæˆDAOçš„åŒ…åä½ç½® åœ¨src/main/javaç›®å½•ä¸‹ daoTargetPackage = com.spring.demo.springbootexample.mybatis.mapper # ç”ŸæˆMapperçš„åŒ…åä½ç½® ä½äºsrc/main/resourcesç›®å½•ä¸‹ mapperTargetPackage = mapper è¿è¡Œmybatis-generatoræ’ä»¶ç”ŸæˆDaoã€Modelã€Mapping # æ‰“å¼€å‘½ä»¤è¡Œcdåˆ°é¡¹ç›®pom.xmlåŒçº§ç›®å½•è¿è¡Œä»¥ä¸‹å‘½ä»¤ mvn mybatis-generator:generate -e mybatisæ‰«æåŒ…é…ç½®&emsp;&emsp; è‡³æ­¤å·²ç»ç”Ÿæˆäº†æŒ‡å®šæ•°æ®åº“å¯¹åº”çš„å®ä½“ã€æ˜ å°„ç±»ï¼Œä½†æ˜¯è¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦é…ç½®mybatisæ‰«æåœ°å€åæ‰èƒ½æ­£å¸¸è°ƒç”¨ åœ¨application.ymlé…ç½®mapper.xmlä»¥åŠpojoçš„åŒ…åœ°å€ mybatis: # mapper.xmlåŒ…åœ°å€ mapper-locations: classpath:mapper/*.xml # pojoç”ŸæˆåŒ…åœ°å€ type-aliases-package: com.spring.demo.springbootexample.mybatis.po åœ¨SpringBootExampleApplication.javaä¸­å¼€å¯Mapperæ‰«ææ³¨è§£ @SpringBootApplication @MapperScan(&quot;com.spring.demo.springbootexample.mybatis.mapper&quot;) public class SpringBootExampleApplication { public static void main(String[] args) { SpringApplication.run(SpringBootExampleApplication.class, args); } } æµ‹è¯•mapperçš„æœ‰æ•ˆæ€§@Controller public class TestController { //æ›¿æ¢æˆè‡ªå·±ç”Ÿæˆçš„mapper @Autowired UserMapper userMapper; @RequestMapping(&quot;/test&quot;) @ResponseBody public Object test(){ //æŸ¥è¯¢è¯¥è¡¨çš„æ‰€æœ‰æ•°æ® return userMapper.selectByExample(null); } } &emsp;&emsp; å¯åŠ¨SpringBootExampleApplication.javaçš„mainå‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰åœ¨application.ymlç‰¹æ„é…ç½®server.porté‚£ä¹ˆspringbootä¼šé‡‡ç”¨é»˜è®¤çš„8080ç«¯å£è¿è¡Œï¼Œè¿è¡ŒæˆåŠŸå°†æ‰“å°å¦‚ä¸‹æ—¥å¿— Tomcat started on port(s): 8080 (http) with context path '' åœ¨æµè§ˆå™¨è¾“å…¥åœ°å€å¦‚æœè¿”å›è¡¨æ ¼çš„ä¸­çš„æ‰€æœ‰æ•°æ®ä»£è¡¨mybatisé›†æˆæˆåŠŸ http://localhost:8080/test é›†æˆSwagger2&emsp;&emsp; Swagger2æ˜¯ä¸€ä¸ªæ–‡æ¡£å¿«é€Ÿæ„å»ºå·¥å…·ï¼Œèƒ½å¤Ÿé€šè¿‡æ³¨è§£è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªRestfulé£æ ¼jsonå½¢å¼çš„æ¥å£æ–‡æ¡£ï¼Œå¹¶å¯ä»¥é€šè¿‡å¦‚swagger-uiç­‰å·¥å…·ç”Ÿæˆhtmlç½‘é¡µå½¢å¼çš„æ¥å£æ–‡æ¡£ï¼Œswagger2çš„é›†æˆæ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨éœ€è¦ç¨å¾®ç†Ÿæ‚‰ä¸€ä¸‹ï¼Œé›†æˆã€æ³¨è§£ä¸ä½¿ç”¨åˆ†å¦‚ä¸‹å››æ­¥ å»ºç«‹SwaggerConfigæ–‡ä»¶ @Configuration public class SwaggerConfig { // æ¥å£ç‰ˆæœ¬å· private final String version = &quot;1.0&quot;; // æ¥å£å¤§æ ‡é¢˜ private final String title = &quot;SpringBootç¤ºä¾‹å·¥ç¨‹&quot;; // å…·ä½“çš„æè¿° private final String description = &quot;APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆç¤ºä¾‹&quot;; // æœåŠ¡è¯´æ˜url private final String termsOfServiceUrl = &quot;http://www.kingeid.com&quot;; // licence private final String license = &quot;MIT&quot;; // licnce url private final String licenseUrl = &quot;https://mit-license.org/&quot;; // æ¥å£ä½œè€…è”ç³»æ–¹å¼ private final Contact contact = new Contact(&quot;calebman&quot;, &quot;https://github.com/calebman&quot;, &quot;chenjianhui0428@gmail.com&quot;); @Bean public Docket buildDocket() { return new Docket(DocumentationType.SWAGGER_2).apiInfo(buildApiInf()) .select().build(); } private ApiInfo buildApiInf() { return new ApiInfoBuilder().title(title).termsOfServiceUrl(termsOfServiceUrl).description(description) .version(version).license(license).licenseUrl(licenseUrl).contact(contact).build(); } } åœ¨SpringBootExampleApplication.javaä¸­å¯ç”¨Swagger2æ³¨è§£ &emsp;&emsp; åœ¨@SpringBootApplicationæ³¨è§£ä¸‹é¢åŠ ä¸Š@EnableSwagger2æ³¨è§£ å¸¸ç”¨æ³¨è§£ç¤ºä¾‹ //Contorllerä¸­çš„æ³¨è§£ç¤ºä¾‹ @Controller @RequestMapping(&quot;/v1/product&quot;) // è¡¨ç¤ºæ ‡è¯†è¿™ä¸ªç±»æ˜¯swaggerçš„èµ„æº @Api(value = &quot;DocController&quot;, tags = {&quot;restful apiç¤ºä¾‹&quot;}) public class DocController extends BaseController { @RequestMapping(value = &quot;/{id}&quot;, method = RequestMethod.PUT) @ResponseBody //è¡¨ç¤ºä¸€ä¸ªhttpè¯·æ±‚çš„æ“ä½œ @ApiOperation(value = &quot;ä¿®æ”¹æŒ‡å®šäº§å“&quot;, httpMethod = &quot;PUT&quot;, produces = &quot;application/json&quot;) //@ApiImplicitParamsç”¨äºæ–¹æ³•ï¼ŒåŒ…å«å¤šä¸ª@ApiImplicitParamè¡¨ç¤ºå•ç‹¬çš„è¯·æ±‚å‚æ•° @ApiImplicitParams({@ApiImplicitParam(name = &quot;id&quot;, value = &quot;äº§å“ID&quot;, required = true, paramType = &quot;path&quot;)}) public WebResult update(@PathVariable(&quot;id&quot;) Integer id, @ModelAttribute Product product) { logger.debug(&quot;ä¿®æ”¹æŒ‡å®šäº§å“æ¥æ”¶äº§å“idä¸äº§å“ä¿¡æ¯=&gt;%d,{}&quot;, id, product); if (id == null || &quot;&quot;.equals(id)) { logger.debug(&quot;äº§å“idä¸èƒ½ä¸ºç©º&quot;); return WebResult.error(ERRORDetail.RC_0101001); } return WebResult.success(); } } //Modelä¸­çš„æ³¨è§£ç¤ºä¾‹ //è¡¨ç¤ºå¯¹ç±»è¿›è¡Œè¯´æ˜ï¼Œç”¨äºå‚æ•°ç”¨å®ä½“ç±»æ¥æ”¶ @ApiModel(value = &quot;äº§å“ä¿¡æ¯&quot;) public class Product { //è¡¨ç¤ºå¯¹modelå±æ€§çš„è¯´æ˜æˆ–è€…æ•°æ®æ“ä½œæ›´æ”¹ @ApiModelProperty(required = true, name = &quot;name&quot;, value = &quot;äº§å“åç§°&quot;, dataType = &quot;query&quot;) private String name; @ApiModelProperty(name = &quot;type&quot;, value = &quot;äº§å“ç±»å‹&quot;, dataType = &quot;query&quot;) private String type; } ç”Ÿæˆjsonå½¢å¼çš„æ–‡æ¡£ &emsp;&emsp; é›†æˆæˆåŠŸåå¯åŠ¨é¡¹ç›®æ§åˆ¶å°ä¼šæ‰“å°çº§åˆ«ä¸ºINFOçš„æ—¥å¿—ï¼Œæˆªå–éƒ¨åˆ†å¦‚ä¸‹ï¼Œè¡¨æ˜å¯é€šè¿‡è®¿é—®åº”ç”¨çš„v2/api-docsæ¥å£å¾—åˆ°æ–‡æ¡£apiçš„jsonæ ¼å¼æ•°æ®ï¼Œå¯åœ¨æµè§ˆå™¨è¾“å…¥æŒ‡å®šåœ°å€éªŒè¯é›†æˆæ˜¯å¦æˆåŠŸ Mapped &quot;{[/v2/api-docs],methods=[GET],produces=[application/json || application/hal+json]}&quot; http://localhost:8080/v2/api-docså¤šç¯å¢ƒé…ç½®&emsp;&emsp; åº”ç”¨ç ”å‘è¿‡ç¨‹ä¸­å¤šç¯å¢ƒæ˜¯ä¸å¯é¿å…çš„ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰å¼€å‘ã€æ¼”ç¤ºã€ç”Ÿäº§ä¸‰ä¸ªä¸åŒçš„ç¯å¢ƒå…¶é…ç½®ä¹Ÿä¸åŒï¼Œå¦‚æœæ¯æ¬¡éƒ½åœ¨æ‰“åŒ…ç¯èŠ‚æ¥è¿›è¡Œé…ç½®éš¾å…å‡ºé”™ï¼ŒSpringBootæ”¯æŒé€šè¿‡å‘½ä»¤å¯åŠ¨ä¸åŒçš„ç¯å¢ƒï¼Œä½†æ˜¯é…ç½®æ–‡ä»¶éœ€è¦æ»¡è¶³application-{profile}.propertiesçš„æ ¼å¼ï¼Œprofileä»£è¡¨å¯¹åº”ç¯å¢ƒçš„æ ‡è¯†ï¼ŒåŠ è½½æ—¶å¯é€šè¿‡ä¸åŒå‘½ä»¤åŠ è½½ä¸åŒç¯å¢ƒã€‚ application-dev.propertiesï¼šå¼€å‘ç¯å¢ƒ application-test.propertiesï¼šæ¼”ç¤ºç¯å¢ƒ application-prod.propertiesï¼šç”Ÿäº§ç¯å¢ƒ # è¿è¡Œæ¼”ç¤ºç¯å¢ƒå‘½ä»¤ java -jar spring-boot-example-0.0.1-SNAPSHOT --spring.profiles.active=test &emsp;&emsp; åŸºäºç°åœ¨çš„é¡¹ç›®å®ç°å¤šç¯å¢ƒæˆ‘ä»¬éœ€è¦åœ¨application.ymlåŒçº§ç›®å½•æ–°å»ºapplication-dev.ymlã€application-test.ymlã€application-prod.ymlä¸‰ä¸ªä¸åŒç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œå°†ä¸å˜çš„å…¬æœ‰é…ç½®å¦‚druidçš„å¤§éƒ¨åˆ†ã€pagehelperåˆ†é¡µæ’ä»¶ä»¥åŠmybatisåŒ…æ‰«æé…ç½®æ”¾ç½®äºapplication.ymlä¸­ï¼Œå¹¶åœ¨application.ymlä¸­é…ç½®é»˜è®¤é‡‡ç”¨å¼€å‘ç¯å¢ƒï¼Œé‚£ä¹ˆå¦‚æœä¸å¸¦â€“spring.profiles.activeå¯åŠ¨åº”ç”¨å°±é»˜è®¤ä¸ºå¼€å‘ç¯å¢ƒå¯åŠ¨ï¼Œå˜åŠ¨è¾ƒå¤§çš„é…ç½®å¦‚æ•°æ®åº“çš„è´¦å·å¯†ç åˆ†åˆ«å†™å…¥ä¸åŒç¯å¢ƒçš„é…ç½®æ–‡ä»¶ä¸­ spring: profiles: # é»˜è®¤ä½¿ç”¨å¼€å‘ç¯å¢ƒ active: dev &emsp;&emsp; é…ç½®åˆ°è¿™é‡Œæˆ‘ä»¬çš„é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤º &emsp;&emsp; è‡³æ­¤æˆ‘ä»¬åˆ†åˆ«å®Œæˆäº†Mybatisã€Swagger2ä»¥åŠå¤šç¯å¢ƒçš„é›†æˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é…ç½®å¤šç¯å¢ƒä¸‹çš„loggerã€‚å¯¹äºloggeræˆ‘ä»¬æ€»æ˜¯å¸Œæœ›åœ¨é¡¹ç›®ç ”å‘è¿‡ç¨‹ä¸­è¶Šå¤šè¶Šå¥½ï¼Œèƒ½å¤Ÿç»™äºˆè¶³å¤Ÿçš„ä¿¡æ¯å®šä½bugï¼Œé¡¹ç›®å¤„äºæ¼”ç¤ºæˆ–è€…ä¸Šçº¿çŠ¶æ€æ—¶ä¸ºäº†ä¸è®©æ—¥å¿—æ‰“å°å½±å“ç¨‹åºæ€§èƒ½æˆ‘ä»¬åªéœ€è¦è­¦å‘Šæˆ–è€…é”™è¯¯çš„æ—¥å¿—ï¼Œå¹¶ä¸”éœ€è¦å†™å…¥æ–‡ä»¶ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±åŸºäºlogbackå®ç°å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½® å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½®&emsp;&emsp; åˆ›å»ºlogback-spring.xmlåœ¨application.ymlçš„åŒçº§ç›®å½•ï¼Œspringbootæ¨èä½¿ç”¨logback-spring.xmlè€Œä¸æ˜¯logback.xmlæ–‡ä»¶ï¼Œlogback-spring.xmlçš„é…ç½®å†…å®¹å¦‚ä¸‹æ‰€ç¤º &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration scan=&quot;true&quot; scanPeriod=&quot;60 seconds&quot; debug=&quot;false&quot;&gt; &lt;!-- ç®€è¦æè¿° æ—¥å¿—æ ¼å¼ =&gt; %d{HH:mm:ss.SSS}(æ—¶é—´) [%-5level](æ—¥å¿—çº§åˆ«) %logger{36}(loggeråå­—æœ€é•¿36ä¸ªå­—ç¬¦ï¼Œå¦åˆ™æŒ‰ç…§å¥ç‚¹åˆ†å‰²) - %msg%n(å…·ä½“æ—¥å¿—ä¿¡æ¯å¹¶ä¸”æ¢è¡Œ) å¼€å‘ç¯å¢ƒ =&gt; ${basepackage}åŒ…ä¸‹æ§åˆ¶å°æ‰“å°DEBUGçº§åˆ«åŠä»¥ä¸Šã€å…¶ä»–åŒ…æ§åˆ¶å°æ‰“å°INFOçº§åˆ«åŠä»¥ä¸Š æ¼”ç¤ºï¼ˆæµ‹è¯•ï¼‰ç¯å¢ƒ =&gt; ${basepackage}åŒ…ä¸‹æ§åˆ¶å°æ‰“å°INFOçº§åˆ«åŠä»¥ä¸Šã€å…¶ä»–åŒ…æ§åˆ¶å°ä»¥åŠæ–‡ä»¶æ‰“å°WARNçº§åˆ«åŠä»¥ä¸Š ç”Ÿäº§ç¯å¢ƒ =&gt; æ§åˆ¶å°ä»¥åŠæ–‡ä»¶æ‰“å°ERRORçº§åˆ«åŠä»¥ä¸Š æ—¥å¿—æ–‡ä»¶ç”Ÿæˆè§„åˆ™å¦‚ä¸‹ï¼š æ–‡ä»¶ç”Ÿæˆç›®å½• =&gt; ${logdir} å½“æ—¥çš„logæ–‡ä»¶åç§° =&gt; ${appname}.log å…¶ä»–æ—¶å€™çš„logæ–‡ä»¶åç§° =&gt; ${appname}.%d{yyyy-MM-dd}.log æ—¥å¿—æ–‡ä»¶æœ€å¤§ =&gt; ${maxsize} æœ€å¤šä¿ç•™ =&gt; ${maxdays}å¤© --&gt; &lt;!--è‡ªå®šä¹‰å‚æ•° --&gt; &lt;!--ç”¨æ¥æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„ä¸Šé™å¤§å°ï¼Œé‚£ä¹ˆåˆ°äº†è¿™ä¸ªå€¼ï¼Œå°±ä¼šåˆ é™¤æ—§çš„æ—¥å¿—--&gt; &lt;property name=&quot;maxsize&quot; value=&quot;30MB&quot; /&gt; &lt;!--åªä¿ç•™æœ€è¿‘90å¤©çš„æ—¥å¿—--&gt; &lt;property name=&quot;maxdays&quot; value=&quot;90&quot; /&gt; &lt;!--application.yml ä¼ é€’å‚æ•° --&gt; &lt;!--logæ–‡ä»¶ç”Ÿæˆç›®å½•--&gt; &lt;springProperty scope=&quot;context&quot; name=&quot;logdir&quot; source=&quot;resources.logdir&quot;/&gt; &lt;!--åº”ç”¨åç§°--&gt; &lt;springProperty scope=&quot;context&quot; name=&quot;appname&quot; source=&quot;resources.appname&quot;/&gt; &lt;!--é¡¹ç›®åŸºç¡€åŒ…--&gt; &lt;springProperty scope=&quot;context&quot; name=&quot;basepackage&quot; source=&quot;resources.basepackage&quot;/&gt; &lt;!--è¾“å‡ºåˆ°æ§åˆ¶å° ConsoleAppender--&gt; &lt;appender name=&quot;consoleLog&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;!--å±•ç¤ºæ ¼å¼ layout--&gt; &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt; &lt;pattern&gt; &lt;pattern&gt;%d{HH:mm:ss.SSS} [%-5level] %logger{36} - %msg%n&lt;/pattern&gt; &lt;/pattern&gt; &lt;/layout&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºåˆ°æ–‡ä»¶ FileAppender--&gt; &lt;appender name=&quot;fileLog&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;!-- æ—¥å¿—åç§°ï¼Œå¦‚æœæ²¡æœ‰File å±æ€§ï¼Œé‚£ä¹ˆåªä¼šä½¿ç”¨FileNamePatternçš„æ–‡ä»¶è·¯å¾„è§„åˆ™ å¦‚æœåŒæ—¶æœ‰&lt;File&gt;å’Œ&lt;FileNamePattern&gt;ï¼Œé‚£ä¹ˆå½“å¤©æ—¥å¿—æ˜¯&lt;File&gt;ï¼Œæ˜å¤©ä¼šè‡ªåŠ¨æŠŠä»Šå¤© çš„æ—¥å¿—æ”¹åä¸ºä»Šå¤©çš„æ—¥æœŸã€‚å³ï¼Œ&lt;File&gt; çš„æ—¥å¿—éƒ½æ˜¯å½“å¤©çš„ã€‚ --&gt; &lt;File&gt;${logdir}/${appname}.log&lt;/File&gt; &lt;!--æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰ç…§æ—¶é—´æ»šåŠ¨ TimeBasedRollingPolicy--&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;!--æ–‡ä»¶è·¯å¾„,å®šä¹‰äº†æ—¥å¿—çš„åˆ‡åˆ†æ–¹å¼â€”â€”æŠŠæ¯ä¸€å¤©çš„æ—¥å¿—å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­,ä»¥é˜²æ­¢æ—¥å¿—å¡«æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´--&gt; &lt;FileNamePattern&gt;${logdir}/${appname}.%d{yyyy-MM-dd}.log&lt;/FileNamePattern&gt; &lt;maxHistory&gt;${maxdays}&lt;/maxHistory&gt; &lt;totalSizeCap&gt;${maxsize}&lt;/totalSizeCap&gt; &lt;/rollingPolicy&gt; &lt;!--æ—¥å¿—è¾“å‡ºç¼–ç æ ¼å¼åŒ–--&gt; &lt;encoder&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;pattern&gt;%d{HH:mm:ss.SSS} [%-5level] %logger{36} - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!-- å¼€å‘ç¯å¢ƒ--&gt; &lt;springProfile name=&quot;dev&quot;&gt; &lt;root level=&quot;INFO&quot;&gt; &lt;appender-ref ref=&quot;consoleLog&quot;/&gt; &lt;/root&gt; &lt;!-- additivityæ˜¯å­Logger æ˜¯å¦ç»§æ‰¿ çˆ¶Logger çš„ è¾“å‡ºæºï¼ˆappenderï¼‰ çš„æ ‡å¿—ä½ åœ¨è¿™é‡Œadditivityé…ç½®ä¸ºfalseä»£è¡¨å¦‚æœ${basepackage}ä¸­æœ‰INFOçº§åˆ«æ—¥å¿—åˆ™å­loogeræ‰“å° rootä¸æ‰“å° --&gt; &lt;logger name=&quot;${basepackage}&quot; level=&quot;DEBUG&quot; additivity=&quot;false&quot;&gt; &lt;appender-ref ref=&quot;consoleLog&quot;/&gt; &lt;/logger&gt; &lt;/springProfile&gt; &lt;!-- æ¼”ç¤ºï¼ˆæµ‹è¯•ï¼‰ç¯å¢ƒ--&gt; &lt;springProfile name=&quot;test&quot;&gt; &lt;root level=&quot;WARN&quot;&gt; &lt;appender-ref ref=&quot;consoleLog&quot;/&gt; &lt;appender-ref ref=&quot;fileLog&quot;/&gt; &lt;/root&gt; &lt;logger name=&quot;${basepackage}&quot; level=&quot;INFO&quot; additivity=&quot;false&quot;&gt; &lt;appender-ref ref=&quot;consoleLog&quot;/&gt; &lt;appender-ref ref=&quot;fileLog&quot;/&gt; &lt;/logger&gt; &lt;/springProfile&gt; &lt;!-- ç”Ÿäº§ç¯å¢ƒ --&gt; &lt;springProfile name=&quot;prod&quot;&gt; &lt;root level=&quot;ERROR&quot;&gt; &lt;appender-ref ref=&quot;consoleLog&quot;/&gt; &lt;appender-ref ref=&quot;fileLog&quot;/&gt; &lt;/root&gt; &lt;/springProfile&gt; &lt;/configuration&gt; &emsp;&emsp; æ—¥å¿—é…ç½®ä¸­å¼•ç”¨äº†application.ymlçš„é…ç½®ä¿¡æ¯ï¼Œä¸»è¦æœ‰logdirã€appnameã€basepackageä¸‰é¡¹ï¼Œlogdiræ˜¯æ—¥å¿—æ–‡ä»¶çš„å†™å…¥åœ°å€ï¼Œå¯ä»¥ä¼ å…¥ç›¸å¯¹è·¯å¾„ï¼Œappnameæ˜¯åº”ç”¨åç§°ï¼Œå¼•å…¥è¿™é¡¹æ˜¯ä¸ºäº†é€šè¿‡æ—¥å¿—æ–‡ä»¶åç§°åŒºåˆ†æ˜¯å“ªä¸ªåº”è¯¥è¾“å‡ºçš„ï¼Œbasepackageæ˜¯åŒ…è¿‡æ»¤é…ç½®ï¼Œæ¯”å¦‚å¼€å‘ç¯å¢ƒä¸­éœ€è¦æ‰“å°debugçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—ï¼Œä½†æ˜¯åˆæƒ³ä½¿é™¤æˆ‘å†™çš„loggerä¹‹å¤–çš„DEBUGä¸æ‰“å°ï¼Œå¯è¿‡æ»¤åˆ°æœ¬é¡¹ç›®çš„åŒ…åæ‰ç”¨DEBUGæ‰“å°ï¼Œæ­¤å¤–åŒ…åä½¿ç”¨INFOçº§åˆ«æ‰“å°ï¼Œåœ¨application.ymlä¸­æ–°å»ºè¿™ä¸‰é¡¹é…ç½®ï¼Œä¹Ÿå¯åœ¨ä¸åŒç¯å¢ƒé…ç½®ä¸åŒå±æ€§ #åº”ç”¨é…ç½® resources: # logæ–‡ä»¶å†™å…¥åœ°å€ logdir: logs/ # åº”ç”¨åç§° appname: spring-boot-example # æ—¥å¿—æ‰“å°çš„åŸºç¡€æ‰«æåŒ… basepackage: com.spring.demo.springbootexample &emsp;&emsp; ä½¿ç”¨ä¸åŒç¯å¢ƒå¯åŠ¨æµ‹è¯•loggeré…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹å°†æ‰“å°DEBUGçº§åˆ«ä»¥ä¸Šçš„å››æ¡loggerè®°å½•ï¼Œåœ¨æ¼”ç¤ºç¯å¢ƒä¸‹é™æ‰“å°INFOçº§åˆ«ä»¥ä¸Šçš„ä¸‰æ¡è®°å½•å¹¶å†™å…¥æ–‡ä»¶ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹åªæ‰“å°ERRORçº§åˆ«ä»¥ä¸Šçš„ä¸€æ¡è®°å½•å¹¶å†™å…¥æ–‡ä»¶ @RequestMapping(&quot;/logger&quot;) @ResponseBody public WebResult logger() { logger.trace(&quot;æ—¥å¿—è¾“å‡º {}&quot;, &quot;trace&quot;); logger.debug(&quot;æ—¥å¿—è¾“å‡º {}&quot;, &quot;debug&quot;); logger.info(&quot;æ—¥å¿—è¾“å‡º {}&quot;, &quot;info&quot;); logger.warn(&quot;æ—¥å¿—è¾“å‡º {}&quot;, &quot;warn&quot;); logger.error(&quot;æ—¥å¿—è¾“å‡º {}&quot;, &quot;error&quot;); return &quot;00&quot;; } å¸¸ç”¨é…ç½®åŠ è½½è‡ªå®šä¹‰é…ç½®@Component @PropertySource(value = {&quot;classpath:application.yml&quot;}, encoding = &quot;utf-8&quot;) public class Config { @Value(&quot;${resources.midpHost}&quot;) private String midpHost; public String getMidpHost() { return midpHost; } } å…¨å±€å¼‚å¸¸å¤„ç†å™¨@ControllerAdvice public class GlobalExceptionResolver { Logger logger = LoggerFactory.getLogger(GlobalExceptionResolver.class); @ExceptionHandler(value = Exception.class) @ResponseBody public WebResult exceptionHandle(HttpServletRequest req, Exception ex) { ex.printStackTrace(); logger.error(&quot;æœªçŸ¥å¼‚å¸¸&quot;, ex); return WebResult.error(ERRORDetail.RC_0401001); } } ç¤ºä¾‹å·¥ç¨‹å¼€æºåœ°å€github","link":"/2018-02-21-build-springboot-env/"},{"title":"vueå°è£…echartsç»„ä»¶","text":"å°†Echartsåšä¸€å±‚å°å°çš„å°è£…ä»¥æ»¡è¶³ä½¿ç”¨éœ€æ±‚ è¯´æ˜ åšé¡¹ç›®çš„æ—¶å€™ä¸ºäº†è®©æ•°æ®å±•ç¤ºçš„æ›´åŠ ç›´è§‚ï¼Œæ€»ä¼šç”¨åˆ°å›¾è¡¨ç›¸å…³çš„æ§ä»¶ï¼Œè€Œè¯´åˆ°å›¾è¡¨æ§ä»¶ç¬¬ä¸€æ—¶é—´å½“ç„¶æƒ³åˆ°EChartsè¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œè€Œå®ƒä¸åƒiviewã€element-uiè¿™äº›ç»„ä»¶ä½¿ç”¨èµ·æ¥é‚£ä¹ˆä¾¿æ·ï¼Œéœ€è¦ç»•ä¸€ä¸ªå°å¼¯ï¼Œä¸ºäº†å›¾æ–¹ä¾¿äºæ˜¯å¯¹EChartsè¿›è¡Œäº†ä¸€å±‚å°è£… æ§ä»¶æ¼”ç¤º æ§ä»¶ä½¿ç”¨ æ¦‚è¦ åŸºäºechartsçš„äºŒæ¬¡å°è£… ç”±æ•°æ®é©±åŠ¨ æ§ä»¶æºç è§src/components/charts æ–‡æ¡£ props å±æ€§ è¯´æ˜ ç±»å‹ _id å›¾è¡¨å”¯ä¸€æ ‡è¯†ï¼Œå½“idé‡å¤å°†ä¼šæŠ¥é”™ String _titleText å›¾è¡¨æ ‡é¢˜ String _xText xè½´æè¿° String _yText yè½´æè¿° String _chartData å›¾è¡¨æ•°æ® Array _type å›¾è¡¨ç±»å‹ï¼Œæä¾›ä¸‰ç§(LineAndBar/LineOrBar/Pie) String è°ƒç”¨ç¤ºä¾‹ &lt;chart :_id=&quot;'testCharts'&quot; :_titleText=&quot;'è®¿é—®é‡ç»Ÿè®¡'&quot; :_xText=&quot;'ç±»åˆ«'&quot; :_yText=&quot;'æ€»è®¿é—®é‡'&quot; :_chartData=&quot;chartData&quot; :_type=&quot;'Pie'&quot;&gt;&lt;/chart&gt; å®ç°æ–¹å¼ åˆ›å»ºä¸€ä¸ªå¾…æ¸²æŸ“çš„dom&lt;template&gt; &lt;div :id=&quot;_id&quot; class=&quot;chart&quot;&gt;&lt;/div&gt; &lt;/template&gt; ç»˜åˆ¶å‡½æ•°function drawPie(chartData,id,titleText,xText,yText) { var chart = echarts.init(document.getElementById(id)) var xAxisData = chartData.map(function (item) {return item[0]}) var pieData = [] chartData.forEach((v,i)=&gt;{ pieData.push({ name:v[0], value:v[1] }) }) chart.setOption({ title : { text: titleText, subtext: '', x:'center' }, tooltip : { trigger: 'item', formatter: &quot;{a} &lt;br/&gt;{b} : {c} ({d}%)&quot; }, legend: { orient: 'vertical', left: 'left', data: xAxisData }, series : [ { name: xText, type: 'pie', radius : '55%', center: ['50%', '60%'], data:pieData, itemStyle: { emphasis: { shadowBlur: 10, shadowOffsetX: 0, shadowColor: 'rgba(0, 0, 0, 0.5)' } } } ] }) } æŒ‚è½½ç»“æŸã€æ•°æ®æºæ”¹å˜æ—¶é‡ç»˜ watch:{ _chartData(val){ switch (this._type){ case &quot;LineAndBar&quot;: drawLineAndBar(val,this._id,this._titleText,this._xText,this._yText); break case &quot;LineOrBar&quot;: drawLineOrBar(val,this._id,this._titleText,this._xText,this._yText); break case &quot;Pie&quot;: drawPie(val,this._id,this._titleText,this._xText,this._yText); break default: drawLineAndBar(val,this._id,this._titleText,this._xText,this._yText); break } } }, mounted() { switch (this._type){ case &quot;LineAndBar&quot;: drawLineAndBar(this._chartData,this._id,this._titleText,this._xText,this._yText); break case &quot;LineOrBar&quot;: drawLineOrBar(this._chartData,this._id,this._titleText,this._xText,this._yText); break case &quot;Pie&quot;: drawPie(this._chartData,this._id,this._titleText,this._xText,this._yText); break default: drawLineAndBar(this._chartData,this._id,this._titleText,this._xText,this._yText); break } } å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿star calebman/vue-DBM","link":"/2017-09-30-vue-echarts/"},{"title":"åŸºäºElementæ„å»ºè‡ªå®šä¹‰æ ‘","text":"åŸºäºElementçš„renderå‡½æ•°å°è£…ä¸€ä¸ªå¯ä»¥å¢ã€åˆ ã€æ”¹çš„æ ‘å½¢ç»„ä»¶ è¯´æ˜ åšé¡¹ç›®çš„æ—¶å€™è¦ä½¿ç”¨åˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„æ ‘å½¢æ§ä»¶æ¥æ„å»ºè¡¨æ ¼æ ‘ï¼Œåœ¨githubä¸Šæœäº†ä¸€ä¸‹æ²¡æœ‰æœç´¢åˆ°åˆé€‚çš„ï¼ˆå¥½çœ‹çš„ï¼‰å¯ä»¥ç›´æ¥ç”¨çš„ï¼ŒæŸ¥çœ‹Elementçš„ç»„ä»¶è¯´æ˜æ—¶å‘ç°å®ƒçš„Treeæ§ä»¶å¯ä»¥ä½¿ç”¨renderæ¥è‡ªå®šä¹‰èŠ‚ç‚¹æ ·å¼ï¼Œäºæ˜¯åŸºäºå®ƒå°è£…äº†ä¸€ä¸ªå¯ä»¥å¢ã€åˆ ã€æ”¹çš„æ ‘å½¢ç»„ä»¶ï¼Œç°åœ¨åˆ†äº«ä¸€ä¸‹å®ƒçš„ä½¿ç”¨ä¸å®ç°ã€‚ æ§ä»¶æ¼”ç¤º æ§ä»¶ä½¿ç”¨ æ¦‚è¦ åŸºäºelement-uiæ ‘å½¢æ§ä»¶çš„äºŒæ¬¡å°è£… æä¾›ç¼–è¾‘ã€åˆ é™¤èŠ‚ç‚¹çš„æ¥å£ æä¾›ä¸€ä¸ªnexté’©å­ï¼Œåœ¨ä¸šåŠ¡å¤„ç†å¤±è´¥æ—¶å¯ä½¿ç”¨next(false)å›æ»šæ“ä½œ æ§ä»¶æºç è§ github æ–‡æ¡£ props å±æ€§ è¯´æ˜ ç±»å‹ value æºæ•°æ®ï¼Œå¯ä½¿ç”¨v-modelåŒå‘ç»‘å®š Array events äº‹ä»¶å è¯´æ˜ å‚æ•° SaveEdit ç‚¹å‡»ç¼–è¾‘æˆ–è€…æ·»åŠ æ ‘èŠ‚ç‚¹åçš„ä¿å­˜äº‹ä»¶ (çˆ¶èŠ‚ç‚¹æ•°æ®ã€å½“å‰èŠ‚ç‚¹æ•°æ®ã€next) DelNode åˆ é™¤èŠ‚ç‚¹äº‹ä»¶ (çˆ¶èŠ‚ç‚¹æ•°æ®ã€å½“å‰èŠ‚ç‚¹æ•°æ®ã€next) NodeClick èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶ (å½“å‰èŠ‚ç‚¹æ•°æ®) æºæ•°æ®æè¿° å±æ€§ è¯´æ˜ value æ ‘èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯† label æ ‘èŠ‚ç‚¹çš„æ˜¾ç¤ºåç§° status (1ï¼šç¼–è¾‘çŠ¶æ€)(0ï¼šæ˜¾ç¤ºçŠ¶æ€)(-1ä¸å¯ç¼–è¾‘çŠ¶æ€) children å­èŠ‚ç‚¹æ•°æ® è°ƒç”¨ç¤ºä¾‹ &lt;m-tree v-model=&quot;tableTree&quot; @SaveEdit=&quot;SaveEdit&quot; @DelNode=&quot;DelNode&quot; @NodeClick=&quot;handleNodeClick&quot;&gt;&lt;/m-tree&gt; SaveEdit(parentNode,data,next){ var param = { parentNode:parentNode, node:data } this.$http.post(URL,param).then((response) =&gt; { if(response.status == 200){ next(true,response.body.data.nodeId) }else{ next(false) } }) } å®ç°æ–¹å¼ æ„å»ºå­èŠ‚ç‚¹çš„æ¨¡æ¿&lt;span class=&quot;span_item&quot;&gt; &lt;span @click=&quot;Expanded&quot;&gt; &lt;Input v-if=&quot;node.status == 1&quot; style=&quot;width: 100px;&quot; v-model=&quot;node.label&quot; size=&quot;small&quot; &gt;&lt;/Input&gt; &lt;Icon v-if=&quot;node.status == 0&quot; type=&quot;asterisk&quot;&gt;&lt;/Icon&gt; &lt;Icon v-if=&quot;node.status == -1&quot; type=&quot;ios-keypad-outline&quot;&gt;&lt;/Icon&gt; &lt;span v-if=&quot;node.status != 1&quot;&gt;{{node.label}}&lt;/span&gt; &lt;/span&gt; &lt;span v-if=&quot;node.status == 1&quot;&gt; &lt;Button style=&quot;margin-left: 8px;&quot; size=&quot;small&quot; type=&quot;success&quot; icon=&quot;checkmark-circled&quot; @click=&quot;SaveEdit&quot;&gt;ç¡®è®¤&lt;/Button&gt; &lt;Button style=&quot;margin-left: 8px;&quot; size=&quot;small&quot; type=&quot;ghost&quot; icon=&quot;checkmark-circled&quot; @click=&quot;CancelEdit&quot;&gt;å–æ¶ˆ&lt;/Button&gt; &lt;/span&gt; &lt;span class=&quot;span_icon&quot;&gt; &lt;Icon v-if=&quot;node.status == 0&quot; style=&quot;margin-left: 8px&quot; color=&quot;gray&quot; type=&quot;edit&quot; size=&quot;16&quot; @click.native=&quot;OpenEdit&quot;&gt;&lt;/Icon&gt; &lt;Icon v-if=&quot;node.status == 0&quot; style=&quot;margin-left: 8px&quot; type=&quot;plus-round&quot; color=&quot;gray&quot; size=&quot;16&quot; @click.native=&quot;Append&quot;&gt;&lt;/Icon&gt; &lt;Icon v-if=&quot;node.status == 0&amp;&amp;node.children.length &lt; 1&quot; style=&quot;margin-left: 8px&quot; type=&quot;ios-trash&quot; color=&quot;red&quot; size=&quot;18&quot; @click.native=&quot;Delete&quot;&gt;&lt;/Icon&gt; &lt;/span&gt; &lt;/span&gt; å­èŠ‚ç‚¹é€šè¿‡$emité€šçŸ¥çˆ¶èŠ‚ç‚¹äº‹ä»¶SaveEdit(){ //ä¿å­˜èŠ‚ç‚¹äº‹ä»¶ this.$emit('SaveEdit',this.nodeData) }, çˆ¶èŠ‚ç‚¹æ ¸å¿ƒå®ç°ï¼Œä½¿ç”¨renderContentå‡½æ•°åŠ è½½å­èŠ‚ç‚¹æ¨¡æ¿ï¼Œç‚¹å‡»ä¿å­˜èŠ‚ç‚¹æ—¶å°†ä¸šåŠ¡å‚æ•°ä¿å­˜åœ¨runParamä¸­ç”¨äºåœ¨ä¸šåŠ¡æ“ä½œå¤±è´¥ï¼ˆç½‘ç»œè¯·æ±‚å¤±è´¥ã€æœåŠ¡ç«¯å¼‚å¸¸ç­‰æƒ…å†µï¼‰çš„æ•°æ®å›æ»š &lt;el-tree class=&quot;filter-tree&quot; style=&quot;overflow:auto;&quot; :data=&quot;treeData&quot; :filter-node-method=&quot;filterNode&quot; @node-click=&quot;handleNodeClick&quot; ref=&quot;tree&quot; node-key=&quot;value&quot; :expand-on-click-node=&quot;false&quot; :render-content=&quot;renderContent&quot; default-expand-all&gt; &lt;/el-tree&gt; //å­èŠ‚ç‚¹æ¨¡æ¿ renderContent(h, { node, data, store }) { return h(TreeItem,{ props:{ value:data, treeNode:node }, on:{ input:(node)=&gt;{ data = node }, Append: () =&gt; { node.expanded = true data.children.push({ value: this.$utilHelper.generateUUID(), label: 'è¯·è¾“å…¥æ¨¡å—åç§°', children: [],status:1,isAdd:true }) }, //ä¿å­˜èŠ‚ç‚¹ SaveEdit:(nodeData)=&gt; { //é€’å½’æŸ¥æ‰¾çˆ¶èŠ‚ç‚¹ var parentNode = this.$utilHelper.getNode(this.treeData,data.value).parentNode this.runParam.parentNode = parentNode this.runParam.data = data this.runParam.nodeData = nodeData this.$emit('SaveEdit',parentNode,data,this.CanSaveNext) } } }) } æ“ä½œç»“æœé’©å­ï¼Œå¦‚æœnextå‡½æ•°ä¼ å…¥falseåˆ™åˆ¤å®šæ“ä½œå¤±è´¥ï¼Œä½¿ç”¨runParamä¸­çš„å‚æ•°è¿›è¡Œå›æ»šï¼Œè¯¥èŠ‚ç‚¹çš„ç¼–è¾‘ä¿å­˜æ“ä½œå°†æ— æ•ˆ CanSaveNext(isNext,nodeId){ let parentNode = this.runParam.parentNode let nodeData = this.runParam.nodeData let data = this.runParam.data if(isNext){ parentNode.children.forEach((v,i)=&gt;{ if(v.value == data.value){ if(this.HOST != &quot;static&quot;&amp;&amp;data.isAdd){ data.value = nodeId } data.status = 0 parentNode.children.splice(i,1,data) } }) }else{ if(!data.isAdd){ parentNode.children.forEach((v,i)=&gt;{ if(v.value == nodeData.value){ data.label = nodeData.label parentNode.children.splice(i,1,data) } }) } } this.runParam = {} } å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿star calebman/vue-DBM","link":"/2017-09-19-vue-custom-tree/"}],"tags":[{"name":"vuejs","slug":"vuejs","link":"/tags/vuejs/"},{"name":"element-ui","slug":"element-ui","link":"/tags/element-ui/"},{"name":"echarts","slug":"echarts","link":"/tags/echarts/"},{"name":"SpringBoot","slug":"SpringBoot","link":"/tags/SpringBoot/"},{"name":"Spring","slug":"Spring","link":"/tags/Spring/"},{"name":"vue-router","slug":"vue-router","link":"/tags/vue-router/"},{"name":"vuex","slug":"vuex","link":"/tags/vuex/"},{"name":"Netty","slug":"Netty","link":"/tags/Netty/"},{"name":"markdown","slug":"markdown","link":"/tags/markdown/"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"Nginx","slug":"Nginx","link":"/tags/Nginx/"},{"name":"jenkins","slug":"jenkins","link":"/tags/jenkins/"},{"name":"maven","slug":"maven","link":"/tags/maven/"},{"name":"nodejs","slug":"nodejs","link":"/tags/nodejs/"},{"name":"devops","slug":"devops","link":"/tags/devops/"},{"name":"Docker","slug":"Docker","link":"/tags/Docker/"},{"name":"mysql","slug":"mysql","link":"/tags/mysql/"},{"name":"redis","slug":"redis","link":"/tags/redis/"},{"name":"Algorithm","slug":"Algorithm","link":"/tags/Algorithm/"},{"name":"Java","slug":"Java","link":"/tags/Java/"},{"name":"Vue","slug":"Vue","link":"/tags/Vue/"},{"name":"Shell","slug":"Shell","link":"/tags/Shell/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"Dubbo","slug":"Dubbo","link":"/tags/Dubbo/"},{"name":"Machine Learning","slug":"Machine-Learning","link":"/tags/Machine-Learning/"},{"name":"Cache","slug":"Cache","link":"/tags/Cache/"},{"name":"Transaction","slug":"Transaction","link":"/tags/Transaction/"},{"name":"vuepress","slug":"vuepress","link":"/tags/vuepress/"},{"name":"plugin","slug":"plugin","link":"/tags/plugin/"},{"name":"centos","slug":"centos","link":"/tags/centos/"},{"name":"openssh","slug":"openssh","link":"/tags/openssh/"},{"name":"linux","slug":"linux","link":"/tags/linux/"}],"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","link":"/categories/å‰ç«¯/"},{"name":"åç«¯","slug":"åç«¯","link":"/categories/åç«¯/"},{"name":"éšç¬”","slug":"éšç¬”","link":"/categories/éšç¬”/"},{"name":"å‰åç«¯åˆ†ç¦»","slug":"å‰åç«¯åˆ†ç¦»","link":"/categories/å‰åç«¯åˆ†ç¦»/"},{"name":"è¿ç»´","slug":"è¿ç»´","link":"/categories/è¿ç»´/"},{"name":"æµ‹è¯•","slug":"æµ‹è¯•","link":"/categories/æµ‹è¯•/"},{"name":"Docker","slug":"Docker","link":"/categories/Docker/"},{"name":"Algorithm","slug":"Algorithm","link":"/categories/Algorithm/"},{"name":"Linux","slug":"Linux","link":"/categories/Linux/"}]}